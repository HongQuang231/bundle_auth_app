var self=self||this||new Function("return this")()||{};(self.webpackChunkerequestApp=self.webpackChunkerequestApp||[]).push([["src_app_screens_review-flow_tab-view_components_Document_index_tsx-src_app_screens_review-flo-8f3fda"],{93183:function(e,t,n){var l=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(29293)),a=l(n(85715)),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=T(t);if(n&&n.has(e))return n.get(e);var l={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(l,a,i):l[a]=e[a]}return l.default=e,n&&n.set(e,l),l}(n(21527)),o=n(87841),u=l(n(14507)),s=n(12638),c=n(19867),d=l(n(75672)),f=n(41995),h=l(n(24541)),p=n(46317),y=l(n(81924)),v=n(14740),m=n(35708),g=l(n(77389)),x=n(2884),S=n(40851),j=l(n(86933)),w=l(n(99746)),b=l(n(76644)),D=l(n(7006)),C=n(88e3),k=n(47671);function T(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(T=function(e){return e?n:t})(e)}t.default=function(e){var t=e.dataUserTask,n=(0,x.useTranslation)().t,l=((0,v.useNavigation)(),(0,i.useState)(1)),T=(0,a.default)(l,2),M=T[0],_=T[1],I=(0,i.useState)(0),F=(0,a.default)(I,2),P=F[0],R=F[1],O=(0,i.useState)([]),E=(0,a.default)(O,2),V=E[0],z=E[1],A=(0,i.useState)(!1),N=(0,a.default)(A,2),L=N[0],$=N[1],B=(0,i.useState)(""),U=(0,a.default)(B,2),Y=U[0],H=U[1],K=(0,i.useState)(""),W=(0,a.default)(K,2),G=W[0],J=W[1],q=(0,s.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,Q=(0,s.useAppSelector)((function(e){return e.common})).accessToken,X=(0,s.useAppSelector)((function(e){return e.account})).dataAccount,Z=(0,S.useReviewServices)();(0,i.useEffect)((function(){se(M)}),[M]);var ee,te,ne,le,re,ae,ie,oe,ue,se=(ee=(0,r.default)((function*(e){try{var n={page:e-1,size:3,sort:"createdDate,desc"},l=yield Z.getListAttachmentsUserTask(q.id,t._userTaskId,n,Q);if(l){var r,a,i=[];if(0===(null==(a=i=null!=X&&null!=(r=X.orgIn)&&r.includes("/1978/5742")?null==l?void 0:l.data.filter((function(e){return!("eform"==e.resource&&"upload_img"==e.type)})):null==l?void 0:l.data)?void 0:a.length))return void(e>1?_(e-1):(z([]),R(0)));R(null==l?void 0:l.totalRecords),me(i)}}catch(e){}})),function(e){return ee.apply(this,arguments)}),ce=(te=(0,r.default)((function*(){try{yield Z.getListFileReview(q.id,t._userTaskId,Q)}catch(e){}})),function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0;return(0,k.jsxs)(o.View,{style:u.default.ctnAction,children:[(0,k.jsx)(o.TouchableOpacity,{onPress:function(){return de(e,n)},hitSlop:(0,f.SizeDP)(15),children:(0,k.jsx)(p.IconView,{width:(0,f.SizeDP)(16),height:(0,f.SizeDP)(16)})}),(0,k.jsx)(o.TouchableOpacity,{onPress:function(){return pe(n,e)},hitSlop:(0,f.SizeDP)(15),children:(0,k.jsx)(p.IconDownload,{width:(0,f.SizeDP)(16),height:(0,f.SizeDP)(16)})}),!e&&n.allowDeleted&&t._status===c.STATUS_TASK.TASK_SEARCH&&(0,k.jsx)(o.TouchableOpacity,{onPress:function(){var e;return he(null==n||null==(e=n.id)?void 0:e.toString())},hitSlop:(0,f.SizeDP)(15),children:(0,k.jsx)(p.IconTrash,{width:(0,f.SizeDP)(16),height:(0,f.SizeDP)(16)})})]})}),de=(ne=(0,r.default)((function*(){var e,t,l=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1?arguments[1]:void 0;J(null==(e=r.fileName)||null==(t=e.split("."))?void 0:t[0]);try{g.default.show({type:"info",text1:n("CM.info"),text2:n("TK.viewFile")});var a=new FormData;if(!l&&"ewriter"===r.resource){var i=yield fe(r.userTaskId,null==r?void 0:r.fileRepositoryId,null==r?void 0:r.fileName);a.append("file",i);var o=yield Z.viewFile(a,Q);return void(1==(null==o?void 0:o.code)?($(!0),H(o.message)):g.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.error")}))}var u=r.name;u=l?r.keyName:r.name;var s=r.bucketName;if(!r.bucketName){var c,d=null==r||null==(c=r.name)?void 0:c.split(".s3-hfx03.fptcloud.com:443/");u=d[1],s=d[0].split("https://")[1]}a.append("keyName",u),a.append("bucketName",s),a.append("beanName",r.beanName);var f=yield Z.viewFile(a,Q);1==(null==f?void 0:f.code)?($(!0),H(f.message)):g.default.show({type:"error",text1:n("CM.info"),text2:n("CM.error")})}catch(e){g.default.show({type:"error",text1:n("CM.info"),text2:n("CM.error")})}})),function(){return ne.apply(this,arguments)}),fe=(le=(0,r.default)((function*(e,t,n){try{var l,r=null==n||null==(l=n.split("."))?void 0:l[1],a=`${w.default.fs.dirs.DocumentDir}/${(new Date).getTime().toString()}.${r}`,i=yield w.default.config({path:a}).fetch("GET",`${(0,C.getConfig)().BASE_URL}/services/erequest/api/tickets/${q.id}/userTaskId/${e}/fileId/${t}`).then((function(e){return 200==e.info().status?e.path():null})).catch((function(){return null}));return{uri:"ios"===o.Platform.OS?i:"file://"+i,name:`${(new Date).getTime().toString()}.${r}`,type:m.CommonUtils.getMimeType(n)}}catch(e){}})),function(e,t,n){return le.apply(this,arguments)}),he=(re=(0,r.default)((function*(e){try{yield Z.deleteFileRelative(e,Q),yield se(M),g.default.show({type:"success",text1:n("CM.info"),text2:n("TK.deleteFileSuccess")})}catch(e){console.log(e),g.default.show({type:"error",text1:n("CM.info"),text2:n("TK.deleteFileErr")})}})),function(e){return re.apply(this,arguments)}),pe=(ae=(0,r.default)((function*(e,t){var n=e.fileName;n=t?e.keyName.replace("/","_"):e.fileName;var l=`${"android"===o.Platform.OS?j.default.DownloadDirectoryPath:j.default.DocumentDirectoryPath}/${(new Date).getTime()}_${n}`;t||(e.bucketName?yield ve(l,e.id):yield ye(l,e.name))})),function(e,t){return ae.apply(this,arguments)}),ye=(ie=(0,r.default)((function*(e,t){var l={fromUrl:t,toFile:e,background:!0,begin:function(e){console.log("Download has begun",e)},progress:function(e){e.bytesWritten,e.contentLength},connectionTimeout:5e3};try{200===(yield j.default.downloadFile(l).promise).statusCode?"ios"===o.Platform.OS&&(yield o.Share.share({url:e})).action==o.Share.dismissedAction?g.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.downloadFail")}):g.default.show({type:"success",text1:n("CM.noti"),text2:n("CM.downloadSuccess")}):g.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.downloadFail")})}catch(e){g.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.downloadFail")})}})),function(e,t){return ie.apply(this,arguments)}),ve=(oe=(0,r.default)((function*(e,t){try{g.default.show({type:"info",text1:n("CM.noti"),text2:n("CM.pleaseWait")});var l=yield w.default.fetch("GET",`${(0,C.getConfig)().BASE_URL}/services/erequest/api/attachments/download-file?attachmentId=${t}`).then((function(e){return 200==e.info().status?e.base64():null})).catch((function(){return null}));if(l){try{yield j.default.writeFile(e,l,"base64")}catch(e){console.log(e)}"ios"===o.Platform.OS&&(yield o.Share.share({url:e})).action==o.Share.dismissedAction?g.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.downloadFail")}):g.default.show({type:"success",text1:n("CM.noti"),text2:n("CM.downloadSuccess")})}else g.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.downloadFail")})}catch(e){g.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.downloadFail")})}})),function(e,t){return oe.apply(this,arguments)}),me=function(e){var t=e.map((function(e,t){return{STT:String(3*(M-1)+1+t),keyName:(0,k.jsx)(h.default,{style:u.default.txtText,numberOfLines:1,children:(a=null==e?void 0:e.fileName,a?null==a||null==(i=a.split("."))||null==(o=i.slice(0,-1))?void 0:o.join("."):"")}),createdBy:e.createdBy,documentSize:m.CommonUtils.getSize(e.size),type:(n=null==e?void 0:e.fileName,l=e.resource,n?"docx"==n.split(".").pop()&&"ewriter"===l&&null!=X&&null!=(r=X.orgIn)&&r.includes("/1978/5742")?"pdf":n.split(".").pop():""),lastModifiedDate:m.DateUtils.convertDateToDDMMYYYY_H_M(e.lastModifiedDate),action:ce(!1,e)};var n,l,r,a,i,o}));z(t)},ge=(ue=(0,r.default)((function*(){try{var e=yield m.CommonUtils.handleGetFile();if(!e)return;var l=new FormData;l.append("uploadFile",e),l.append("attachmentJson",JSON.stringify({ticketId:null==q?void 0:q.id,userTaskId:t._userTaskId})),(yield Z.uploadFileRelative(l,Q))?(yield se(M),g.default.show({type:"success",text1:n("CM.info"),text2:n("TK.uploadFileSuccess")})):g.default.show({type:"error",text1:n("CM.info"),text2:n("TK.uploadFileErr")})}catch(e){console.log(e),g.default.show({type:"error",text1:n("CM.info"),text2:n("TK.uploadFileErr")})}})),function(){return ue.apply(this,arguments)});return(0,k.jsxs)(o.View,{style:u.default.ctnMain,children:[(0,k.jsx)(o.ScrollView,{style:u.default.ctnBody,children:(0,k.jsxs)(o.View,{style:u.default.ctnForm,children:[(0,k.jsxs)(o.View,{style:u.default.viewForm,children:[(0,k.jsx)(h.default,{style:u.default.txtTitle,children:n("RV.document")}),t._status===c.STATUS_TASK.TASK_SEARCH&&(0,k.jsx)(o.TouchableOpacity,{onPress:ge,hitSlop:(0,f.SizeDP)(15),children:(0,k.jsx)(p.IconUpload,{width:(0,f.SizeDP)(16),height:(0,f.SizeDP)(16)})})]}),(0,k.jsx)(d.default,{stickyLeft:!0,stickyColumnLeftIndex:1,tableHeaders:["STT","keyName","createdBy","documentSize","type","lastModifiedDate","action"],tableData:V}),P>0&&(0,k.jsx)(y.default,{collectionSize:P,currentPage:M,pageSize:3,onPageChange:function(e){return _(e)}})]})}),(0,k.jsx)(b.default,{isVisible:L,children:(0,k.jsx)(D.default,{url:Y,onClose:function(){return $(!1)},name:G})})]})}},14507:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(87841),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=i(t);if(n&&n.has(e))return n.get(e);var l={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(l,a,o):l[a]=e[a]}return l.default=e,n&&n.set(e,l),l}(n(41995)),a=n(20880);function i(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(i=function(e){return e?n:t})(e)}t.default=l.StyleSheet.create({ctnMain:{backgroundColor:"#F8FAFE",flex:1},ctnBody:{backgroundColor:"#fff",flex:1,paddingHorizontal:(0,r.SizeDP)(16)},txtTitle:{fontSize:r.default.FontBase,fontFamily:a.Font.InterSemiBold600,color:a.Color.colorText},ctnForm:{rowGap:(0,r.SizeDP)(15),marginBottom:(0,r.SizeDP)(20)},ctnAction:{flexDirection:"row",alignItems:"center",justifyContent:"center",columnGap:(0,r.SizeDP)(10)},txtText:{fontSize:r.default.FontTiny,fontFamily:a.Font.InterRegular400,color:"#00204DCC"},viewForm:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginRight:(0,r.SizeDP)(12)}})},85077:function(e,t,n){var l=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(29293)),a=l(n(85715)),i=n(21527),o=n(87841),u=l(n(24541)),s=n(32207),c=n(20880),d=l(n(94196)),f=n(35708),h=n(46317),p=l(n(69290)),y=n(11671),v=n(2884),m=l(n(25517)),g=n(12638),x=n(60596),S=n(47671);t.default=function(e){var t=e.dataTask,n=(0,v.useTranslation)().t,l=(0,i.useState)(!1),j=(0,a.default)(l,2),w=j[0],b=j[1],D=(0,i.useState)(!1),C=(0,a.default)(D,2),k=C[0],T=C[1],M=(0,i.useState)(!1),_=(0,a.default)(M,2),I=_[0],F=_[1],P=(0,i.useState)([]),R=(0,a.default)(P,2),O=R[0],E=R[1],V=(0,y.useTicketServices)(),z=(0,g.useAppSelector)((function(e){return e.ticket})).dataTicketRedux;(0,i.useEffect)((function(){N()}),[]);var A,N=(A=(0,r.default)((function*(){var e,n=null==(e=t.owner)?void 0:e.split(",");if(n){var l=yield V.getMultiLoginAccount(n);l&&E(l)}})),function(){return A.apply(this,arguments)}),L=function(){return T(!k)},$=function(){return F(!I)},B=function(e,t){if(e&&t){var n=Math.floor(new Date(t).getTime())-Math.floor(new Date(e).getTime());return f.DateUtils.convertTime(n)}return"---"},U=function(e){switch(e){case"3":return(0,S.jsx)(h.Iconhigh,{width:16,height:16});case"2":return(0,S.jsx)(h.Iconmedium,{width:16,height:16});case"1":return(0,S.jsx)(h.Iconlow,{width:16,height:16});default:return(0,S.jsx)(u.default,{children:"---"})}},Y=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return(0,S.jsx)(o.Pressable,{onPress:t?L:$,style:m.default.ctnListUser,children:null==e?void 0:e.map((function(n,l){return(0,S.jsx)(S.Fragment,{children:l<=1?(0,S.jsx)(o.Image,{style:{position:"absolute",left:20*l},width:28,height:28,borderRadius:14,source:{uri:(null==n?void 0:n[t?"avatar":"imageUrl"])||c.String.DEFAULT_IMAGE}},l):(0,S.jsx)(o.View,{style:m.default.ctnAdd,children:(0,S.jsx)(u.default,{children:"+"+((null==e?void 0:e.length)-2)})},l)})}))})},H=(0,i.useMemo)((function(){return[{key:"RV.owner",type:"normal",value:{onlyIcon:Y(O,!1)}},{key:"RV.userAction",type:"normal",value:{onlyIcon:Y(t.assignTaskList)}},{key:"RV.status",type:"status",value:{status:(e=t,"todo"===(null==e||null==(l=e.attrJson)?void 0:l.type)?"todo":"processing"===(null==e||null==(r=e.attrJson)?void 0:r.type)?"processing":"completed"===(null==e||null==(a=e.attrJson)?void 0:a.type)?"completed":"approved"===(null==e||null==(i=e.attrJson)?void 0:i.type)?"approved":e.statusType)}},{key:"Estimate",type:"normal",value:{name:B(t.startDate,t.dueDate)}},{key:"HM.priority",type:"normal",value:{onlyIcon:U(t.priority)}},{key:"RV.listTask.startDate",type:"normal",value:{name:f.DateUtils.convertDateToDDMMYYYY_H_M(t.startDate)}},{key:"RV.listTask.endDate",type:"normal",value:{name:f.DateUtils.convertDateToDDMMYYYY_H_M(t.dueDate)}},{key:"RV.listTask.action",type:"normal",value:{onlyIcon:(0,S.jsx)(o.Pressable,{onPress:function(){z.ticketStatus!==x.Status.voided&&o.Alert.alert(n("NT.notification.inprocess_noti"))},style:{width:28,height:28,backgroundColor:"#F2ECFD",borderRadius:14,justifyContent:"center",alignItems:"center"},children:(0,S.jsx)(s.Icon,{fill:"#6F2CED",name:"edit-2",width:16,height:16})})}}];var e,l,r,a,i}),[O]);return(0,S.jsxs)(o.View,{style:{paddingHorizontal:10},children:[(0,S.jsxs)(o.Pressable,{onPress:function(){b(!w)},style:m.default.ctnHeader,children:[(0,S.jsxs)(o.View,{style:m.default.ctnBodyHeader,children:[(0,S.jsx)(o.View,{style:[w&&m.default.rotate],children:(0,S.jsx)(s.Icon,{fill:"#6F2CED",width:16,height:16,name:"play-circle-outline"})}),(0,S.jsx)(u.default,{style:m.default.textTitle,children:n("RV.listTask.title")})]}),(0,S.jsx)(u.default,{style:m.default.tastName,children:t.name})]}),w&&(0,S.jsx)(o.View,{style:{backgroundColor:"#fff",paddingHorizontal:16},children:(0,S.jsx)(d.default,{dataInfo:H})}),(0,S.jsx)(s.Divider,{style:{marginTop:10}}),(0,S.jsx)(p.default,{isVisible:k,title:n("RV.listTask.listUserAction"),onClose:L,renderContent:(0,S.jsx)(s.List,{data:t.assignTaskList,renderItem:function(e){var t=e.item;return(0,S.jsx)(s.ListItem,{children:(0,S.jsxs)(o.View,{style:m.default.listUser,children:[(0,S.jsx)(o.Image,{width:28,height:28,borderRadius:14,source:{uri:t.avatar||c.String.DEFAULT_IMAGE}}),(0,S.jsxs)(o.View,{children:[(0,S.jsx)(u.default,{style:m.default.textname,children:t.name}),(0,S.jsx)(u.default,{children:t.email})]})]})})}})}),(0,S.jsx)(p.default,{isVisible:I,title:n("RV.listTask.listOwner"),onClose:$,renderContent:(0,S.jsx)(s.List,{data:O,renderItem:function(e){var t=e.item;return(0,S.jsx)(s.ListItem,{children:(0,S.jsxs)(o.View,{style:m.default.listUser,children:[(0,S.jsx)(o.Image,{width:28,height:28,borderRadius:14,source:{uri:t.imageUrl||c.String.DEFAULT_IMAGE}}),(0,S.jsxs)(o.View,{children:[(0,S.jsx)(u.default,{style:m.default.textname,children:t.firstName+" "+t.lastName||"---"}),(0,S.jsx)(u.default,{children:t.email})]})]})})}})})]})}},25517:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(87841),r=n(20880);t.default=l.StyleSheet.create({ctnHeader:{backgroundColor:"#fff",flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",columnGap:30},ctnBodyHeader:{flexDirection:"row",alignItems:"center",columnGap:8},rotate:{transform:[{rotate:"90deg"}]},textTitle:{color:"#00204DE5",fontSize:12,fontFamily:r.Font.InterSemiBold600},tastName:{flex:1,fontSize:12,color:"#366AE2",fontFamily:r.Font.InterRegular400},listUser:{flexDirection:"row",alignItems:"center",justifyContent:"center",columnGap:16},textname:{fontSize:14,fontFamily:r.Font.InterSemiBold600},ctnListUser:{flexDirection:"row",position:"relative"},ctnAdd:{position:"absolute",left:40,width:28,height:28,borderRadius:14,backgroundColor:"#F4F4F4",justifyContent:"center",alignItems:"center"}})},30019:function(e,t,n){var l=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(41132)),a=l(n(29293)),i=l(n(85715)),o=n(32207),u=n(21527),s=n(87841),c=l(n(66771)),d=l(n(24541)),f=n(2884),h=n(47671);t.default=function(e){var t=e.data,n=e.dataSelect,l=e.setDataSelect,p=e.isSearch,y=void 0!==p&&p,v=e.onRefresh,m=e.getMore,g=e.placeholder,x=e.isi18n,S=void 0!==x&&x,j=(0,f.useTranslation)().t,w=(0,u.useState)(!1),b=(0,i.default)(w,2),D=b[0],C=b[1],k=(0,u.useState)(t),T=(0,i.default)(k,2),M=T[0],_=T[1],I=(0,u.useState)(""),F=(0,i.default)(I,2),P=F[0],R=F[1],O=(0,c.default)(P,500),E=(0,u.useState)({width:s.Dimensions.get("window").width,height:s.Dimensions.get("window").height}),V=(0,i.default)(E,2),z=V[0],A=V[1];(0,u.useEffect)((function(){var e=s.Dimensions.addEventListener("change",(function(e){var t=e.window;A({width:t.width,height:t.height})}));return function(){return e.remove()}}),[]),(0,u.useEffect)((function(){L(O)}),[O]);var N,L=function(e){_(t.filter((function(t){return t.label.toLowerCase().includes(e.toLowerCase())})))},$=(N=(0,a.default)((function*(){y&&(C(!0),null==v||v((function(){return C(!1)})))})),function(){return N.apply(this,arguments)});return(0,h.jsxs)(h.Fragment,{children:[y&&(0,h.jsx)(o.Input,{allowFontScaling:!1,value:P,onChangeText:R,placeholder:g,style:{backgroundColor:"#fff"},accessoryRight:P?(0,h.jsx)(s.TouchableOpacity,{hitSlop:15,onPress:function(){return R("")},children:(0,h.jsx)(o.Icon,{name:"close-outline"})}):void 0}),(0,h.jsx)(o.List,{showsVerticalScrollIndicator:!1,style:{backgroundColor:"#fff",height:z.height/3*2},data:M,onEndReachedThreshold:.5,onRefresh:$,refreshing:D,onEndReached:function(){y&&(null==m||m())},renderItem:function(e){var t=e.item;return(0,h.jsx)(o.ListItem,{onPress:function(){n.includes(t.value)?l(n.filter((function(e){return e!==t.value}))):l([].concat((0,r.default)(n),[t.value]))},title:function(e){return(0,h.jsx)(d.default,Object.assign({},e,{children:S?j(`${t.label}`):t.label}))},accessoryRight:n.includes(t.value)?(0,h.jsx)(o.Icon,{fill:"#06B7E8",width:14,height:14,name:"checkmark-outline"}):void 0})}})]})}},62921:function(e,t,n){var l=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(32207),a=n(87841),i=l(n(95556)),o=l(n(24541)),u=n(2884),s=n(47671);t.default=function(e){var t=e.onClose,n=e.visible,l=e.rangeDate,c=e.onConfirm,d=(0,u.useTranslation)().t;return(0,s.jsx)(r.Modal,{backdropStyle:i.default.backdrop,onBackdropPress:t,visible:n,children:(0,s.jsx)(r.RangeCalendar,{style:{backgroundColor:"#fff"},range:l,onSelect:function(e){return c(e)},min:new Date(1900,0,0),max:new Date,renderFooter:function(){return(0,s.jsxs)(a.View,{style:{alignItems:"center",justifyContent:"flex-end",flexDirection:"row",columnGap:6,marginRight:16,marginTop:16},children:[(0,s.jsx)(r.Button,{onPress:function(){return c({})},size:"small",status:"info",appearance:"outline",children:function(e){return(0,s.jsx)(o.default,Object.assign({},e,{children:d("CM.undo")}))}}),(0,s.jsx)(r.Button,{onPress:t,size:"small",appearance:"outline",status:"primary",children:function(e){return(0,s.jsx)(o.default,Object.assign({},e,{children:d("CM.select")}))}})]})}})})}},7241:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.listFilter=void 0;t.listFilter=[{label:"Trạng thái giao dịch",value:"status"},{label:"Nhóm dịch vụ",value:"group"},{label:"Quy trình",value:"modeler"},{label:"Mức độ ưu tiên",value:"priority"},{label:"Ngày tạo",value:"created_at"},{label:"Hạn hoàn thành",value:"due_date"},{label:"Trễ hạn",value:"late"}]},81584:function(e,t,n){var l=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(n(41132)),a=l(n(29293)),i=l(n(85715)),o=n(32207),u=n(7005),s=n(87841),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=I(t);if(n&&n.has(e))return n.get(e);var l={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var i=r?Object.getOwnPropertyDescriptor(e,a):null;i&&(i.get||i.set)?Object.defineProperty(l,a,i):l[a]=e[a]}return l.default=e,n&&n.set(e,l),l}(n(21527)),d=n(14740),f=n(20880),h=n(12638),p=n(2543),y=n(72676),v=n(2884),m=l(n(69290)),g=l(n(24541)),x=n(98884),S=n(7241),j=n(60596),w=l(n(62921)),b=l(n(30019)),D=n(11595),C=n(35708),k=l(n(95556)),T=n(41995),M=n(11671),_=n(47671);function I(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(I=function(e){return e?n:t})(e)}t.default=function(){var e,t=(0,v.useTranslation)().t,n=(0,d.useRoute)(),l=null==n||null==(e=n.params)?void 0:e.type,I=(0,d.useNavigation)(),F=(0,u.useSafeAreaInsets)(),P=(0,c.useRef)(null),R=(0,c.useState)([]),O=(0,i.default)(R,2),E=O[0],V=O[1],z=(0,c.useState)(""),A=(0,i.default)(z,2),N=A[0],L=A[1],$=(0,c.useState)(0),B=(0,i.default)($,2),U=B[0],Y=B[1],H=(0,c.useState)(0),K=(0,i.default)(H,2),W=K[0],G=K[1],J=(0,c.useState)(0),q=(0,i.default)(J,2),Q=q[0],X=q[1],Z=(0,c.useState)(0),ee=(0,i.default)(Z,2),te=ee[0],ne=ee[1],le=(0,c.useState)(!1),re=(0,i.default)(le,2),ae=re[0],ie=re[1],oe=(0,h.useAppSelector)((function(e){return e.account})).dataAccount,ue=(0,h.useAppSelector)((function(e){return e.common})).accessToken,se=(0,c.useState)(""),ce=(0,i.default)(se,2),de=ce[0],fe=ce[1],he=(0,M.useTicketServices)(),pe=(0,p.debounce)((function(e){fe(e)}),300),ye=(0,c.useState)(""),ve=(0,i.default)(ye,2),me=ve[0],ge=ve[1],xe=(0,c.useState)([]),Se=(0,i.default)(xe,2),je=Se[0],we=Se[1],be=(0,c.useState)([]),De=(0,i.default)(be,2),Ce=De[0],ke=De[1],Te=(0,c.useState)([]),Me=(0,i.default)(Te,2),_e=Me[0],Ie=Me[1],Fe=(0,c.useState)([]),Pe=(0,i.default)(Fe,2),Re=Pe[0],Oe=Pe[1],Ee=(0,c.useState)([]),Ve=(0,i.default)(Ee,2),ze=Ve[0],Ae=Ve[1],Ne=(0,c.useState)([]),Le=(0,i.default)(Ne,2),$e=Le[0],Be=Le[1],Ue=(0,c.useState)({}),Ye=(0,i.default)(Ue,2),He=Ye[0],Ke=Ye[1],We=(0,c.useState)({}),Ge=(0,i.default)(We,2),Je=Ge[0],qe=Ge[1],Qe=(0,c.useState)({}),Xe=(0,i.default)(Qe,2),Ze=Xe[0],et=Xe[1],tt=(0,s.useWindowDimensions)().width;(0,c.useEffect)((function(){ft()}),[]),(0,c.useEffect)((function(){X(0),Oe([]),Ae([]),ht(0,je)}),[je]),(0,c.useEffect)((function(){return pe(N),function(){pe.cancel()}}),[N]),(0,c.useEffect)((function(){if(st())return V([]),Y(0),void ne(0);"my-ticket"===l?ct(de,Ce,$e,je,He,Ze,Je,Re):dt(de,Ce,He,Re,je),ne(0)}),[de,Ce,$e,je,He,Ze,Je,Re]);var nt,lt,rt,at,it,ot,ut,st=function(){return 0==Ce.length&&0==$e.length&&0==je.length&&0==Object.keys(He).length&&0==Object.keys(Je).length&&0==Object.keys(Ze).length&&0==Re.length&&!de},ct=function(e,t,n,l,r,a,i,o){t.length>0||n.length>0||l.length>0||Object.keys(r).length>0||Object.keys(i).length>0||Object.keys(a).length>0||o.length>0||!(0,p.isEmpty)(e)?vt(0,e,t,n,l,r,a,i,o):V([])},dt=function(e,t,n,l,r){r.length>0||t.length>0||Object.keys(n).length>0||l.length>0||!(0,p.isEmpty)(e)?mt(0,e,t,n,l,r):V([])},ft=(nt=(0,a.default)((function*(){try{var e=(yield he.getServiceMenu(te,1e6,"",ue)).content.map((function(e){return{label:e.serviceName,value:e.id}}));Ie(e)}catch(e){}})),function(){return nt.apply(this,arguments)}),ht=(lt=(0,a.default)((function*(e,t){try{var n={page:e,size:1e3,sort:"createdDate,desc"},l={serviceId:t||[]},a=yield he.getListModelerByListServiceId(n,l);if(a){var i;G(null==a?void 0:a.totalPages);var o=null==a||null==(i=a.content)?void 0:i.map((function(e){return{label:e.name,value:e.id}}));Ae(0===e?o:[].concat((0,r.default)(ze),(0,r.default)(o)))}}catch(e){}})),function(e,t){return lt.apply(this,arguments)}),pt=(rt=(0,a.default)((function*(e){X(0),yield ht(0,Re),e()})),function(e){return rt.apply(this,arguments)}),yt=(at=(0,a.default)((function*(){Q<W&&(yield ht(Q+1,Re),X((function(e){return e+1})))})),function(){return at.apply(this,arguments)}),vt=(it=(0,a.default)((function*(e,t,n,l,a,i,o,u,s){try{var c,d,f={createdBy:null!=(c=null==oe?void 0:oe.email)?c:"",myTicket:!0,textSearch:t,ticketStatus:n||[],priority:l||[],service:a||[],delayDateFrom:o.startDate||null,delayDateTo:o.endDate||null,endDate:i.endDate||null,estimateDateFrom:u.startDate||null,estimateDateTo:u.endDate||null,startDate:i.startDate||null,workflow:s||[]},h=yield he.getTicketList(e,50,"createdDate,desc",ue,f);V(0===e?null==h?void 0:h.content:[].concat((0,r.default)(E),(0,r.default)(null==h?void 0:h.content))),Y(Number(null==h||null==(d=h.page)?void 0:d.totalRecords))}catch(e){}finally{ie(!1)}})),function(e,t,n,l,r,a,i,o,u){return it.apply(this,arguments)}),mt=(ot=(0,a.default)((function*(e,t,n,l,a,i){try{var o={keyWord:t,terms:{status:n.length>0?n:[j.Status.processing,j.Status.accepted,j.Status.rejected,j.Status.voided]},from:l.startDate||null,to:l.endDate||null,id:null,field:"createdDate"};a&&a.length>0&&(o.terms.modelerId=a),i&&i.length>0&&(o.terms.serviceId=i);var u,s=yield he.getTicketListFollow(e,50,"createdDate,desc",o,ue);s&&(V(0===e?null==s?void 0:s.content:[].concat((0,r.default)(E),(0,r.default)(null==s?void 0:s.content))),Y(Number(null==s||null==(u=s.page)?void 0:u.totalRecords)))}catch(e){}finally{ie(!1)}})),function(e,t,n,l,r,a){return ot.apply(this,arguments)}),gt=function(e){switch(e){case"status":return 0==Ce.length?f.Color.borderColor:"#048EC7";case"group":return 0===je.length?f.Color.borderColor:"#048EC7";case"priority":return 0==$e.length?f.Color.borderColor:"#048EC7";case"modeler":return 0==Re.length?f.Color.borderColor:"#048EC7";case"created_at":return Object.keys(He).length>0?"#048EC7":f.Color.borderColor;case"due_date":return Object.keys(Je).length>0?"#048EC7":f.Color.borderColor;case"late":return Object.keys(Ze).length>0?"#048EC7":f.Color.borderColor;default:return f.Color.borderColor}},xt=function(e){switch(e.value){case"created_at":return wt(He,e.value);case"due_date":return wt(Je,e.value);case"late":return wt(Ze,e.value);case"group":return St(je,e.value,e.value);case"priority":return jt($e,e.value);case"modeler":return St(Re,e.value,e.value);case"status":return jt(Ce,e.value);default:return""}},St=function(e,n,l){return 0===(null==e?void 0:e.length)?t(`SR.${n}`):1===(null==e?void 0:e.length)?"modeler"===l?null==ze||null==(r=ze.find((function(t){return t.value===e[0]})))?void 0:r.label:null==_e||null==(a=_e.find((function(t){return t.value===e[0]})))?void 0:a.label:(null==e?void 0:e.length)>1?"modeler"===l?`${null==(i=ze.find((function(t){return t.value===e[0]})))?void 0:i.label} + ${(e.length-1).toString()}`:`${null==_e||null==(o=_e.find((function(t){return t.value===e[0]})))?void 0:o.label} + ${(e.length-1).toString()}`:void 0;var r,a,i,o},jt=function(e,n){return 0===(null==e?void 0:e.length)?t(`SR.${n}`):1===(null==e?void 0:e.length)?t(`TK.${e[0]}`):(null==e?void 0:e.length)>1?t(`TK.${e[0]}`)+" + "+((null==e?void 0:e.length)-1):void 0},wt=function(e,n){return 0===Object.keys(e).length?t(`SR.${n}`):e.endDate?`${C.DateUtils.convertDateToDDMMYYYY(e.startDate)} - ${C.DateUtils.convertDateToDDMMYYYY(e.endDate)}`:`${C.DateUtils.convertDateToDDMMYYYY(e.startDate)} - now`};return(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(s.StatusBar,{barStyle:"dark-content",backgroundColor:f.Color.Transparent}),(0,_.jsx)(s.TouchableWithoutFeedback,{onPress:function(){return s.Keyboard.dismiss()},children:(0,_.jsx)(u.SafeAreaView,{edges:["top"],style:{backgroundColor:f.Color.BgPrimary,flex:1},children:(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(o.Input,{style:{backgroundColor:f.Color.BgPrimary,borderWidth:0},textStyle:{color:"#fff"},placeholderTextColor:"#fff",ref:P,placeholder:t("SR.searchTicket"),value:N,status:"basic",autoFocus:!0,allowFontScaling:!1,onChangeText:function(e){return L(e)},accessoryLeft:(0,_.jsx)(s.TouchableOpacity,{onPress:function(){return I.goBack()},children:(0,_.jsx)(o.Icon,{name:"arrow-back",fill:"#ffffff"})}),accessoryRight:N?(0,_.jsx)(s.TouchableOpacity,{onPress:function(){return L("")},children:(0,_.jsx)(o.Icon,{name:"close-outline",fill:"#ffffff"})}):void 0}),(0,_.jsx)(o.Divider,{}),(0,_.jsxs)(o.Layout,{style:{flex:1,paddingBottom:F.bottom,backgroundColor:"#fff"},level:"1",children:[(0,_.jsx)(s.View,{children:(0,_.jsx)(s.ScrollView,{showsHorizontalScrollIndicator:!1,contentContainerStyle:{columnGap:10,padding:10},horizontal:!0,children:("my-ticket"===l?S.listFilter:S.listFilter.filter((function(e){return"status"===e.value||"created_at"===e.value||"group"===e.value||"modeler"===e.value}))).map((function(e){return(0,_.jsxs)(s.TouchableOpacity,{onPress:function(){ge(e.value)},style:[{borderColor:gt(e.value)},k.default.ctnFilter],children:[(0,_.jsx)(g.default,{children:xt(e)}),(0,_.jsx)(o.Icon,{width:16,height:16,name:me===e.value?"chevron-up-outline":"chevron-down-outline"})]},e.label)}))})}),!st()&&(0,_.jsx)(o.List,{style:{backgroundColor:"#fff",flex:1},showsVerticalScrollIndicator:!1,data:E,renderItem:function(e){var n=e.item,r=(e.index,"my-ticket"===l?y.dataListStatusTicket.find((function(e){return e.status===n.ticketStatus})):D.dataListStatusTicketFollow.find((function(e){return e.status===n.status})));return(0,_.jsx)(o.ListItem,{onPress:function(){var e;I.navigate(f.NavigationName.BottomTabNavigationTicketDetail,{dataTicketId:"my-ticket"===l?null==n?void 0:n.id:null==n||null==(e=n.resourceId)?void 0:e.substr(4),email:"my-ticket"===l?n.createdBy:n.owner,status:"my-ticket"===l?n.ticketStatus:n.status,selectTabBottom:"my-ticket"===l?1:2,recipientDetailsId:n.implementId,userTaskId:n.recipientId})},children:(0,_.jsxs)(s.View,{style:k.default.ctnMain,children:[(0,_.jsxs)(s.View,{style:k.default.ctnBody,children:[(0,_.jsx)(o.Icon,{width:30,height:30,fill:null==r?void 0:r.color,name:"credit-card-outline"}),(0,_.jsxs)(s.View,{style:{flex:1,gap:4},children:[(0,_.jsx)(g.default,{style:{fontFamily:f.Font.InterSemiBold600,fontSize:16},children:`${"my-ticket"===l?n.title:n.resourceName}`}),(0,_.jsx)(g.default,{children:""+("my-ticket"===l?`${t("SR.modeler")}: ${n.serviceName||"---"}`:`${t("TK.step")}: `+n.notionName)}),(0,_.jsxs)(s.View,{style:{flexDirection:"row",alignItems:"center",justifyContent:tt>=T.TYPE_SCREEN.mobile?"flex-start":"space-between",columnGap:tt>=T.TYPE_SCREEN.mobile?20:0},children:[(0,_.jsx)(g.default,{style:{fontStyle:"italic",fontSize:12},children:`${t("SR.created_at")}: `+C.DateUtils.convertDateToDDMMYYYY_H_M(n.createdDate)}),(0,_.jsx)(s.View,{style:{backgroundColor:null==r?void 0:r.bgColor,borderRadius:4,paddingHorizontal:4,paddingVertical:2,minWidth:100},children:(0,_.jsx)(g.default,{style:{color:null==r?void 0:r.color,fontSize:12,textAlign:"center"},children:t(`TK.${"my-ticket"===l?n.ticketStatus:n.status}`)})})]})]})]}),(0,_.jsx)(s.View,{children:(0,_.jsx)(o.Icon,{width:20,height:20,name:"chevron-right-outline"})})]})})},refreshing:ae,onRefresh:function(){ne(0),"my-ticket"===l?vt(1,de,Ce,$e,je,He,Ze,Je,Re):mt(1,de,Ce,He,Re,je)},onEndReached:function(){E.length<U&&(ne(te+1),"my-ticket"===l?vt(te+1,de,Ce,$e,je,He,Ze,Je,Re):mt(te+1,de,Ce,He,Re,je))},onEndReachedThreshold:.5,ListEmptyComponent:function(){return(0,_.jsx)(s.View,{style:{margin:10,flex:1},children:(0,_.jsx)(g.default,{children:t("CM.emptyData")})})}})]})]})})}),(0,_.jsx)(m.default,{isVisible:"status"===me,title:t("SR.selectStatus"),onClose:function(){return ge("")},renderContent:(ut="my-ticket"===l?x.dataStatus:[{label:"TK.processing",value:j.Status.processing},{label:"TK.completed",value:j.Status.accepted},{label:"TK.voided",value:j.Status.voided},{label:"TK.rejected",value:j.Status.rejected},{label:"TK.overdue",value:j.Status.overdue}],(0,_.jsx)(_.Fragment,{children:(0,_.jsx)(b.default,{isi18n:!0,data:ut,dataSelect:Ce,setDataSelect:ke})}))}),(0,_.jsx)(m.default,{isVisible:"priority"===me,title:t("HM.priotitySelect"),onClose:function(){return ge("")},renderContent:(0,_.jsx)(b.default,{isi18n:!0,data:x.dataPrioritySelect,dataSelect:$e,setDataSelect:Be})}),(0,_.jsx)(m.default,{isVisible:"group"===me,title:t("SR.selectGroup"),onClose:function(){return ge("")},renderContent:(0,_.jsx)(b.default,{data:_e,dataSelect:je,setDataSelect:we})}),"modeler"===me&&(0,_.jsx)(m.default,{isVisible:"modeler"===me,title:t("SR.selectService"),onClose:function(){return ge("")},renderContent:(0,_.jsx)(b.default,{data:ze,dataSelect:Re,setDataSelect:Oe,isSearch:!0,placeholder:t("SR.selectService"),onRefresh:pt,getMore:yt})}),(0,_.jsx)(w.default,{onClose:function(){return ge("")},visible:"created_at"===me,onConfirm:Ke,rangeDate:He}),(0,_.jsx)(w.default,{onClose:function(){return ge("")},visible:"due_date"===me,onConfirm:qe,rangeDate:Je}),(0,_.jsx)(w.default,{onClose:function(){return ge("")},visible:"late"===me,onConfirm:et,rangeDate:Ze})]})}},95556:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(87841);t.default=l.StyleSheet.create({backdrop:{backgroundColor:"rgba(0, 0, 0, 0.5)"},ctnMain:{flexDirection:"row",alignItems:"center",flex:1,gap:10},ctnBody:{flex:1,flexDirection:"row",alignItems:"center",gap:10},ctnFilter:{flexDirection:"row",columnGap:6,alignItems:"center",justifyContent:"center",borderWidth:1,paddingHorizontal:10,paddingVertical:6,borderRadius:6}})}}]);//# sourceMappingURL=src_app_screens_review-flow_tab-view_components_Document_index_tsx-src_app_screens_review-flo-8f3fda.bundle.map?platform=ios/* RCSSB */eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJoYXNoIjoiNWM2MzExNDJjYTZjOTliZDMzYTMzMzMyYTI2MzU3Nzc1N2Q3YThlNzY1MDI2MzE3YzM1ODA0MDg1MjY0MTk2NiIsImlhdCI6MTc0OTYzNTY3N30.tdmqqBrCJl3PNtpyo3alPC3SEEJVdfvn79eZELu-KiJ-gSI8VIbD_NqlZNO56oxcpfwQ6RNo6qMyc4GhT9Jhwinil8U7_MYKJBGeiek6OTSyu-I48ZYhrBL_oNfE_V-t8ozgEE3Tq758YqcDpd2fHfmxunpii8v13AQ_j3SfRQA1a2_nqrTvQEY5h5ADGFCDCbQb4hLnjTg9OZMO9HeH4Cj0-u3FLnLqwuMw6DKAsX_w1nWpWWOqzxplIMWTe6-V0tp0GIukLtY9Cd-arDtJnrJjPgcJDfFSaMFnIT4HYCEQclb29XO85J8blpGIs_tGfE5oChEY8p7eii76L9qtwSw_5Lhp4OFGyWrzvAV3f2P7SGG4WAIJ5L8YFgI7TJsTqlBPIMbYw4ozdAY1OXPIPF-ZstKHHyXG7CnHxOsJnl7-K7PDcoxfyPXa6UjzjYCGsRX5gb0hSKivtKYyRrlWUpWiQzKBGk3JLP95UNbt5j7dv4QpqFtDbhOhuUumLjVfhyC4fQW3Hf27fvz_WJpXaCjTC9v2zX79P4-KRuLU3Xm1C3iE6ITY952g0K9fAwsc0sCWivSKsEfmclelaVLnZ2UpaTslBbjN7U9qoNYs1PlIEdwi6xT6I8JDZSSoYqPpbt2LW_uZxLJuoGBV9lohSICQMBO9R6MKyZeKET1sdv0                                                                                                                                                                                                                                                                                                                                                                                                                                         