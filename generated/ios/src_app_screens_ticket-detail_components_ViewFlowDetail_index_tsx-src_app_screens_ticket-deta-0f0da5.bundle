var self=self||this||new Function("return this")()||{};(self.webpackChunkerequestApp=self.webpackChunkerequestApp||[]).push([["src_app_screens_ticket-detail_components_ViewFlowDetail_index_tsx-src_app_screens_ticket-deta-0f0da5"],{86288:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=n(87841),o=i(n(24541)),u=i(n(88420)),s=n(41995),c=n(35708),d=n(46317),f=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=D(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),p=n(32207),m=n(68289),h=n(40851),y=n(12638),v=i(n(77389)),g=n(2884),x=i(n(76644)),w=i(n(93238)),S=n(88e3),j=n(20880),b=n(47671);function D(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(D=function(e){return e?n:t})(e)}var C=[{id:1,key:"TK.editAction",value:"edit",icon:(0,b.jsx)(d.IconEdit,{width:(0,s.SizeDP)(20),height:(0,s.SizeDP)(20)})},{id:2,key:"TK.deleteComment",value:"trash",icon:(0,b.jsx)(d.IconTrash,{width:(0,s.SizeDP)(20),height:(0,s.SizeDP)(20)})}],T=f.default.memo((function(e){var t,n,i=e.data,d=e.user,D=e.setComment,I=e.deleteComment,k=e.allComments,P=e.onReplyClick,_=e.level,M=e.listDataUser,F=(0,g.useTranslation)().t,O=(0,f.useState)(!1),E=(0,a.default)(O,2),V=E[0],z=E[1],R=(0,f.useState)(!1),A=(0,a.default)(R,2),N=A[0],L=A[1],B=(0,f.useState)(!1),U=(0,a.default)(B,2),W=U[0],$=U[1],Y=(0,f.useState)(!1),H=(0,a.default)(Y,2),K=H[0],G=H[1],J=(0,f.useState)(""),q=(0,a.default)(J,2),Q=q[0],X=q[1],Z=(0,f.useState)(d),ee=(0,a.default)(Z,1)[0],te=(0,h.useReviewServices)(),ne=(0,y.useAppSelector)((function(e){return e.common})).accessToken,ie=(0,y.useAppSelector)((function(e){return e.account})).dataAccount,re=k.get(i.id)||[],ae=function(){$(!W)},le=(t=(0,r.default)((function*(){try{G(!0);var e=new FormData;e.append("keyName",i.attachment),e.append("bucketName",i.bucketName);var t=yield te.viewFile(e,ne);1==(null==t?void 0:t.code)?(X(t.message),L(!0)):l.Alert.alert(F("CM.info"),F("CM.error"))}catch(e){}finally{G(!1)}})),function(){return t.apply(this,arguments)}),oe=(n=(0,r.default)((function*(){try{G(!0);var e=`${(0,S.getConfig)().BASE_URL}/services/erequest/api/comments/download-file?commentId=${i.id}`,t=yield c.CommonUtils.downloadFile(i.fileName,e);"success"===t.status?v.default.show({type:"success",text1:F("CM.downloadSuccess")}):"error"===t.status&&v.default.show({type:"error",text1:F("CM.downloadFail")})}catch(e){v.default.show({type:"error",text1:F("CM.downloadFail")})}finally{G(!1)}})),function(){return n.apply(this,arguments)}),ue=function(){z(!V)};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(l.View,{style:u.default.ctnMain,children:[(0,b.jsx)(l.View,{style:u.default.ctnImage,children:(0,b.jsx)(l.Image,{width:(0,s.SizeDP)(24),height:(0,s.SizeDP)(24),borderRadius:(0,s.SizeDP)(12),source:{uri:(null==ee?void 0:ee.imageUrl)||j.String.DEFAULT_IMAGE}})}),(0,b.jsxs)(l.View,{style:{flex:1},children:[(0,b.jsxs)(l.View,{style:u.default.ctnSecond,children:[(0,b.jsx)(o.default,{style:u.default.ctnName,children:null!=ee&&ee.personalName?(null==ee?void 0:ee.personalName)+"â€¢ ":"---"}),(0,b.jsx)(o.default,{style:u.default.ctnEmail,children:null==ee?void 0:ee.email})]}),(0,b.jsx)(o.default,{style:u.default.ctnTime,children:c.DateUtils.convertDateToDDMMYYYY_H_M(i.lastModifiedDate)}),function(e){var t=(0,m.decodeUnicodeToEmoji)(e);if(!t)return i.fileName?(0,b.jsxs)(l.View,{style:u.default.ctnViewFile,children:[(0,b.jsxs)(l.Pressable,{onPress:le,style:u.default.styleFile,children:[(0,b.jsx)(o.default,{numberOfLines:1,style:u.default.content,children:""+i.fileName}),K&&(0,b.jsx)(p.Spinner,{size:"tiny"})]}),(0,b.jsx)(l.Pressable,{onPress:oe,children:(0,b.jsx)(p.Icon,{name:"download-outline",width:24,height:24})})]}):(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(o.default,{style:u.default.content,children:"'---'"})});if(!t.includes('class="user_tag"'))return i.fileName?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(o.default,{style:u.default.content,children:(0,m.decodeUnicodeToEmoji)(t)}),(0,b.jsxs)(l.View,{style:u.default.ctnViewFile,children:[(0,b.jsxs)(l.Pressable,{onPress:le,style:u.default.styleFile,children:[(0,b.jsx)(o.default,{numberOfLines:1,style:u.default.content,children:""+i.fileName}),K&&(0,b.jsx)(p.Spinner,{size:"tiny"})]}),(0,b.jsx)(l.Pressable,{onPress:oe,children:(0,b.jsx)(p.Icon,{name:"download-outline",width:24,height:24})})]})]}):(0,b.jsx)(l.View,{style:u.default.bodyView,children:(0,b.jsx)(o.default,{style:u.default.content,children:(0,m.decodeUnicodeToEmoji)(t)})});if(t.includes('class="user_tag"')){var n=t.split("\n").map((function(e){return(0,m.splitStringWithSpans)(e).map((function(e){var t,n;return e.includes('class="user_tag"')?`${null==(t=(0,m.extractSpanList)(e))||null==(n=t[0])?void 0:n.textContent}`:e})).map((function(e,t){return e.startsWith("@")?(0,b.jsx)(o.default,{style:u.default.tag,children:`${e.slice(1)}`}):(0,b.jsx)(o.default,{style:u.default.content,children:`${e}`})}))}));return(0,b.jsx)(l.View,{style:u.default.bodyView,children:n.map((function(e,t){return(0,b.jsx)(l.View,{style:u.default.ctnViewGroup,children:e.map((function(e,t){return(0,b.jsx)(l.View,{children:e},t)}))},t)}))})}}(i.content),(0,b.jsxs)(l.View,{style:u.default.ctnReplyView,children:[(0,b.jsx)(l.Pressable,{onPress:function(){return function(e){P("reply",e),$(!0)}(i)},hitSlop:(0,s.SizeDP)(15),children:(0,b.jsx)(o.default,{style:u.default.ctnReply,children:F("CM.reply")})}),re.length>0&&(0,b.jsx)(b.Fragment,{children:W?(0,b.jsx)(l.Pressable,{onPress:ae,style:u.default.ctnToggleShow,children:(0,b.jsx)(o.default,{style:{fontSize:12},children:F("CM.thugon")})}):(0,b.jsxs)(l.Pressable,{onPress:ae,style:u.default.ctnToggleShow,children:[(0,b.jsx)(p.Icon,{fill:"#00204DE5",name:"message-circle-outline",width:16,height:16}),(0,b.jsxs)(o.default,{style:{fontSize:12},children:[F("CM.view")," ",null==re?void 0:re.length," ",F("CM.comment")]})]})})]})]}),(null==ee?void 0:ee.email)===ie.email&&(0,b.jsx)(l.View,{style:{},children:(0,b.jsx)(p.OverflowMenu,{anchor:function(){return(0,b.jsx)(l.TouchableOpacity,{onPress:ue,children:(0,b.jsx)(p.Icon,{width:20,height:20,name:"more-vertical"})})},visible:V,onBackdropPress:ue,children:C.map((function(e){return(0,b.jsx)(p.MenuItem,{accessoryLeft:(0,b.jsx)(p.Icon,{name:e.value}),title:F(e.key),onPress:function(){return function(e){switch(e.value){case"edit":ue(),P("edit",i);break;case"trash":ue(),I(i.id)}}(e)}},e.value)}))})})]}),W&&(0,b.jsx)(l.View,{style:{marginLeft:30,marginTop:10},children:null==re?void 0:re.map((function(e){return(0,b.jsx)(T,{data:e,user:null==M?void 0:M.find((function(t){return t.email===e.createdBy})),listDataUser:M,setComment:D,deleteComment:I,allComments:k,onReplyClick:P,level:_+1},e.id)}))}),(0,b.jsx)(x.default,{isVisible:N,children:(0,b.jsxs)(l.View,{style:u.default.ctnView,children:[(0,b.jsx)(l.View,{style:u.default.ctnBodyView,children:(0,b.jsx)(l.Pressable,{onPress:function(){return L(!1)},children:(0,b.jsx)(p.Icon,{name:"close",width:24,height:24})})}),(0,b.jsx)(l.View,{style:{flex:1},children:Q&&(0,b.jsx)(w.default,{startInLoadingState:!0,source:{uri:Q}})})]})})]})}));t.default=T},88420:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(41995)),a=n(20880);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}t.default=i.StyleSheet.create({ctnImage:{width:(0,r.SizeDP)(24),height:(0,r.SizeDP)(24),borderRadius:(0,r.SizeDP)(12),overflow:"hidden",backgroundColor:a.Color.BgPrimary},ctnTime:{color:"#00204DB2",fontSize:r.default.FontTinier,fontFamily:a.Font.InterRegular400},ctnEmail:{color:"#00204DB2",fontSize:r.default.FontTiny,fontFamily:a.Font.InterSemiBold600},ctnName:{fontSize:r.default.FontTiny,color:"#00204D",fontFamily:a.Font.InterSemiBold600},ctnMain:{flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",columnGap:"ios"==i.Platform.OS?16:12,marginBottom:10},ctnSecond:{flex:1,flexDirection:"row",alignItems:"flex-start",justifyContent:"flex-start",flexWrap:"wrap"},ctnReply:{color:"#366AE2",fontSize:r.default.FontTiny,fontFamily:a.Font.InterMedium500},content:{color:"#00204DE5",fontSize:r.default.FontSmallest,fontFamily:a.Font.InterRegular400},tag:{color:"#62248F",fontSize:r.default.FontSmall,fontFamily:a.Font.InterRegular400},contentTag:{color:"#00204DE5",fontSize:r.default.FontSmallest,fontFamily:a.Font.InterRegular400},bodyView:{marginVertical:8},styleFile:{paddingHorizontal:10,paddingVertical:6,backgroundColor:"#e8e5e5de",borderRadius:8,marginVertical:3,maxWidth:130,justifyContent:"space-between",alignItems:"center",flexDirection:"row"},ctnViewFile:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:8},ctnReplyView:{flexDirection:"row-reverse",alignItems:"center",justifyContent:"flex-end",columnGap:10},ctnToggleShow:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:6,paddingVertical:3},ctnView:{backgroundColor:"#fff",height:"100%"},ctnBodyView:{justifyContent:"flex-end",alignItems:"flex-end",marginRight:16,marginBottom:10},ctnViewGroup:{flexDirection:"row",alignItems:"center",columnGap:8}})},68289:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.extractSpanList=t.encodeEmojiToUnicode=t.decodeUnicodeToEmoji=void 0,t.filterCommentsByParentId=function(e){var t=new Map;return e.forEach((function(e){var n=null===e.commentId?"root":e.commentId;t.has(n)||t.set(n,[]),t.get(n).push(e)})),t},t.splitStringWithSpans=void 0;t.decodeUnicodeToEmoji=function(e){return e.replace(/\\u\{([0-9A-F]{1,6})\}/g,(function(e,t){return String.fromCodePoint(parseInt(t,16))})).replace(/\\u([0-9A-F]{4})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))}))},t.encodeEmojiToUnicode=function(e){return e.replace(/([\uD800-\uDBFF][\uDC00-\uDFFF])|([^\n])/g,(function(e,t,n){return t?"\\u{"+(1024*(t.charCodeAt(0)-55296)+(t.charCodeAt(1)-56320)+65536).toString(16).toUpperCase()+"}":n?"\\u"+n.charCodeAt(0).toString(16).toUpperCase().padStart(4,"0"):e}))},t.extractSpanList=function(e){for(var t,n=/<span(?: [^>]*id="([^"]*)")?(?: [^>]*data-user-id="([^"]*)")?(?: [^>]*data-email="([^"]*)")?(?: [^>]*data-org-in="([^"]*)")?(?: [^>]*data-cust-id="([^"]*)")?[^>]*>(.*?)<\/span>/g,i=[];null!==(t=n.exec(e));)i.push({id:t[1],userId:t[2],email:t[3],orgIn:t[4],custId:t[5],textContent:t[6].trim()});return i},t.splitStringWithSpans=function(e){var t=/<span[^>]*>.*?<\/span>/g,n=e.match(t),i=e.split(t),r=[];return i.forEach((function(e,t){e.trim()&&r.push(e.trim()),n&&n[t]&&r.push(n[t])})),r}},55087:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(41132)),a=i(n(29293)),l=i(n(85715)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=C(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),u=n(14740),s=n(41995),c=n(46317),d=n(87841),f=i(n(7259)),p=i(n(86288)),m=n(12638),h=n(68289),y=i(n(31263)),v=n(11671),g=n(32207),x=i(n(43184)),w=n(2884),S=i(n(24541)),j=n(20880),b=n(45335),D=n(47671);function C(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(C=function(e){return e?n:t})(e)}t.default=function(e){var t=e.onClose,n=(0,w.useTranslation)().t,i=(0,o.useState)([]),C=(0,l.default)(i,2),T=C[0],I=C[1],k=(0,o.useState)([]),P=(0,l.default)(k,2),_=P[0],M=P[1],F=(0,o.useState)([]),O=(0,l.default)(F,2),E=O[0],V=O[1],z=(0,o.useState)([]),R=(0,l.default)(z,2),A=R[0],N=R[1],L=(0,o.useState)(""),B=(0,l.default)(L,2),U=B[0],W=B[1],$=(0,o.useState)(!1),Y=(0,l.default)($,2),H=Y[0],K=Y[1],G=(0,o.useState)(!1),J=(0,l.default)(G,2),q=J[0],Q=J[1],X=(0,o.useState)(),Z=(0,l.default)(X,2),ee=Z[0],te=Z[1],ne=(0,o.useState)(null),ie=(0,l.default)(ne,2),re=ie[0],ae=ie[1],le=(0,o.useState)(!1),oe=(0,l.default)(le,2),ue=oe[0],se=oe[1],ce=(0,o.useState)("new"),de=(0,l.default)(ce,2),fe=de[0],pe=de[1],me=(0,o.useState)(!1),he=(0,l.default)(me,2),ye=he[0],ve=he[1],ge=(0,o.useState)("loading"),xe=(0,l.default)(ge,2),we=xe[0],Se=xe[1],je=(0,o.useState)([]),be=(0,l.default)(je,2),De=be[0],Ce=be[1],Te=(0,o.useRef)(null),Ie=(0,m.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,ke=(0,m.useAppSelector)((function(e){return e.account})).dataAccount,Pe=(0,v.useTicketServices)(),_e=function(){return se(!ue)};(0,u.useFocusEffect)((0,o.useCallback)((function(){Re()}),[]));var Me,Fe,Oe,Ee,Ve,ze,Re=(Me=(0,a.default)((function*(){try{Se("loading");var e={userTaskId:"all",ticketId:Ie.id,sort:"lastModifiedDate,desc",page:0,size:1e5},t=yield Pe.getListComments(e);if(t&&t.content){I(t.content);var n=t.content.map((function(e){return e.createdBy})),i=ke.email||"",a=(0,r.default)(new Set([].concat((0,r.default)(n),[i]))).filter((function(e){return e.length>0})),l=yield Pe.getMultiLoginAccount(a);V(l||[]),yield Ye()}}catch(e){console.log("Error get list comments:",e),Se("error")}finally{Q(!1)}})),function(){return Me.apply(this,arguments)}),Ae=(0,o.useMemo)((function(){var e=new Map;return T.forEach((function(t){var n,i=null!=(n=t.commentId)?n:"root",a=e.get(i)||[];e.set(i,[].concat((0,r.default)(a),[t]))})),e}),[T]),Ne=function(e){var t=e.split(" "),n=t.filter((function(e){return!e.startsWith("@")})).join(" "),i=t.filter((function(e){return e.startsWith("@")})).map((function(e){var t,n,i;return`<span id="#${(new Date).getTime()}" class="user_tag" contenteditable="false" data-user-id="${null!=(t=ke.id)?t:5845}" data-email="${e.slice(1)}" data-org-in="${null!=(n=ke.orgIn)?n:"/1833/5390/5392"}" data-cust-id="${null!=(i=ke.custId)?i:1833}">${e}</span>`})).join(" ");return(0,h.encodeEmojiToUnicode)(`${i} ${n}`)},Le=(Fe=(0,a.default)((function*(e,t,n){try{var i={content:Ne(U),userTaskId:"all",ticketId:Ie.id,name:`${ke.firstName} ${ke.lastName}`,createdBy:ke.email,commentType:"comment",avatar:ke.imageUrl,commentId:e,userId:ke.id,orgIn:ke.orgIn,custId:ke.custId,contactDTO:De,isPrivate:n},a=new FormData;a.append("uploadFile",t?{uri:null==t?void 0:t.path,type:null==t?void 0:t.mime,name:null==t?void 0:t.path.split("/").pop()}:null),a.append("commentJson",JSON.stringify(i));var l=yield Pe.sendComment(a);l&&(Ce([]),I([l].concat((0,r.default)(T))),te(null),d.Keyboard.dismiss())}catch(e){}})),function(e,t,n){return Fe.apply(this,arguments)}),Be=(0,o.useCallback)((0,a.default)((function*(){if("reply"===fe||"new"===fe){if(U.trim()||ee){var e=re&&null!=re&&re.commentId?null==re?void 0:re.commentId:null==re?void 0:re.id;yield Le(e,ee,H)}}else"edit"===fe&&U.trim()&&re&&(yield $e(null==re?void 0:re.id,null==re?void 0:re.commentId,ee,H));W(""),pe("new"),ae(null)})),[U,fe,re,ee,H]),Ue=(Oe=(0,a.default)((function*(e){try{(yield Pe.deleteComment(e))&&We(e)}catch(e){}})),function(e){return Oe.apply(this,arguments)}),We=function(e){I((function(t){return null==t?void 0:t.filter((function(t){return t.id!==e}))}))},$e=(Ee=(0,a.default)((function*(e,t,n,i){try{var r=Object.assign({},re,{content:Ne(U),isPrivate:i,lastModifiedDate:(new Date).toISOString()}),a=new FormData;a.append("uploadFile",n?{uri:null==n?void 0:n.path,type:null==n?void 0:n.mime,name:null==n?void 0:n.path.split("/").pop()}:null),a.append("commentJson",JSON.stringify(r));var l=yield Pe.updateComment(a);l&&(I((function(t){return t.map((function(t){return t.id===e?l:t}))})),d.Keyboard.dismiss())}catch(e){}})),function(e,t,n,i){return Ee.apply(this,arguments)}),Ye=(Ve=(0,a.default)((function*(){try{var e=yield Pe.getListAclUser(Ie.id);if(e){var t=e.map((function(e){var t;return null==e||null==(t=e.personal)?void 0:t.email}))||[],n=yield Pe.getMultiLoginAccount((0,r.default)(new Set(t)));n&&M(n)}}catch(e){console.log("Error get list users:",e)}finally{Se("done")}})),function(){return Ve.apply(this,arguments)}),He=function(e){W(e);var t,n=e.split(" ").pop();if(null!=n&&n.startsWith("@")&&n.length>0)if((null==n||null==(t=n.slice(1))?void 0:t.length)<=0)N(_),ve(!0);else{var i,r=null==n||null==(i=n.slice(1))?void 0:i.toLowerCase();N(_.filter((function(e){var t;return null==e||null==(t=e.email)?void 0:t.toLowerCase().includes(r)}))),ve(!0)}else ve(!1)},Ke=(0,o.useCallback)((function(e,t){var n;if(pe(e),"reply"===e){var i=_.find((function(e){return e.email==t.createdBy})),a={id:null==i?void 0:i.resourceId,name:null==i?void 0:i.personalName,email:null==i?void 0:i.email,orgIn:null==i?void 0:i.orgIn,custId:null==i?void 0:i.custId,haveAvatar:!(null==i||!i.imageUrl),avatar:null==i?void 0:i.imageUrl,disabled:(null==i?void 0:i.resourceId)===ke.id||De.some((function(e){return(null==e?void 0:e.id)===(null==i?void 0:i.resourceId)}))};Ce((function(e){return[].concat((0,r.default)(e),[a])})),He(`@${t.createdBy} `)}else He(Ge((0,h.decodeUnicodeToEmoji)(t.content)));ae(t),null==(n=Te.current)||n.focus()}),[]),Ge=function(e){return(0,h.splitStringWithSpans)(e).map((function(e){var t,n;return e.includes('class="user_tag"')?`${null==(t=(0,h.extractSpanList)(e))||null==(n=t[0])?void 0:n.textContent}`:e})).join(" ")},Je=(ze=(0,a.default)((function*(){try{var e=yield y.default.ChoosePhoto({width:500,height:500});te(e)}catch(e){console.log(e)}})),function(){return ze.apply(this,arguments)});return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(d.KeyboardAvoidingView,{keyboardVerticalOffset:50,behavior:"ios"===d.Platform.OS?"padding":"height",style:{flex:1},children:(0,D.jsx)(d.TouchableWithoutFeedback,{children:(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(x.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",contentStyle:{backgroundColor:"#fff"},title:n("TK.comment"),onPressIconLeft:t}),(0,D.jsxs)(d.View,{style:{flex:1,padding:16},children:[(0,D.jsxs)(d.View,{style:{flex:1,position:"relative"},children:["done"===we&&(0,D.jsx)(d.FlatList,{style:{flex:1},refreshing:q,onRefresh:function(){Q(!0),Se("loading"),Re()},showsVerticalScrollIndicator:!1,contentContainerStyle:{rowGap:(0,s.SizeDP)(16)},data:(null==Ae?void 0:Ae.get("root"))||[],renderItem:function(e){var t=e.item;return(0,D.jsx)(p.default,{data:t,user:E.find((function(e){return e.email===t.createdBy})),listDataUser:E,setComment:W,deleteComment:Ue,allComments:Ae,onReplyClick:Ke,level:0})},ListEmptyComponent:function(){return(0,D.jsxs)(d.View,{style:f.default.emptyComment,children:[(0,D.jsx)(g.Icon,{name:"message-circle-outline",width:30,height:30}),(0,D.jsx)(S.default,{style:{textAlign:"center"},children:n("TK.commentDescription")})]})}}),"loading"===we&&(0,D.jsx)(g.Spinner,{size:"small"}),"error"===we&&(0,D.jsx)(d.View,{children:(0,D.jsx)(S.default,{children:n("CM.emptyData")})}),ye&&A.length>0&&(0,D.jsx)(d.View,{style:f.default.ctnModalListUser,children:(0,D.jsx)(d.View,{style:f.default.bodyModalListUser,children:(0,D.jsx)(g.List,{keyboardShouldPersistTaps:"handled",data:A,renderItem:function(e){var t=e.item;return(0,D.jsx)(g.ListItem,{onPress:function(){return function(e){var t,n={id:e.resourceId,name:e.personalName,email:e.email,orgIn:e.orgIn,custId:e.custId,haveAvatar:!!e.imageUrl,avatar:e.imageUrl,disabled:e.resourceId===ke.id||De.some((function(t){return t.id===e.resourceId}))};Ce((function(e){return[].concat((0,r.default)(e),[n])}));var i=U.split(" ");i[i.length-1]=`@${e.email} `,W(i.join(" ")),ve(!1),null==(t=Te.current)||t.focus()}(t)},children:(0,D.jsxs)(d.View,{style:f.default.ctnViewTag,children:[(0,D.jsx)(d.Image,{width:24,height:24,borderRadius:12,source:{uri:(null==t?void 0:t.imageUrl)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}),(0,D.jsxs)(d.View,{children:[(0,D.jsx)(S.default,{style:{fontSize:14,fontFamily:j.Font.InterSemiBold600},children:t.personalName}),(0,D.jsx)(S.default,{children:t.email})]})]})})}})})})]}),(0,D.jsxs)(d.View,{style:[f.default.ctnSend],children:[(0,D.jsxs)(d.View,{style:f.default.ctnImg,children:[ee&&(0,D.jsx)(D.Fragment,{children:ee.mime.includes("image")&&(0,D.jsxs)(d.View,{style:f.default.ctnImage,children:[(0,D.jsx)(d.Image,{style:f.default.image,source:{uri:ee.sourceURL}}),(0,D.jsx)(d.Pressable,{onPress:function(){return te(null)},style:f.default.closeImage,children:(0,D.jsx)(g.Icon,{width:12,height:12,name:"close-outline"})})]})}),(0,D.jsxs)(d.View,{style:f.default.ctnInput,children:[(0,D.jsx)(d.TextInput,{ref:Te,style:{padding:(0,s.SizeDP)(12),flex:1},allowFontScaling:!1,multiline:!0,placeholder:n("new"===fe?"TK.addComment":"reply"===fe?"TK.replyComment":"TK.editComment"),value:U,onChangeText:He,onFocus:function(e){return t=e.nativeEvent.text,void(null!=(n=null==t?void 0:t.split(" ").pop())&&n.startsWith("@")&&ve(!0));var t,n}}),(0,D.jsx)(d.TouchableOpacity,{onPress:Je,hitSlop:(0,s.SizeDP)(15),children:(0,D.jsx)(c.IconGetRelative,{width:(0,s.SizeDP)(20),height:(0,s.SizeDP)(20)})}),(0,D.jsx)(d.Pressable,{style:{marginHorizontal:12},onPress:function(){K(!H),_e()},children:(0,D.jsx)(g.Icon,{width:20,height:20,fill:"#39AC6D",name:H?"people-outline":"globe-outline"})}),(0,D.jsx)(b.Snackbar,{style:{marginBottom:20},onDismiss:_e,visible:ue,duration:1e3,children:n(H?"TK.commentPrivate":"TK.commentPublic")})]})]}),(0,D.jsx)(d.TouchableOpacity,{onPress:Be,hitSlop:(0,s.SizeDP)(15),children:(0,D.jsx)(c.IconSend,{width:(0,s.SizeDP)(24),height:(0,s.SizeDP)(24)})})]})]})]})})})})}},7259:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=n(41995);t.default=i.StyleSheet.create({ctnSend:{flexDirection:"row",alignItems:"center",columnGap:(0,r.SizeDP)(10),zIndex:1,backgroundColor:"#fff",paddingVertical:10},ctnImage:{marginLeft:4,marginTop:6,position:"relative",width:100,height:100},closeImage:{position:"absolute",top:-4,right:-4,padding:2,borderRadius:20,backgroundColor:"#fff",borderWidth:.5,borderColor:"#00358090"},image:{width:100,height:100,borderRadius:(0,r.SizeDP)(8)},ctnImg:{flex:1,borderWidth:(0,r.SizeDP)(.5),borderColor:"#00358026",borderRadius:(0,r.SizeDP)(8)},backdrop:{backgroundColor:"rgba(0, 0, 0, 0.5)"},menu:{width:250,maxHeight:300,position:"absolute",borderRadius:8,overflow:"hidden"},menuTitle:{padding:8,fontWeight:"bold"},ctnModalListUser:{alignItems:"center",justifyContent:"center",width:"100%",bottom:0,position:"absolute"},bodyModalListUser:{width:"90%",maxHeight:180,borderRadius:8,overflow:"hidden",borderWidth:.5,borderColor:"#a2b3cfe6"},ctnInput:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},ctnViewTag:{flexDirection:"row",alignItems:"center",columnGap:10,marginLeft:10},emptyComment:{margin:10,flex:1,alignItems:"center",rowGap:5}})},84478:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;i(n(21527));var r=n(87841),a=n(2543),l=n(32207),o=n(14740),u=i(n(24541)),s=n(47671);t.default=function(e){var t=e.style,n=e.onPressIconLeft,i=e.viewIconLeft,c=void 0===i?"arrow-back":i,d=e.title,f=void 0===d?"quangnh39":d,p=e.contentStyle,m=e.renderContentRight,h=e.appearance,y=void 0===h?"default":h,v=e.alignment,g=void 0===v?"start":v,x=e.subtitle,w=void 0===x?"":x,S=e.fillIconBackLeft,j=(0,o.useNavigation)(),b=function(){(0,a.isUndefined)(n)?j.goBack():n()};return(0,s.jsx)(r.View,{style:[t],children:(0,s.jsx)(l.TopNavigation,{title:function(e){return(0,s.jsx)(u.default,Object.assign({},e,{children:f}))},appearance:y,accessoryLeft:function(){return(0,s.jsx)(l.TopNavigationAction,{hitSlop:15,onPress:b,icon:(0,s.jsx)(l.Icon,{name:c,fill:S})})},accessoryRight:m,alignment:g,subtitle:w,style:[p]})})}},69107:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(41132)),a=i(n(85715)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=m(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),o=n(87841),u=n(32207),s=i(n(33489)),c=i(n(24541)),d=n(20880),f=n(35708),p=n(47671);function m(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(m=function(e){return e?n:t})(e)}t.default=function(e){var t=e.item,n=(0,l.useState)([t.id]),i=(0,a.default)(n,2),m=i[0],h=i[1],y=m.includes(t.id);return(0,p.jsxs)(o.View,{style:s.default.processContainer,children:[(0,p.jsxs)(o.TouchableOpacity,{onPress:function(){return e=t.id,void(m.includes(e)?h(m.filter((function(t){return t!==e}))):h([].concat((0,r.default)(m),[e])));var e},style:s.default.processHeader,children:[(0,p.jsx)(u.Icon,{name:y?"arrow-ios-downward-outline":"arrow-ios-forward-outline",fill:"#FC6B03",width:16,height:16}),(0,p.jsx)(c.default,{style:s.default.processTitle,children:t.notionName})]}),y&&(0,p.jsx)(p.Fragment,{children:t.reason&&(0,p.jsx)(o.View,{style:s.default.expandedContainer,children:(0,p.jsxs)(o.View,{style:s.default.userRow,children:[(0,p.jsx)(o.Image,{style:s.default.avatar,source:{uri:null!=t&&t.avatar?`${d.String.PREFIX_IMG_BASE64}${t.avatar}`:d.String.DEFAULT_IMAGE}}),(0,p.jsxs)(o.View,{style:s.default.userInfo,children:[t.userName&&t.email&&(0,p.jsxs)(o.View,{style:s.default.userDetails,children:[(0,p.jsx)(c.default,{style:s.default.commentUser,children:t.userName}),(0,p.jsx)(c.default,{style:s.default.commentEmail,children:t.email?`(${t.email.split("@")[0]})`:""}),(0,p.jsx)(c.default,{style:s.default.commentTime,children:t.signDate?` â€¢ ${f.DateUtils.convertDateToDDMMYYYY_H_M(t.signDate)}`:""})]}),(0,p.jsx)(c.default,{style:s.default.commentText,children:t.reason})]})]})})})]})}},24617:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(41132)),a=i(n(29293)),l=i(n(85715)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),u=n(87841),s=n(14740),c=n(2884),d=n(32207),f=i(n(33489)),p=i(n(69107)),m=i(n(43184)),h=i(n(24541)),y=n(11671),v=n(12638),g=n(40851),x=n(31004),w=n(47671);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}t.default=function(e){var t,n=e.onClose,i=(0,c.useTranslation)().t,S=(0,v.useAppSelector)((function(e){return e.common})).accessToken,j=(0,v.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,b=(0,y.useTicketServices)(),D=(0,g.useReviewServices)(),C=(0,x.useReviewEcontractServices)(),T=(0,o.useState)("loading"),I=(0,l.default)(T,2),k=I[0],P=I[1],_=(0,o.useState)([]),M=(0,l.default)(_,2),F=M[0],O=M[1],E=(0,o.useState)([]),V=(0,l.default)(E,2),z=V[0],R=V[1],A=(0,o.useState)([]),N=(0,l.default)(A,2),L=N[0],B=N[1],U=(t=(0,a.default)((function*(e){var t=yield b.getMultiLoginAccount((0,r.default)(new Set(e)),S);t&&R(t)})),function(e){return t.apply(this,arguments)});(0,s.useFocusEffect)((0,o.useCallback)((function(){$()}),[])),(0,o.useEffect)((function(){var e=(0,r.default)(F).map((function(e){e.implementerId;var t=L.find((function(t){return t.id==e.implementerId}));if(t){var n,i,r,a,l,o=null==t||null==(n=t.recipient)||null==(i=n.contact)?void 0:i.email,u="",s=z.find((function(e){return e.email==o}));return s&&(u=s.personalName||"---",l=s.avatar),Object.assign({},e,{email:null==t||null==(r=t.recipient)||null==(a=r.contact)?void 0:a.email,userName:u,avatar:l})}return e}));O(e)}),[z]);var W,$=(W=(0,a.default)((function*(){try{var e=yield D.getStatusParty(j.id,S);if(e){var t,n,i;O(null==e||null==(t=e.party)?void 0:t.recipients);var r=yield C.getRecipientDetail((null==e||null==(n=e.party)||null==(i=n.recipients[0])?void 0:i.id)||"",(null==e?void 0:e.ticketId)||"");if(r){B(r);var a=r.map((function(e){var t,n;return(null==e||null==(t=e.recipient)||null==(n=t.contact)?void 0:n.email)||""}));yield U(a)}}}catch(e){P("error")}finally{P("done")}})),function(){return W.apply(this,arguments)});return(0,w.jsx)(u.TouchableWithoutFeedback,{children:(0,w.jsxs)(u.View,{style:f.default.indexContainer,children:[(0,w.jsx)(m.default,{titleStyle:f.default.titleContainer,fillIconBackLeft:"#00204DB2",contentStyle:f.default.backgroundContainer,title:i("CM.note"),onPressIconLeft:n}),(0,w.jsx)(d.Divider,{}),(0,w.jsxs)(u.View,{style:{flex:1},children:["loading"===k&&(0,w.jsx)(u.View,{style:f.default.wrapSpin,children:(0,w.jsx)(d.Spinner,{size:"small"})}),"done"===k&&(0,w.jsx)(u.FlatList,{data:F,renderItem:function(e){var t=e.item;return t.id&&"accepted"==t.status?(0,w.jsx)(p.default,{item:t}):null},style:f.default.container,ListEmptyComponent:function(){return(0,w.jsx)(u.View,{children:(0,w.jsx)(h.default,{style:{textAlign:"center"},children:i("TK.noteEmptyDescription")})})}}),"error"===k&&(0,w.jsx)(u.View,{children:(0,w.jsx)(h.default,{children:i("CM.emptyData")})})]})]})})}},33489:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=n(20880);t.default=i.StyleSheet.create({indexContainer:{flex:1},titleContainer:{color:"#00204D"},backgroundContainer:{backgroundColor:"#fff"},container:{flex:1,backgroundColor:"#F8FAFE"},wrapSpin:{flex:1,justifyContent:"center",alignItems:"center"},processContainer:{backgroundColor:"#fff",marginVertical:15,marginHorizontal:10,borderRadius:10,overflow:"hidden",elevation:2,padding:12},processHeader:{flexDirection:"row",alignItems:"center",padding:10},processTitle:{fontSize:14,fontFamily:r.Font.InterMedium500,color:"#FC6B03",marginLeft:8},expandedContainer:{paddingVertical:10},userRow:{flexDirection:"row",alignItems:"flex-start",marginBottom:8},avatar:{width:24,height:24,borderRadius:12,marginRight:6},userInfo:{flex:1,marginTop:4,lineHeight:20},commentUser:{fontSize:13,fontFamily:r.Font.InterMedium500,color:"#333"},userDetails:{flexDirection:"row",alignItems:"center",flexWrap:"wrap",marginBottom:5},commentFullName:{fontSize:13,fontFamily:r.Font.InterMedium500,color:"#333"},commentShortlName:{fontSize:13,fontFamily:r.Font.InterMedium500,color:"#333"},commentEmail:{fontSize:13,color:"#666",marginLeft:5},commentTime:{fontSize:12,color:"#888",marginLeft:10},commentText:{fontSize:14,color:"#333",marginTop:5,lineHeight:20},notYetText:{textAlign:"center",paddingVertical:10}})},23813:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=n(87841),o=i(n(16861)),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),s=n(46317),c=n(2884),d=n(12638),f=i(n(27747)),p=i(n(45001)),m=n(20880),h=n(32207),y=n(11671),v=n(97427),g=i(n(77389)),x=n(47671);function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}t.default=function(e){var t,n=e.isVisible,i=e.toogleRateNow,w=(0,c.useTranslation)().t,S=(0,d.useAppDispatch)(),j=(0,u.useState)(""),b=(0,a.default)(j,2),D=b[0],C=b[1],T=(0,u.useState)(-1),I=(0,a.default)(T,2),k=I[0],P=I[1],_=(0,d.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,M=(0,u.useState)(!1),F=(0,a.default)(M,2),O=F[0],E=F[1],V=(0,y.useTicketServices)(),z=(t=(0,r.default)((function*(){var e={id:_.id,rate:k+1,rateNote:D,ticketStatus:"completed"};try{E(!0);var t=yield V.sendRateTicket(e);t?(S(v.ticketActions.setDataTicket(Object.assign({},_,{rate:null==t?void 0:t.rate}))),g.default.show({type:"success",text1:w("CM.noti"),text2:w("TK.rateSuccess")})):g.default.show({type:"error",text1:w("CM.noti"),text2:w("TK.rateFaile")}),i()}catch(e){}finally{E(!1)}})),function(){return t.apply(this,arguments)});return O?(0,x.jsx)(l.View,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,x.jsx)(h.Spinner,{size:"large"})}):(0,x.jsx)(p.default,{isVisible:n,onClose:i,title:`${w("TK.rate_now")}`,type:"rate",labelCancel:w("CM.labelCancel"),labelConfirm:w("TK.rate"),styleBtnRight:{backgroundColor:m.Color.completed},onConfirm:function(){return z()},renderContent:function(){return(0,x.jsxs)(l.View,{style:{marginVertical:6},children:[(0,x.jsx)(l.View,{style:o.default.starContainer,children:new Array(5).fill(1).map((function(e,t){return(0,x.jsx)(l.TouchableOpacity,{onPress:function(){return function(e){P(e)}(t)},children:t>k?(0,x.jsx)(s.IconStarOutline,{width:55,height:50,fill:m.Color.gray}):(0,x.jsx)(s.IconStar,{width:55,height:50,fill:m.Color.yellow})},t)}))}),(0,x.jsx)(f.default,{value:D,onChangeText:C,multiline:!0,isFloatingLabel:!0,label:w("TK.enter_comment"),maxLength:400})]})}})}},16861:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=n(41995),a=n(20880);t.default=i.StyleSheet.create({starContainer:{flexDirection:"row",alignItems:"center",justifyContent:"center"},btnRate:{color:a.Color.White,backgroundColor:a.Color.rate,padding:(0,r.SizeDP)(6),borderRadius:6}})},73639:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=T(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),o=n(87841),u=i(n(93238)),s=n(12638),c=n(14740),d=n(20880),f=n(19867),p=i(n(69290)),m=n(32207),h=i(n(24541)),y=n(2884),v=n(40851),g=n(97427),x=n(11671),w=n(88e3),S=n(35708),j=n(31004),b=i(n(77389)),D=n(2543),C=n(47671);function T(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(T=function(e){return e?n:t})(e)}t.default=function(e){var t=e.selectTabBottom,n=e.userTaskId,i=e.recipientDetailsId,T=e.isRealoadWebview,I=e.notifyActionType,k=e.typeView,P=(0,y.useTranslation)().t,_=(0,c.useNavigation)(),M=(0,s.useAppDispatch)(),F=(0,s.useAppSelector)((function(e){return e.ticket})),O=F.dataTicketRedux,E=F.statusPartyRaw,V=(0,s.useAppSelector)((function(e){return e.common})),z=V.accessToken,R=(V.language,(0,s.useAppSelector)((function(e){return e.account})).dataAccount),A=(0,l.useState)(!1),N=(0,a.default)(A,2),L=N[0],B=N[1],U=(0,l.useState)([]),W=(0,a.default)(U,2),$=W[0],Y=W[1],H=(0,l.useState)({width:o.Dimensions.get("screen").width,height:o.Dimensions.get("screen").height}),K=(0,a.default)(H,2),G=(K[0],K[1]),J=(0,l.useState)(0),q=(0,a.default)(J,2),Q=q[0],X=q[1],Z=(0,l.useState)(!0),ee=(0,a.default)(Z,2),te=ee[0],ne=ee[1],ie=(0,l.useState)(),re=(0,a.default)(ie,2),ae=re[0],le=re[1],oe=(0,v.useReviewServices)(),ue=(0,x.useTicketServices)(),se=(0,j.useReviewEcontractServices)();(0,c.useFocusEffect)((0,l.useCallback)((function(){return"email"===I&&S.CacheUtils.getReloadWebview().then((function(e){ne("first"===e)})),X((function(e){return e+1})),S.CacheUtils.clearReloadWebview()}),[T])),(0,l.useEffect)((function(){Promise.all([De(),Ce(),Te(),Ie()])}),[]),(0,l.useEffect)((function(){"quick"===k&&E&&be(JSON.parse((null==O?void 0:O.jsonXml)||"{}"))}),[E]),(0,l.useEffect)((function(){(0,D.isEmpty)(ae)||me(ae)}),[ae]);var ce,de,fe,pe,me=(ce=(0,r.default)((function*(e){var r,a,l=yield De(),o=null==l?void 0:l.some((function(e){return e.recipient.contact.email===(null==R?void 0:R.email)})),u=yield ue.getAuthorizationOfTaskSla({email:(null==R?void 0:R.email)||"binhntt6@fpt.com.vn",orgIn:(null==R?void 0:R.orgIn)||"/1978/5742",userTaskId:n,resourceId:null==O?void 0:O.id});if(null!=u&&u.length||o){var s=null==E||null==(r=E.party)||null==(a=r.recipients)?void 0:a.find((function(e){return e.id===n})),c="Disbursement"===(null==s?void 0:s.role);if(e){var f="";if("processing"===(null==s?void 0:s.status)?f="task-search":"accepted"===(null==s?void 0:s.status)?f="task-success":"rejected"===(null==s?void 0:s.status)&&(f="task-reject"),!f||"task-search"!==f)return;var p=1===t?"mine":"required";switch(null==s?void 0:s.role){case"Disbursement":default:_.navigate(d.NavigationName.ReviewFlow,{dataUserTask:{_status:f,_typeView:p,_userTaskId:n,checkDisbursement:c,modelerId:null==O?void 0:O.modelerId,reason:null==s?void 0:s.reason}});break;case"eID":var m={userTask:s,_recipientDetailsId:i,_userTaskId:n,_typeView:p,modelerId:null==O?void 0:O.modelerId,formData:O.formData?O.formData[0].formData:null,perms:"perms"};_.navigate(d.NavigationName.ReviewEIDScreen,{dataUserTask:m});break;case"eCollabo":var h={recipientDetailsId:i,_userTaskId:n,_status:f,_typeView:p,modelerId:null==O?void 0:O.modelerId,perms:"perms"};_.navigate(d.NavigationName.ReviewEcollaboFlow,{dataUserTask:h});break;case"eContract":he();case"eLMS":}}}else b.default.show({type:"error",text1:P("CM.noti"),text2:P("CM.noPermission")})})),function(e){return ce.apply(this,arguments)}),he=(de=(0,r.default)((function*(){try{var e,t="ewriter",i=yield se.getListAutomationEcontract(null==O?void 0:O.id,n),r=yield se.getEContractNotionDocResource(n);r&&null!=r&&r.data&&(t=(null==r||null==(e=r.data)?void 0:e.filter((function(e){return"ewriter"===e.resourceType||null===e.resourceType||"null"===e.resourceType}))).length>0?"ewriter":"ecollabo"),i&&(null==i?void 0:i.length)>0?ge(i[0].envelopeId):ye(n,t,!0)}catch(e){}})),function(){return de.apply(this,arguments)}),ye=(fe=(0,r.default)((function*(e,t,n){var r=yield ve(),a={userTaskId:e,recipientDetailsId:i,statusParty:null==E?void 0:E.party,isForm:n,documentResource:t,owner:r,perms:"perms"};_.navigate(d.NavigationName.ReviewEcontractFlow,{dataUserTask:a,isFinish:!1})})),function(e,t,n){return fe.apply(this,arguments)}),ve=(pe=(0,r.default)((function*(){var e=yield se.getTicketModelerFlowStatusRaw(O.id);return e?null==e?void 0:e.createdBy:""})),function(){return pe.apply(this,arguments)}),ge=function(e){_.navigate(d.NavigationName.ReviewEcontractFlow,{dataUserTask:{envelopeId:e,perms:"perms"},isFinish:!0})};(0,l.useEffect)((function(){var e=o.Dimensions.addEventListener("change",(function(e){var t=e.screen,n={width:t.width,height:t.height};G(n)}));return function(){return e.remove()}}),[]);var xe,we,Se,je,be=function e(t){t&&t.childShapes&&t.childShapes.length>0&&t.childShapes.forEach((function(t){if("callactivity"===t.stencil.id.toLowerCase()||"eid"===t.stencil.id.toLowerCase()||"elms"===t.stencil.id.toLowerCase()||"econtract"===t.stencil.id.toLowerCase()||"disbursement"===t.stencil.id.toLowerCase()||"payment"===t.stencil.id.toLowerCase()||"settlement"===t.stencil.id.toLowerCase()||"ecollabo"===t.stencil.id.toLowerCase()||"eapi"===t.stencil.id.toLowerCase()){if(t.resourceId===n)return void le(t)}else if(t.childShapes.length>0)return t.childShapes.forEach((function(e){return e.bounds.lowerRight.y=e.bounds.lowerRight.y+t.bounds.upperLeft.y,e.bounds.upperLeft.y=e.bounds.upperLeft.y+t.bounds.upperLeft.y,e.bounds.upperLeft.x=e.bounds.upperLeft.x+t.bounds.upperLeft.x,e.bounds.lowerRight.x=e.bounds.lowerRight.x+t.bounds.upperLeft.x,e})),e(t)}))},De=(xe=(0,r.default)((function*(){try{var e=yield oe.getRecipientDetaiImpl(O.id,z);return e?(M(g.ticketActions.setDataRecipientDetailImpl(e)),e):[]}catch(e){}})),function(){return xe.apply(this,arguments)}),Ce=(we=(0,r.default)((function*(){try{var e=yield oe.getListTaskSLA(O.id);e&&M(g.ticketActions.setDataListRecipientsSLA(e))}catch(e){}})),function(){return we.apply(this,arguments)}),Te=(Se=(0,r.default)((function*(){try{if(!O.modelerId)return;var e=null==O?void 0:O.formData.find((function(e){return!e.userTaskId})),t=yield oe.getFormDetailById(null==e?void 0:e.eformId,z);t&&M(g.ticketActions.setFormData(t))}catch(e){}})),function(){return Se.apply(this,arguments)}),Ie=(je=(0,r.default)((function*(){try{var e=yield ue.getModeler(O.modelerId,z);e&&M(g.ticketActions.setModeler(e))}catch(e){}})),function(){return je.apply(this,arguments)}),ke=function(e){var t=JSON.parse(e.nativeEvent.data);switch(null==t?void 0:t.action){case f.ACTION_TYPES.SHOW_USERTASK_INFO:return S.CacheUtils.saveReloadWebview(),void _.navigate(d.NavigationName.ReviewFlow,{dataUserTask:t.data});case f.ACTION_TYPES.SHOW_ECONTRACT_INFO:return void _.navigate(d.NavigationName.ReviewEcontractFlow,{dataUserTask:t.data,isFinish:!0});case f.ACTION_TYPES.SHOW_EXECUTOR_USER:return Y(t.data),void B(!0);case f.ACTION_TYPES.SHOW_EID_INFO:return void _.navigate(d.NavigationName.ReviewEIDScreen,{dataUserTask:t.data});case f.ACTION_TYPES.CREATE_ECONTRACT_ENV:return void _.navigate(d.NavigationName.ReviewEcontractFlow,{dataUserTask:t.data,isFinish:!1});case f.ACTION_TYPES.SHOW_COLLABO_INFO:return void _.navigate(d.NavigationName.ReviewEcollaboFlow,{dataUserTask:t.data});default:return}},Pe=function(){return 1===t?`${null==O?void 0:O.id}?_typeView=mine&access_token=${z}`:"email"===I&&te?`${null==O?void 0:O.id}?_recipientDetailsId=${i}&_userTaskId=${n}&_typeView=required&access_token=${z}&from=${I}`:`${null==O?void 0:O.id}?_recipientDetailsId=${i}&_userTaskId=${n}&_typeView=required&access_token=${z}`};return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(o.View,{style:{flex:1},children:1===t?(0,C.jsx)(u.default,{startInLoadingState:!0,source:{uri:(0,w.getConfig)().BASE_URL_TICKET+Pe()},onMessage:ke,webviewDebuggingEnabled:!0},Q):(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(u.default,{startInLoadingState:!0,source:{uri:(0,w.getConfig)().BASE_URL_TICKET+Pe()},onMessage:ke,webviewDebuggingEnabled:!0},Q)})}),(0,C.jsx)(p.default,{title:P("TK.listUser"),isVisible:L,onClose:function(){return B(!1)},renderContent:(0,C.jsx)(o.FlatList,{data:$,keyExtractor:function(e){return e.id},renderItem:function(e){var t,n,i=e.item;return(0,C.jsxs)(o.View,{style:{flexDirection:"row",columnGap:10,alignItems:"center",marginBottom:20},children:[(0,C.jsx)(m.Avatar,{source:{uri:i.avatar||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}),(0,C.jsxs)(o.View,{style:{flex:1},children:[(0,C.jsx)(h.default,{style:{flex:1},children:""+i.personalName}),(0,C.jsx)(h.default,{children:(null==i||null==(t=i.recipient)||null==(n=t.contact)?void 0:n.email)||"---"})]})]})}})})]})}},7006:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(7005),a=i(n(93238)),l=n(20880),o=i(n(43184)),u=n(47671);t.default=function(e){var t=e.url,n=e.onClose,i=e.name;return(0,u.jsxs)(r.SafeAreaView,{edges:["bottom","top"],style:{flex:1,backgroundColor:"#fff"},children:[(0,u.jsx)(o.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",contentStyle:{backgroundColor:"#fff"},title:i,onPressIconLeft:n}),(0,u.jsx)(a.default,{startInLoadingState:!0,injectedJavaScript:l.String.SCRIPT_SCALE_WEBVIEW,source:{uri:t}})]})}},89076:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=_(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),o=n(87841),u=i(n(76456)),s=n(7005),c=n(41995),d=n(46317),f=i(n(75672)),p=n(35708),m=i(n(24541)),h=i(n(81924)),y=n(14740),v=i(n(77389)),g=n(12638),x=n(60596),w=n(2884),S=n(40851),j=i(n(86933)),b=i(n(99746)),D=i(n(76644)),C=i(n(7006)),T=n(88e3),I=i(n(55529)),k=n(37106),P=n(47671);function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_=function(e){return e?n:t})(e)}t.default=function(){var e=(0,w.useTranslation)().t,t=((0,y.useNavigation)(),(0,l.useState)(1)),n=(0,a.default)(t,2),i=n[0],_=n[1],M=(0,l.useState)(0),F=(0,a.default)(M,2),O=F[0],E=F[1],V=(0,l.useState)([]),z=(0,a.default)(V,2),R=z[0],A=z[1],N=(0,l.useState)([]),L=(0,a.default)(N,2),B=L[0],U=L[1],W=(0,l.useState)([]),$=(0,a.default)(W,2),Y=$[0],H=$[1],K=(0,l.useState)(!1),G=(0,a.default)(K,2),J=G[0],q=G[1],Q=(0,l.useState)(""),X=(0,a.default)(Q,2),Z=X[0],ee=X[1],te=(0,l.useState)(!1),ne=(0,a.default)(te,2),ie=ne[0],re=ne[1],ae=(0,l.useState)(),le=(0,a.default)(ae,2),oe=le[0],ue=le[1],se=(0,l.useState)(""),ce=(0,a.default)(se,2),de=ce[0],fe=ce[1],pe=(0,g.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,me=(0,g.useAppSelector)((function(e){return e.common})).accessToken,he=(0,k.useZutandStore)((function(e){return e})).statusTicketSelect,ye=(0,S.useReviewServices)();(0,l.useEffect)((function(){ke(),Pe()}),[]),(0,l.useEffect)((function(){_e(i)}),[i]);var ve,ge,xe,we,Se,je,be,De,Ce,Te,Ie,ke=(ve=(0,r.default)((function*(){try{var e=yield ye.getListFileByTicketId(pe.id);Me(e)}catch(e){}})),function(){return ve.apply(this,arguments)}),Pe=(ge=(0,r.default)((function*(){try{var e=yield ye.getStatusParty(null==pe?void 0:pe.id,me);if(e){var t,n=null==(t=e.party)?void 0:t.recipients,i=yield ye.getListFormIdByTicketId(null==pe?void 0:pe.id);if(!i)return;i=function(e){var t=new Set,n=[];for(var i of e)null===i.userTaskId?n.push(i):t.has(i.userTaskId)||(t.add(i.userTaskId),n.push(i));return n}(i),Promise.all(i.map((function(e){return ye.getFormERequest({versionId:e.versionId},me)}))).then((function(e){Fe(null==e?void 0:e.map((function(e){var t,n,r,a;return Object.assign({},e,{userTaskId:null==(t=i)||null==(n=t.find((function(t){return t.formId===e.formId})))?void 0:n.userTaskId,versionId:null==(r=i)||null==(a=r.find((function(t){return t.formId===e.formId})))?void 0:a.versionId})})),n)}))}}catch(e){console.log("error",e)}})),function(){return ge.apply(this,arguments)}),_e=(xe=(0,r.default)((function*(e){try{var t={size:3,page:e-1,sort:"createdDate,desc",ticketId:null==pe?void 0:pe.id},n=yield ye.getListFileRelative(t,me);if(n){var i;if(0===(null==n||null==(i=n.data)?void 0:i.length))return void(e>1?_(e-1):(H([]),E(0)));E(null==n?void 0:n.totalRecords),Oe(null==n?void 0:n.data)}}catch(e){}})),function(e){return xe.apply(this,arguments)}),Me=function(e){var t=e.map((function(e,t){var n;return{STT:String(t+1),keyName:(0,P.jsx)(m.default,{style:u.default.txtText,numberOfLines:1,children:null==e?void 0:e.name}),notionName:(null==e?void 0:e.notionName)||"---",createdBy:e.createdBy,documentSize:p.CommonUtils.getSize(null==e?void 0:e.fileSize),type:null==e||null==(n=e.name)?void 0:n.split(".").slice(-1)[0],lastModifiedDate:p.DateUtils.convertDateToDDMMYYYY_H_M(e.lastModifiedDate),action:Ue(!0,e)}}));A(t)},Fe=function(e,t){var n=e.map((function(e,n){var i,r;return{STT:String(n+1),keyName:(0,P.jsx)(o.TouchableOpacity,{onPress:function(){re(!0),ue(e)},children:(0,P.jsx)(m.default,{style:u.default.txtText,numberOfLines:1,children:null==e?void 0:e.formName})}),createdBy:e.createdBy,notionName:null!=(i=null==t||null==(r=t.find((function(t){return e.userTaskId==t.id})))?void 0:r.notionName)?i:"Form quy trÃ¬nh"}}));U(n)},Oe=function(e){var t=e.map((function(e,t){var n,r;return{STT:String(3*(i-1)+1+t),keyName:(0,P.jsx)(m.default,{style:u.default.txtText,numberOfLines:1,children:null==e?void 0:e.fileName}),notionName:(null==e?void 0:e.notionName)||"---",createdBy:e.createdBy,documentSize:p.CommonUtils.getSize(e.size),type:null==e||null==(n=e.fileName)||null==(r=n.split("."))?void 0:r.pop(),lastModifiedDate:p.DateUtils.convertDateToDDMMYYYY_H_M(e.lastModifiedDate),action:Ue(!1,e)}}));H(t)},Ee=(we=(0,r.default)((function*(){var t,n,i=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],r=arguments.length>1?arguments[1]:void 0;fe(i?r.name:null==(t=r.fileName)||null==(n=t.split("."))?void 0:n[0]);try{v.default.show({type:"info",text1:e("CM.noti"),text2:e("TK.viewFile")});var a=new FormData;if(i&&"ewriter"===r.documentType){var l=yield Le(r.notionId,r.id,null==r?void 0:r.name);a.append("file",l);var o=yield ye.viewFile(a,me);return void(1==(null==o?void 0:o.code)?(q(!0),ee(o.message)):v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.error")}))}var u=r.name;u=i?r.keyName:r.name;var s=r.bucketName;if(!r.bucketName)if(r.name.includes("minio")){var c,d,f,p=null==r||null==(c=r.name)||null==(d=c.split("https://"))?void 0:d[1],m=null==p?void 0:p.split("/");u=`/${null==m||null==(f=m.slice(2))?void 0:f.join("/")}`,s=null==m?void 0:m[1]}else if(r.name.includes("s3-hfx03")){var h,y,g=null==r||null==(h=r.name)||null==(y=h.split("https://"))?void 0:y[1],x=null==g?void 0:g.split(".s3-hfx03.fptcloud.com:443");u=null==x?void 0:x[1],s=null==x?void 0:x[0]}a.append("keyName",u),a.append("bucketName",s),a.append("beanName",r.beanName);var w=yield ye.viewFile(a,me);1==(null==w?void 0:w.code)?(q(!0),ee(w.message)):v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.error")})}catch(t){v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.error")})}})),function(){return we.apply(this,arguments)}),Ve=(Se=(0,r.default)((function*(t){try{yield ye.deleteFileRelative(t,me),yield _e(i),v.default.show({type:"success",text1:e("CM.noti"),text2:e("TK.deleteFileSuccess")})}catch(t){console.log(t),v.default.show({type:"error",text1:e("CM.noti"),text2:e("TK.deleteFileErr")})}})),function(e){return Se.apply(this,arguments)}),ze=(je=(0,r.default)((function*(){try{var t=yield p.CommonUtils.handleGetFile();if(!t)return;var n=new FormData;n.append("uploadFile",t),n.append("attachmentJson",JSON.stringify({ticketId:null==pe?void 0:pe.id})),v.default.show({type:"info",text1:e("CM.noti"),text2:e("NT.notification.downloadingPleaseWait")}),(yield ye.uploadFileRelative(n,me))?(yield _e(i),v.default.show({type:"success",text1:e("CM.noti"),text2:e("TK.uploadFileSuccess")})):v.default.show({type:"error",text1:e("CM.noti"),text2:e("TK.uploadFileErr")})}catch(t){console.log(t),v.default.show({type:"error",text1:e("CM.noti"),text2:e("TK.uploadFileErr")})}})),function(){return je.apply(this,arguments)}),Re=(be=(0,r.default)((function*(e,t){var n=e.fileName;n=t?e.keyName.replace("/","_"):e.fileName;var i=`${"android"===o.Platform.OS?j.default.DownloadDirectoryPath:j.default.DocumentDirectoryPath}/${(new Date).getTime()}_${n}`;t?yield Be(i,e.id,null==e?void 0:e.notionId):e.bucketName?yield Ne(i,e.id):yield Ae(i,e.name)})),function(e,t){return be.apply(this,arguments)}),Ae=(De=(0,r.default)((function*(t,n){var i={fromUrl:n,toFile:t,background:!0,begin:function(e){},progress:function(e){e.bytesWritten,e.contentLength},connectionTimeout:5e3};try{200===(yield j.default.downloadFile(i).promise).statusCode?"ios"===o.Platform.OS&&(yield o.Share.share({url:t})).action==o.Share.dismissedAction?v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.downloadFail")}):v.default.show({type:"success",text1:e("CM.noti"),text2:e("CM.downloadSuccess")}):v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.downloadFail")})}catch(t){v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.downloadFail")})}})),function(e,t){return De.apply(this,arguments)}),Ne=(Ce=(0,r.default)((function*(t,n){try{v.default.show({type:"info",text1:e("CM.noti"),text2:e("CM.pleaseWait")});var i=yield b.default.fetch("GET",`${(0,T.getConfig)().BASE_URL}/services/erequest/api/attachments/download-file?attachmentId=${n}`).then((function(e){return 200==e.info().status?e.base64():null})).catch((function(){return null}));if(i){try{yield j.default.writeFile(t,i,"base64")}catch(e){console.log(e)}"ios"===o.Platform.OS&&(yield o.Share.share({url:t})).action==o.Share.dismissedAction?v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.downloadFail")}):v.default.show({type:"success",text1:e("CM.noti"),text2:e("CM.downloadSuccess")})}else v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.downloadFail")})}catch(t){v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.downloadFail")})}})),function(e,t){return Ce.apply(this,arguments)}),Le=(Te=(0,r.default)((function*(e,t,n){try{var i,r=null==n||null==(i=n.split("."))?void 0:i[1],a=`${b.default.fs.dirs.DocumentDir}/${(new Date).getTime().toString()}.${r}`,l=yield b.default.config({path:a}).fetch("GET",`${(0,T.getConfig)().BASE_URL}/services/erequest/api/tickets/${pe.id}/userTaskId/${e}/fileId/${t}`).then((function(e){return 200==e.info().status?e.path():null})).catch((function(){return null}));return{uri:"ios"===o.Platform.OS?l:"file://"+l,name:`${(new Date).getTime().toString()}.${r}`,type:p.CommonUtils.getMimeType(n)}}catch(e){console.log(e)}})),function(e,t,n){return Te.apply(this,arguments)}),Be=(Ie=(0,r.default)((function*(t,n,i){try{var r=yield b.default.fetch("GET",`${(0,T.getConfig)().BASE_URL}/services/erequest/api/tickets/${pe.id}/userTaskId/${i}/fileId/${n}/content`).then((function(e){return 200==e.info().status?e.base64():null})).catch((function(){return null}));r?(yield j.default.writeFile(t,r,"base64"),"ios"===o.Platform.OS&&(yield o.Share.share({url:t})).action==o.Share.dismissedAction?v.default.show({type:"error",text1:e("CM.noti"),text2:e("CM.downloadFail")}):v.default.show({type:"success",text1:e("CM.noti"),text2:e("CM.downloadSuccess")})):v.default.show({type:"error",text2:e("CM.downloadFail")})}catch(t){v.default.show({type:"error",text2:e("CM.downloadFail")})}})),function(e,t,n){return Ie.apply(this,arguments)}),Ue=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;return(0,P.jsxs)(o.View,{style:u.default.ctnAction,children:[(0,P.jsx)(o.TouchableOpacity,{onPress:function(){return Ee(e,t)},hitSlop:(0,c.SizeDP)(15),children:(0,P.jsx)(d.IconView,{width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16)})}),(0,P.jsx)(o.TouchableOpacity,{onPress:function(){return Re(t,e)},hitSlop:(0,c.SizeDP)(15),children:(0,P.jsx)(d.IconDownload,{width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16)})}),!e&&t.allowDeleted&&(null==pe?void 0:pe.ticketStatus)!==x.Status.voided&&(null==pe?void 0:pe.ticketStatus)!==x.Status.rejected&&(0,P.jsx)(o.TouchableOpacity,{onPress:function(){var e;return Ve(null==t||null==(e=t.id)?void 0:e.toString())},hitSlop:(0,c.SizeDP)(15),children:(0,P.jsx)(d.IconTrash,{width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16)})})]})};return(0,P.jsxs)(s.SafeAreaView,{style:{flex:1},edges:[],children:[(0,P.jsxs)(o.ScrollView,{showsVerticalScrollIndicator:!1,children:[(0,P.jsxs)(o.View,{style:u.default.ctnForm,children:[(0,P.jsxs)(o.View,{style:u.default.ctnView,children:[(0,P.jsx)(m.default,{style:u.default.txtTitle,children:e("TK.docRelative")}),he===x.Status.processing&&(0,P.jsx)(o.TouchableOpacity,{onPress:ze,hitSlop:(0,c.SizeDP)(15),children:(0,P.jsx)(d.IconUpload,{width:(0,c.SizeDP)(24),height:(0,c.SizeDP)(24)})})]}),(0,P.jsx)(f.default,{stickyLeft:!0,stickyColumnLeftIndex:1,tableHeaders:["STT","keyName","notionName","createdBy","documentSize","type","lastModifiedDate","action"],tableData:Y}),O>0&&(0,P.jsx)(h.default,{collectionSize:O,currentPage:i,pageSize:3,onPageChange:function(e){return _(e)}})]}),(0,P.jsxs)(o.View,{style:u.default.ctnForm,children:[(0,P.jsx)(m.default,{style:u.default.txtTitle,children:e("TK.templateInfo")}),(0,P.jsx)(f.default,{stickyLeft:!0,stickyColumnLeftIndex:1,tableHeaders:["STT","keyName","notionName","createdBy","documentSize","type","lastModifiedDate","action"],tableData:R})]}),(0,P.jsxs)(o.View,{style:u.default.ctnForm,children:[(0,P.jsx)(m.default,{style:u.default.txtTitle,children:e("TK.templateForm")}),(0,P.jsx)(f.default,{stickyLeft:!1,tableHeaders:["STT","keyName","createdBy","notionName"],tableData:B})]})]}),(0,P.jsx)(D.default,{isVisible:J,children:(0,P.jsx)(C.default,{url:Z,onClose:function(){return q(!1)},name:de})}),(0,P.jsx)(D.default,{isVisible:ie,children:(0,P.jsx)(I.default,{onClose:function(){return re(!1)},isOnlyView:!0,readOnly:!0,versionId:null==oe?void 0:oe.versionId,data:{_userTaskId:null==oe?void 0:oe.userTaskId,_ticketId:null==pe?void 0:pe.id,formId:null==oe?void 0:oe.formId},nameHeader:null==oe?void 0:oe.formName})})]})}},76456:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=n(20880),a=n(41995);t.default=i.StyleSheet.create({container:{justifyContent:"center",alignItems:"center"},txtTitle:{fontSize:r.FontSize.FontBase,fontFamily:r.Font.InterSemiBold600,color:r.Color.colorText},ctnForm:{marginLeft:(0,a.SizeDP)(8),marginTop:(0,a.SizeDP)(8),rowGap:(0,a.SizeDP)(15)},ctnAction:{flexDirection:"row",alignItems:"center",justifyContent:"center",columnGap:(0,a.SizeDP)(10)},txtText:{fontSize:r.FontSize.FontTiny,fontFamily:r.Font.InterRegular400,color:"#366ae2"},ctnView:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginRight:(0,a.SizeDP)(12)}})},27163:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),o=i(n(93238)),u=n(12638),s=n(7005),c=n(20880),d=n(88e3),f=n(40851),p=n(87841),m=i(n(24541)),h=n(32207),y=n(2884),v=n(75463),g=i(n(98327)),x=n(14740),w=n(47671);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}t.default=function(){var e,t=(0,y.useTranslation)().t,n=(0,x.useRoute)(),i=(null==n||null==(e=n.params)?void 0:e.ticketId)||"",S=(0,l.useRef)(null),j=(0,u.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,b=(0,u.useAppSelector)((function(e){return e.common})).accessToken,D=(0,l.useState)(),C=(0,a.default)(D,2),T=C[0],I=C[1],k=(0,l.useState)([]),P=(0,a.default)(k,2),_=P[0],M=P[1],F=(0,l.useState)(),O=(0,a.default)(F,2),E=O[0],V=O[1],z=(0,l.useState)(),R=(0,a.default)(z,2),A=R[0],N=R[1],L=(0,l.useState)(!1),B=(0,a.default)(L,2),U=B[0],W=B[1],$=(0,f.useReviewServices)();(0,l.useEffect)((function(){K(null)}),[]);var Y,H,K=(Y=(0,r.default)((function*(e){var n={ticketId:(null==j?void 0:j.id)||i,userTaskId:null,version:e};try{var r=yield $.getFormVersionByTicketAndUserTaskId(n,b);if(r&&null===e){var a=Array.from(Array(Math.ceil(r.versionUserTask))).map((function(e,t){return t+1})).map((function(e,n){return{id:e,key:`${t("CM.version")} `+e,value:`${t("CM.version")} `+e}}));M(a),N(a[a.length-1])}return I(r),r}catch(e){console.log("error getSubFromData",e)}})),function(e){return Y.apply(this,arguments)}),G=(H=(0,r.default)((function*(e){W(!0);var t=yield K(e);if(t){var n=null==t?void 0:t.formData,i=`window.postMessage('${JSON.stringify({type:"postFormEdit",isReadonly:!0,data:n}).replace(/\\/g,"\\\\").replace(/'/g,"\\'")}', '*');`;setTimeout((function(){var e;null==S||null==(e=S.current)||e.injectJavaScript(i),W(!1)}),800)}})),function(e){return H.apply(this,arguments)});return(0,w.jsxs)(s.SafeAreaView,{style:{flex:1},edges:[],children:[_.length>0&&(0,w.jsxs)(p.View,{style:g.default.selectForm,children:[(0,w.jsx)(m.default,{children:t("CM.selectVersion")}),(0,w.jsx)(v.OverflowMenuCM,{selectedIndex:E,listData:_,setSelectedIndex:function(e){var t;e&&(V(e),N(_[null==e?void 0:e.row]),G(null==(t=_[null==e?void 0:e.row])?void 0:t.id))},selectedTitle:(0,w.jsxs)(p.View,{style:g.default.version,children:[(0,w.jsx)(m.default,{children:null==A?void 0:A.value}),U&&(0,w.jsx)(h.Spinner,{size:"small"})]})})]}),(0,w.jsx)(o.default,{nestedScrollEnabled:!0,ref:S,startInLoadingState:!0,onMessage:function(e){var t=JSON.parse(e.nativeEvent.data);"e-from"===(null==t?void 0:t.result)&&G(null)},javaScriptEnabled:!0,injectedJavaScript:c.String.SCRIPT_SCALE_WEBVIEW,allowsInlineMediaPlayback:!0,mediaPlaybackRequiresUserAction:!1,webviewDebuggingEnabled:!0,source:{uri:(0,d.getConfig)().BASE_URL_FORM+(null==T?void 0:T.version)}})]})}},98327:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841);t.default=i.StyleSheet.create({version:{borderWidth:1,borderColor:"rgba(0, 53, 128, .35)",borderRadius:8,paddingHorizontal:8,paddingVertical:5,flexDirection:"row",alignItems:"center",justifyContent:"center",columnGap:4},selectForm:{padding:16,alignItems:"center",flexDirection:"row",justifyContent:"space-between",paddingHorizontal:16}})},96237:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.HISTORY_ACTION=void 0;var r=i(n(41132)),a=i(n(29293)),l=i(n(85715)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=w(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),u=n(87841),s=i(n(24997)),c=i(n(24541)),d=n(12638),f=n(35708),p=n(7005),m=n(41995),h=n(2884),y=n(2543),v=n(11671),g=n(32207),x=n(47671);function w(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(w=function(e){return e?n:t})(e)}var S=t.HISTORY_ACTION={CREATE:"add",PUBLIC:"public",UNPUBLIC:"unpublic",ACTIVE:"active",INACTIVE:"inactive",UPDATE:"edit",DELETE:"delete",ASSIGN:"assign",REQUEST_APP:"request_approve",COMMENT:"comment",REJECT:"reject_approve",REJECT_CONSIDER:"reject_consider",AUTHORITY:"authority",REQUEST_UPDATE:"request_update",SIGNING:"signing",UPLOAD:"upload",CANCEL:"cancel",EDIT_COMMENT:"edit_comment",REJECT_APPROVE:"reject_approve",REVIEW_CONDUCT:"review_conduct"};t.default=function(){var e=(0,h.useTranslation)().t,t=(0,d.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,n=(0,o.useState)(0),i=(0,l.default)(n,2),w=i[0],j=i[1],b=(0,o.useState)(0),D=(0,l.default)(b,2),C=D[0],T=D[1],I=(0,o.useState)(!1),k=(0,l.default)(I,2),P=k[0],_=k[1],M=(0,o.useState)([]),F=(0,l.default)(M,2),O=F[0],E=F[1],V=(0,d.useAppSelector)((function(e){return e.common})).accessToken,z=(0,v.useTicketServices)();(0,o.useEffect)((function(){(0,a.default)((function*(){yield A(w)}))()}),[w]);var R,A=(R=(0,a.default)((function*(e){try{var n=yield z.getTicketHistories(e,t.id,V);E(0===e?null==n?void 0:n.data:[].concat((0,r.default)(O),(0,r.default)(null==n?void 0:n.data))),T(n.totalRecords)}catch(e){console.error(e)}})),function(e){return R.apply(this,arguments)}),N=function(e,t,n){return(0,x.jsx)(u.View,{style:[{backgroundColor:e},s.default.ctnViewIcon],children:(0,x.jsx)(g.Icon,{fill:n,name:t,width:15,height:15})})},L=function(e){switch(e){case S.CREATE:return N("#F2ECFD","plus","#6F2CED");case S.REQUEST_APP:return N("#E8F7EF","file","#39AC6D");case S.COMMENT:return N("#f3f5f8","message-circle","");case S.REJECT:return N("#FCEEED","close","#E14337");case S.REJECT_CONSIDER:return N("#FCEEED","minus","#E14337");case S.AUTHORITY:return N("#F2ECFD","swap","#6F2CED");case S.REQUEST_UPDATE:return N("#FFF3EB","arrow-circle-left","#FC6B03");case S.SIGNING:return N("#E8F7EF","edit","#39AC6D");case S.UPLOAD:return N("#FFF3EB","cloud-upload-outline","#FC6B03");case S.CANCEL:return N("#FCEEED","minus","#E14337");case S.EDIT_COMMENT:return N("#f3f5f8","edit-2-outline","");case S.REJECT_APPROVE:return N("#FCEEED","close","#E14337");case S.REVIEW_CONDUCT:return N("#E8F7EF","checkmark","#39AC6D");default:return(0,x.jsx)(u.View,{style:s.default.ctnViewIcon})}};return(0,x.jsx)(p.SafeAreaView,{style:s.default.container,edges:["bottom"],children:O.length>0&&(0,x.jsx)(u.View,{children:(0,x.jsx)(u.FlatList,{keyExtractor:function(e){return e.id},refreshing:P,onRefresh:function(){0!==w&&_(!0),j(0)},data:O,onEndReached:function(){O.length<C&&j(w+1)},onEndReachedThreshold:.5,renderItem:function(t){var n=t.item,i=t.index;return(0,x.jsx)(x.Fragment,{children:!(0,y.isNull)(n.createdBy)&&(0,x.jsxs)(x.Fragment,{children:[(0,x.jsxs)(u.View,{style:s.default.ctnItem,children:[L(n.action),(0,x.jsxs)(u.View,{style:{rowGap:(0,m.SizeDP)(4)},children:[(0,x.jsx)(c.default,{style:s.default.title,children:e(`TK.transaction-history.action.${n.action}`)}),(0,x.jsx)(u.View,{style:s.default.ctnDes,children:(0,x.jsx)(c.default,{style:s.default.Des,children:`${f.DateUtils.convertDateToDDMMYYYY_H_M(n.createdDate)} ${e("TK.by")} ${n.createdBy}`})})]})]}),O.length-1!==i&&(0,x.jsx)(u.View,{style:s.default.tabHoz})]})})}})})})}},24997:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(41995)),a=n(20880);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}t.default=i.StyleSheet.create({container:{flex:1},ctnItem:{paddingHorizontal:(0,r.SizeDP)(16),paddingVertical:(0,r.SizeDP)(8),flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:(0,r.SizeDP)(16)},ctnDes:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:(0,r.SizeDP)(10)},ctnAction:{width:(0,r.SizeDP)(24),height:(0,r.SizeDP)(24),backgroundColor:"blue",borderRadius:(0,r.SizeDP)(12),justifyContent:"center",alignItems:"center"},tabHoz:{width:(0,r.SizeDP)(2),height:(0,r.SizeDP)(26),backgroundColor:"rgba(0, 53, 128, 0.15)",marginLeft:(0,r.SizeDP)(28)},title:{fontSize:r.default.FontSmall,fontFamily:a.Font.InterSemiBold600,color:a.Color.colorText},Des:{fontSize:r.default.FontTiny,fontFamily:a.Font.InterRegular400,color:a.Color.Text07},ctnViewIcon:{width:24,height:24,borderRadius:12,alignItems:"center",justifyContent:"center"}})},32251:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=g(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),o=n(87841),u=n(12638),s=i(n(75672)),c=n(35708),d=n(2884),f=n(32207),p=i(n(24541)),m=i(n(19767)),h=n(60596),y=n(11671),v=n(47671);function g(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(g=function(e){return e?n:t})(e)}t.default=function(){var e=(0,d.useTranslation)().t,t=(0,l.useState)(),n=(0,a.default)(t,2),i=n[0],g=n[1],x=(0,l.useState)(0),w=(0,a.default)(x,2),S=w[0],j=w[1],b=(0,u.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,D=(0,y.useTicketServices)(),C=(0,o.useWindowDimensions)(),T=C.width;C.height;(0,l.useEffect)((function(){k()}),[]);var I,k=(I=(0,r.default)((function*(){var e=yield D.getSla(b.id);e&&_(e)})),function(){return I.apply(this,arguments)}),P=function(e){switch(M(e)){case h.Status.processing:return{color:"#7F43EF",bgColor:"#F2ECFD"};case h.Status.accepted:case h.Status.completed:case"onTime":return{color:"#39AC6D",bgColor:"#E8F7EF"};case h.Status.voided:case h.Status.rejected:case"late":return{color:"#F05959",bgColor:"rgba(251, 213, 213, 1)"};default:return{}}},_=function(t){var n=t.map((function(t,n){var i,r,a;return{STT:String(n+1),notionName:t.notionName||"---",createdBy:t.owner,status:(0,v.jsx)(o.View,{style:{backgroundColor:null==(i=P(t))?void 0:i.bgColor,borderRadius:4,paddingHorizontal:4,paddingVertical:2},children:(0,v.jsx)(p.default,{style:{color:null==(r=P(t))?void 0:r.color,fontSize:12},children:e(`TK.${M(t)}`)})}),actualStartSate:t.estimateDate?c.DateUtils.convertDateToDDMMYYYY_H_M(t.estimateDate):"---",eventStartDate:t.startDate?c.DateUtils.convertDateToDDMMYYYY_H_M(t.startDate):"---",executionTime:t.totalTime?t.totalTime:"---",sla:(0,v.jsx)(p.default,{style:{color:null==(a=P(t))?void 0:a.color,fontSize:12},children:E(null==t?void 0:t.estimateDate,null==t?void 0:t.startDate,null==t?void 0:t.finishDate)})}}));g(n)},M=function(e){return b.ticketStatus===h.Status.voided&&e.status===h.Status.processing?h.Status.voided:"accepted"!=e.status&&"rejected"==b.status?"rejected":"accepted"==e.status&&e.delayTime?"late":"accepted"==e.status&&e.estimateDate?"onTime":e.status},F=function(){if(new Date(b.finishDate)<new Date(b.estimateDate)){var e=O(b.finishDate,b.createdDate)/O(b.estimateDate,b.createdDate);return{positionOfEstimateDate:{top:-20,right:.1*T/2-10},positionOfPopupEstimateDate:{top:-58,right:.1*T/2-10},positionOfFinishDate:{bottom:-20,right:.95*T-.1*T/2-e*T*.85-10},positionOfPopupFinishDate:{bottom:-58,right:e<.6?.95*T-.1*T/2-e*T*.85-10-S+30:.95*T-.1*T/2-e*T*.85-10},width:e*T*.85,bgColor:"completed"===b.ticketStatus?"#d9f2e4":"#40bf79",typeOfArrow:{estimateDate:"arrow-down",finishDate:"arrow-up"}}}var t=O(b.estimateDate,b.createdDate)/O(b.finishDate,b.createdDate);return{positionOfEstimateDate:{bottom:-20,right:(null==b?void 0:b.ticketStatus)!==h.Status.voided?.95*T-.1*T/2-t*T*.85-10:T-.95*T-10},positionOfPopupEstimateDate:{bottom:-58,right:(null==b?void 0:b.ticketStatus)!==h.Status.voided?t<.6?.95*T-.1*T/2-t*T*.85-10-S+30:.95*T-.1*T/2-t*T*.85-10:T-.95*T-10},positionOfFinishDate:{top:-20,right:.1*T/2-10},positionOfPopupFinishDate:{top:-58,right:.1*T/2-10},width:t*T*.85,bgColor:"completed"===b.ticketStatus?"#d9f2e4":"#40bf79",typeOfArrow:{estimateDate:"arrow-up",finishDate:"arrow-down"}}},O=function(e,t){var n=0;if(e&&t){var i=new Date(e);n=new Date(t).getTime()-i.getTime()}return n},E=function(e,t,n){var i,r=O(t,n),a=O(t,e);i=Math.abs(a-r);var l=Math.floor(i/864e5),o=Math.floor((i-24*l*60*60*1e3)/36e5),u=Math.floor((i-24*l*60*60*1e3-60*o*60*1e3)/6e4),s=Math.floor((i-24*l*60*60*1e3-60*o*60*1e3-60*u*1e3)/1e3);return i?l+"d"+o%60+"h"+u%60+"m"+s+"s":"---"};return(0,v.jsx)(o.View,{style:{flex:1},children:(0,v.jsx)(o.ScrollView,{children:(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(o.View,{style:m.default.ctnSLA,children:(0,v.jsxs)(o.View,{style:[{width:.95*T},m.default.ctnBody],children:[(0,v.jsx)(o.TouchableOpacity,{style:{position:"absolute",top:-20,left:.1*T/2-10,zIndex:1},children:(0,v.jsx)(f.Icon,{width:20,height:20,name:"arrow-down"})}),(0,v.jsxs)(o.View,{style:[{top:-58,left:.1*T/2-20},m.default.ctnDate],children:[(0,v.jsxs)(p.default,{style:m.default.size,children:[e("SR.created_at"),": "]}),(0,v.jsx)(p.default,{style:m.default.size,children:c.DateUtils.convertDateToDDMMYYYY_H_M(b.createdDate)})]}),(0,v.jsx)(o.TouchableOpacity,{style:[{position:"absolute",zIndex:1},F().positionOfEstimateDate],children:(0,v.jsx)(f.Icon,{width:20,height:20,name:F().typeOfArrow.estimateDate})}),(0,v.jsxs)(o.View,{style:[F().positionOfPopupEstimateDate,m.default.ctnDate],children:[(0,v.jsxs)(p.default,{style:m.default.size,children:[e("TK.estimateDate"),": "]}),(0,v.jsx)(p.default,{style:m.default.size,children:c.DateUtils.convertDateToDDMMYYYY_H_M(b.estimateDate)})]}),"completed"===b.ticketStatus&&(0,v.jsxs)(v.Fragment,{children:[(0,v.jsx)(o.TouchableOpacity,{style:[{position:"absolute",zIndex:1},F().positionOfFinishDate],children:(0,v.jsx)(f.Icon,{width:20,height:20,name:F().typeOfArrow.finishDate})}),(0,v.jsxs)(o.View,{onLayout:function(e){j(e.nativeEvent.layout.width)},style:[F().positionOfPopupFinishDate,m.default.ctnDate],children:[(0,v.jsxs)(p.default,{style:m.default.size,children:[e("TK.finishDate"),": "]}),(0,v.jsx)(p.default,{style:m.default.size,children:c.DateUtils.convertDateToDDMMYYYY_H_M(b.finishDate)})]})]}),(0,v.jsx)(o.View,{style:m.default.line}),(0,v.jsx)(o.View,{style:{height:30,backgroundColor:"#40bf79",width:.85*T},children:(0,v.jsx)(o.View,{style:{height:30,backgroundColor:F().bgColor,width:F().width}})}),(0,v.jsx)(o.View,{style:m.default.line})]})}),(0,v.jsx)(f.Divider,{style:{marginVertical:10}}),(0,v.jsx)(s.default,{tableHeaders:["STT","notionName","createdBy","status","actualStartSate","eventStartDate","executionTime","sla"],tableData:i||[],stickyLeft:!0,stickyColumnLeftIndex:1})]})})})}},19767:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841);t.default=i.StyleSheet.create({container:{justifyContent:"center",alignItems:"center",backgroundColor:"#2c3e50"},line:{height:30,backgroundColor:"#fff",width:3},ctnSLA:{alignItems:"center",justifyContent:"center",marginTop:80,marginBottom:80},ctnBody:{height:30,backgroundColor:"#d9d9d9",borderRadius:8,alignItems:"center",justifyContent:"center",flexDirection:"row",position:"relative"},ctnDate:{position:"absolute",zIndex:1,borderRadius:8,borderWidth:1,borderColor:"#cfb9f9",paddingHorizontal:6,paddingVertical:8,backgroundColor:"#f2ecfd"},size:{fontSize:11}})},90487:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=S(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),o=n(87841),u=n(35708),s=n(12638),c=n(46317),d=n(41995),f=i(n(75672)),p=i(n(81924)),m=n(2884),h=n(11671),y=i(n(24541)),v=i(n(37899)),g=n(60596),x=i(n(97667)),w=n(47671);function S(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(S=function(e){return e?n:t})(e)}t.default=function(){var e=(0,m.useTranslation)().t,t=(0,l.useState)([]),n=(0,a.default)(t,2),i=n[0],S=n[1],j=(0,l.useState)(1),b=(0,a.default)(j,2),D=b[0],C=b[1],T=(0,s.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,I=(0,h.useTicketServices)(),k=(0,l.useState)(1),P=(0,a.default)(k,2),_=P[0],M=P[1],F=(0,s.useAppSelector)((function(e){return e.common})).accessToken;(0,l.useEffect)((function(){E(_)}),[_]);var O,E=(O=(0,r.default)((function*(e){try{var t=yield I.getTicketRelatives(T.id,e-1,8,F);R(t.content),C(t.totalElements)}catch(e){}})),function(e){return O.apply(this,arguments)}),V=function(e){switch(e){case g.Status.completed:return z(v.default.completed,v.default.completed01,g.Status.completed);case g.Status.draft:return z(v.default.draft,v.default.draft01,g.Status.draft);case g.Status.voided:return z(v.default.voided,v.default.voided01,g.Status.voided);case g.Status.rejected:return z(v.default.rejected,v.default.rejected01,g.Status.rejected);case g.Status.processing:return z(v.default.processing,v.default.processing01,g.Status.processing)}},z=function(t,n,i){return(0,w.jsx)(o.View,{style:[{backgroundColor:n},x.default.ctnContent],children:(0,w.jsx)(y.default,{style:{color:t},children:e(`TK.${i}`)})})},R=function(e){var t=e.map((function(e,t){return{STT:String(8*(_-1)+1+t),title:null==e?void 0:e.title,serviceName:e.serviceName,ticketStatus:V(e.ticketStatus),createdBy:null==e?void 0:e.createdBy,createdDate:u.DateUtils.convertDateToDDMMYYYY_H_M(e.createdDate),lastModifiedDate:u.DateUtils.convertDateToDDMMYYYY_H_M(e.lastModifiedDate)}}));S(t)};return(0,w.jsx)(o.View,{style:{flex:1},children:i.length>0?(0,w.jsx)(o.ScrollView,{children:(0,w.jsxs)(o.View,{style:{flex:1},children:[(0,w.jsx)(o.View,{style:{flex:1,paddingVertical:(0,d.SizeDP)(10),marginLeft:(0,d.SizeDP)(10)},children:(0,w.jsx)(f.default,{tableData:i,tableHeaders:["STT","title","serviceName","ticketStatus","createdBy","createdDate","lastModifiedDate"]})}),D>0&&(0,w.jsx)(p.default,{collectionSize:D,currentPage:_,pageSize:8,onPageChange:function(e){return M(e)}})]})}):(0,w.jsxs)(o.View,{style:{alignItems:"center",justifyContent:"center",flex:1},children:[(0,w.jsx)(c.IconEmpty,{width:(0,d.SizeDP)(200),height:(0,d.SizeDP)(150)}),(0,w.jsx)(y.default,{children:e("CM.emptyData")})]})})}},97667:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841);t.default=i.StyleSheet.create({ctnContent:{paddingHorizontal:8,paddingVertical:4,borderRadius:4,alignItems:"center",justifyContent:"center"}})},36913:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(85715)),a=n(21527),l=i(n(73639)),o=i(n(27163)),u=i(n(96237)),s=i(n(90487)),c=i(n(97433)),d=i(n(89076)),f=i(n(32251)),p=i(n(24541)),m=n(87841),h=n(41995),y=n(2884),v=n(47671);t.default=function(e){var t=e.selectTabBottom,n=e.userTaskId,i=e.recipientDetailsId,g=e.isRealoadWebview,x=e.notifyActionType,w=e.typeView,S=(0,a.useState)({key:"background",title:"Tá»•ng quan"}),j=(0,r.default)(S,2),b=j[0],D=j[1],C=(0,a.useRef)(null),T=(0,a.useState)({width:m.Dimensions.get("screen").width,height:m.Dimensions.get("screen").height}),I=(0,r.default)(T,2),k=I[0],P=I[1];(0,a.useEffect)((function(){var e=m.Dimensions.addEventListener("change",(function(e){var t=e.screen;P({width:t.width,height:t.height})}));return function(){return e.remove()}}),[]);var _=(0,y.useTranslation)().t,M=(0,a.useState)([{key:"background",title:"Tá»•ng quan"},{key:"flow",title:"ThÃ´ng tin giao dá»‹ch"},{key:"hsitoryTicket",title:"Lá»‹ch sá»­ giao dá»‹ch"},{key:"ticketRelative",title:"Giao dá»‹ch liÃªn quan"},{key:"sla",title:"ThÃ´ng tin SLA"},{key:"document",title:"TÃ i liá»‡u Ä‘Ã­nh kÃ¨m"}]),F=(0,r.default)(M,1)[0],O=function(e){var t,n=Math.floor(e);null==C||null==(t=C.current)||t.scrollToIndex({animated:!0,index:""+n,viewOffset:k.width/3})};return(0,v.jsxs)(m.View,{style:{flex:1},children:[(0,v.jsx)(m.View,{children:(0,v.jsx)(m.FlatList,{ref:C,horizontal:!0,data:F,keyExtractor:function(e,t){return String(e.key)},showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1,initialScrollIndex:0,renderItem:function(e){var t=e.item,n=e.index;return(0,v.jsx)(m.TouchableOpacity,{style:[c.default.ctnMainTab,b.key===t.key&&c.default.activeTab],onPress:function(){D(t),O(n)},children:(0,v.jsx)(p.default,{style:[c.default.tabBar,b.key===t.key&&c.default.colorActive],children:_(`TK.${t.key}`)})})}})}),(0,v.jsx)(m.View,{style:{height:(0,h.SizeDP)(6),backgroundColor:"#F8FAFE"}}),(0,v.jsx)(m.View,{style:{flex:1},children:function(e){switch(e.key){case"background":return(0,v.jsx)(l.default,{userTaskId:n,recipientDetailsId:i,selectTabBottom:t,isRealoadWebview:g,notifyActionType:x,typeView:w});case"flow":return(0,v.jsx)(o.default,{});case"document":return(0,v.jsx)(d.default,{});case"hsitoryTicket":return(0,v.jsx)(u.default,{});case"ticketRelative":return(0,v.jsx)(s.default,{});case"sla":return(0,v.jsx)(f.default,{});default:return(0,v.jsx)(m.View,{})}}(b)})]})}},97433:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=n(20880),a=n(41995);t.default=i.StyleSheet.create({tabBar:{fontSize:r.FontSize.FontSmall,fontFamily:r.Font.InterRegular400,textAlign:"center",lineHeight:(0,a.SizeDP)(16)},ctnMainTab:{paddingHorizontal:(0,a.SizeDP)(16),paddingVertical:(0,a.SizeDP)(12)},activeTab:{borderBottomWidth:(0,a.SizeDP)(4),borderBottomColor:r.Color.BgPrimary},colorActive:{color:r.Color.BgPrimary}})},74821:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(7005),a=i(n(93238)),l=n(12638),o=n(20880),u=n(14740),s=n(88e3),c=n(47671);t.default=function(){var e,t,n,i,d,f,p=(0,u.useRoute)(),m=null!=(e=null==p||null==(t=p.params)?void 0:t.selectTabBottom)?e:1,h=null!=(n=null==p||null==(i=p.params)?void 0:i.dataTicket)?n:{},y=(0,l.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,v=(0,l.useAppSelector)((function(e){return e.common})).accessToken;return(0,c.jsx)(r.SafeAreaView,{edges:["bottom"],style:{flex:1,backgroundColor:"#fff"},children:(0,c.jsx)(a.default,{startInLoadingState:!0,injectedJavaScript:o.String.SCRIPT_SCALE_WEBVIEW,source:{uri:(0,s.getConfig)().BASE_URL_TICKET+(1===m?`${y.id}?_typeView=mine&access_token=${v}`:`${y.id}?_recipientDetailsId=${null==h?void 0:h.implementId}&_userTaskId=${null==h||null==(d=h.recipients)||null==(f=d[0])?void 0:f.id}&_typeView=required&access_token=${v}`)}})})}},35648:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(41132)),a=i(n(29293)),l=i(n(85715)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=v(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(21527)),u=n(87841),s=n(2884),c=n(40851),d=i(n(66771)),f=i(n(6663)),p=n(32207),m=i(n(24541)),h=n(12638),y=n(47671);function v(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(v=function(e){return e?n:t})(e)}t.default=function(e){var t=e.onSelect,n=e.placeholder,i=void 0===n?"TK.select":n,v=(0,s.useTranslation)().t,g=(0,o.useState)(!1),x=(0,l.default)(g,2),w=x[0],S=x[1],j=(0,o.useState)(null),b=(0,l.default)(j,2),D=b[0],C=b[1],T=(0,o.useState)(""),I=(0,l.default)(T,2),k=I[0],P=I[1],_=(0,o.useState)([]),M=(0,l.default)(_,2),F=M[0],O=M[1],E=(0,o.useState)(0),V=(0,l.default)(E,2),z=V[0],R=V[1],A=(0,o.useState)(0),N=(0,l.default)(A,2),L=N[0],B=N[1],U=(0,o.useState)(!1),W=(0,l.default)(U,2),$=W[0],Y=W[1],H=(0,h.useAppSelector)((function(e){return e.account})).dataAccount,K=(0,d.default)(k,500),G=(0,c.useReviewServices)();(0,o.useEffect)((function(){q(0,K)}),[K]);var J,q=(J=(0,a.default)((function*(e,t){try{var n={page:e,size:20},i={advanced:!0,orgIn:"/1833/5390/5392/5943",q:t.trim().toLowerCase(),resource:"table_user"},a=yield G.getUserInfoModel(n,i);a&&(O(0===e?a.data.filter((function(e){return e.email!==H.email})):[].concat((0,r.default)(F),(0,r.default)(a.data)).filter((function(e){return e.email!==H.email}))),B(a.totalRecords))}catch(e){}finally{Y(!1)}})),function(e,t){return J.apply(this,arguments)});return(0,y.jsxs)(u.View,{style:f.default.container,children:[(0,y.jsxs)(u.View,{style:f.default.selectContainer,children:[(0,y.jsx)(u.TouchableOpacity,{style:f.default.select,onPress:function(){S(!0),P("")},children:(0,y.jsx)(u.Text,{style:f.default.selectText,children:(null==D?void 0:D.email)||v(i)})}),D&&(0,y.jsx)(u.TouchableOpacity,{style:f.default.clearButton,onPress:function(){C(null),t(null)},children:(0,y.jsx)(p.Icon,{name:"close",width:20,height:20})})]}),(0,y.jsx)(u.Modal,{visible:w,animationType:"slide",transparent:!0,children:(0,y.jsx)(u.SafeAreaView,{style:f.default.modalContainer,children:(0,y.jsxs)(u.View,{style:f.default.modalContent,children:[(0,y.jsx)(u.TextInput,{style:f.default.searchInput,placeholder:v("CM.search"),value:k,onChangeText:P}),(0,y.jsx)(u.FlatList,{refreshing:$,onRefresh:function(){Y(!0),R(0),q(0,K)},data:F,renderItem:function(e){var n=e.item;return(0,y.jsxs)(u.TouchableOpacity,{style:f.default.item,onPress:function(){return function(e){C(e),t(e),S(!1)}(n)},children:[(0,y.jsx)(u.Image,{width:32,height:32,borderRadius:16,source:{uri:n.imageUrl||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}),(0,y.jsxs)(u.View,{children:[(0,y.jsx)(m.default,{style:f.default.textname,children:n.personalName}),(0,y.jsx)(m.default,{style:f.default.textEmail,children:n.email})]})]})},keyExtractor:function(e){return e.email},onEndReached:function(){F.length<L&&(q(z+1,K),R(z+1))},onEndReachedThreshold:.5,initialNumToRender:20}),(0,y.jsx)(u.TouchableOpacity,{style:f.default.closeButton,onPress:function(){return S(!1)},children:(0,y.jsx)(u.Text,{style:f.default.closeButtonText,children:v("CM.close")})})]})})})]})}},6859:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=n(87841),o=i(n(43184)),u=n(2884),s=i(n(54813)),c=i(n(24541)),d=n(12638),f=i(n(94516)),p=i(n(35648)),m=n(11671),h=n(21527),y=i(n(6663)),v=i(n(77389)),g=n(47671);t.default=function(e){var t=e.onClose,n=e.userTaskId,i=e.recipientDetailsId,x=(0,u.useTranslation)().t,w=(0,h.useState)(null),S=(0,a.default)(w,2),j=S[0],b=S[1],D=(0,d.useAppSelector)((function(e){return e.account})).dataAccount,C=(0,d.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,T=(0,m.useTicketServices)(),I=(0,h.useState)(),k=(0,a.default)(I,2),P=k[0],_=k[1];(0,h.useEffect)((function(){O()}),[]);var M,F,O=(M=(0,r.default)((function*(){var e=yield T.getSla(C.id);if(e){var t=e.find((function(e){return e.recipientId==n}));_(t)}})),function(){return M.apply(this,arguments)}),E=(F=(0,r.default)((function*(){var e={ticketId:C.id,recipientId:null,contactId:null,email:null==j?void 0:j.email,name:null==j?void 0:j.personalName,phone:null==j?void 0:j.phone,reason:"null"};(yield T.forwardActionUser(C.id,n,i,e))?(t(),v.default.show({type:"success",text1:x("CM.info"),text2:x("CM.forwardSuccessfully")})):v.default.show({type:"error",text1:x("CM.info"),text2:x("CM.forwardFail")})})),function(){return F.apply(this,arguments)});return(0,g.jsxs)(l.View,{style:{flex:1},children:[(0,g.jsx)(o.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",contentStyle:{backgroundColor:"#fff"},title:x("CM.authority"),onPressIconLeft:t}),(0,g.jsxs)(l.View,{style:y.default.ctnBody,children:[(0,g.jsx)(s.default,{label:x("TK.nameJob"),value:null==P?void 0:P.notionName,onChangeText:function(){},disabled:!0}),(0,g.jsxs)(l.View,{style:y.default.group,children:[(0,g.jsx)(c.default,{style:y.default.textTitle,children:x("TK.userAction")}),(0,g.jsxs)(l.View,{style:y.default.ctnImage,children:[(0,g.jsx)(l.Image,{width:32,height:32,borderRadius:16,source:{uri:(null==D?void 0:D.imageUrl)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}),(0,g.jsxs)(l.View,{style:{flex:1},children:[(0,g.jsx)(c.default,{style:y.default.textname,children:`${D.firstName} ${D.lastName}`}),(0,g.jsx)(c.default,{style:y.default.textEmail,children:D.email})]})]})]}),(0,g.jsxs)(l.View,{style:y.default.group,children:[(0,g.jsxs)(c.default,{style:y.default.textTitle,children:[x("TK.selectUserAuthor")," ",(0,g.jsx)(c.default,{style:{color:"#e14337"},children:"*"})]}),(0,g.jsx)(p.default,{onSelect:function(e){b(e)}})]})]}),(0,g.jsxs)(l.View,{style:y.default.ctnFooter,children:[(0,g.jsx)(f.default,{style:{flex:1,backgroundColor:"#F2F5F8"},label:x("CM.labelCancel"),styleLabel:{color:"#00204DB2"},onPress:t}),(0,g.jsx)(f.default,{style:{flex:1},label:x("CM.confirm"),onPress:E})]})]})}},6663:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=n(20880);t.default=i.StyleSheet.create({ctnBody:{padding:10,flex:1},ctnFooter:{flexDirection:"row",alignItems:"center",justifyContent:"center",columnGap:8,paddingHorizontal:10},group:{rowGap:8,paddingVertical:8},textTitle:{fontSize:12,fontFamily:r.Font.InterMedium500,color:"#00204DF2"},ctnImage:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:8,paddingHorizontal:16,paddingVertical:10,backgroundColor:"#e6eaf0",borderRadius:8},textname:{color:"#0b2b55",fontSize:14,fontFamily:r.Font.InterRegular400},textEmail:{color:"#465d7e",fontSize:12,fontFamily:r.Font.InterRegular400},container:{width:"100%"},selectContainer:{flexDirection:"row",alignItems:"center"},select:{flex:1,borderWidth:1,borderColor:"#ccc",borderRadius:8,padding:10,backgroundColor:"#fff"},selectText:{fontSize:14,fontFamily:r.Font.InterRegular400},clearButton:{marginLeft:10,padding:5,backgroundColor:"#f0f0f0",borderRadius:15,width:30,height:30,justifyContent:"center",alignItems:"center"},clearButtonText:{fontSize:16,color:"#333"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.5)"},modalContent:{backgroundColor:"#fff",borderRadius:10,padding:20,width:"90%",maxHeight:"80%"},searchInput:{borderWidth:1,borderColor:"#ccc",borderRadius:5,padding:10,marginBottom:10},item:{padding:10,borderBottomWidth:1,borderBottomColor:"#eee",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",columnGap:10},closeButton:{marginTop:10,padding:10,backgroundColor:"#f0f0f0",borderRadius:5,alignItems:"center"},closeButtonText:{fontSize:14,color:"#333",fontFamily:r.Font.InterSemiBold600}})},7037:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ListAction=void 0;t.ListAction=[{title:"comments",description:"Description for Item",iconName:"message-circle",navigationName:"comments"},{title:"note",description:"Description for Item",iconName:"edit-2-outline",navigationName:"note"},{title:"authority",description:"Description for Item",iconName:"swap",navigationName:"authority"}]},19691:function(e,t,n){var i=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=i(n(29293)),a=i(n(85715)),l=n(14740),o=n(87841),u=i(n(64455)),s=i(n(24541)),c=z(n(41995)),d=z(n(21527)),f=n(46317),p=i(n(84478)),m=i(n(36913)),h=n(20880),y=n(12638),v=n(97427),g=n(7005),x=(n(60596),n(2884)),w=n(32207),S=i(n(69290)),j=n(7037),b=n(72676),D=n(11595),C=n(45335),T=i(n(55087)),I=n(85653),k=n(11671),P=n(40851),_=i(n(76644)),M=i(n(6859)),F=i(n(23813)),O=i(n(24617)),E=n(47671);function V(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(V=function(e){return e?n:t})(e)}function z(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=V(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var l=r?Object.getOwnPropertyDescriptor(e,a):null;l&&(l.get||l.set)?Object.defineProperty(i,a,l):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}t.default=function(){var e,t,n,i,V,z,R,A,N=(0,l.useNavigation)(),L=(0,l.useRoute)(),B=(0,x.useTranslation)().t,U=(0,y.useAppDispatch)(),W=null==L?void 0:L.params,$=W.dataTicketId,Y=(W.email,W.status),H=W.selectTabBottom,K=null!=(e=null==L||null==(t=L.params)?void 0:t.recipientDetailsId)?e:"",G=null!=(n=null==L||null==(i=L.params)?void 0:i.userTaskId)?n:"",J=null!=(V=null==L||null==(z=L.params)?void 0:z.typeView)?V:"view",q=null!=(R=null==L||null==(A=L.params)?void 0:A.notifyActionType)?R:"",Q=(0,d.useState)(!1),X=(0,a.default)(Q,2),Z=X[0],ee=X[1],te=(0,d.useState)(1===H?b.dataListStatusTicket.find((function(e){return e.status===Y})):D.dataListStatusTicketFollowNoti.find((function(e){return e.status===Y}))),ne=(0,a.default)(te,2),ie=ne[0],re=ne[1],ae=(0,d.useState)(""),le=(0,a.default)(ae,2),oe=le[0],ue=le[1],se=(0,d.useState)(!1),ce=(0,a.default)(se,2),de=ce[0],fe=ce[1],pe=(0,d.useState)(!1),me=(0,a.default)(pe,2),he=me[0],ye=me[1],ve=(0,d.useState)(),ge=(0,a.default)(ve,2),xe=ge[0],we=ge[1],Se=(0,d.useState)(!1),je=(0,a.default)(Se,2),be=je[0],De=je[1],Ce=(0,l.useIsFocused)(),Te=(0,y.useAppSelector)((function(e){return e.ticket})),Ie=Te.dataTicketRedux,ke=Te.dataUserTicket,Pe=Te.dataOrgin,_e=(Te.statusPartyRaw,(0,y.useAppSelector)((function(e){return e.account})).dataAccount),Me=(0,y.useAppSelector)((function(e){return e.common})).accessToken,Fe=(0,I.useOriginServices)(),Oe=(0,k.useTicketServices)(),Ee=(0,P.useReviewServices)(),Ve=(0,o.useWindowDimensions)().width,ze=function(){De((function(e){return!e})),ee(!1)};(0,d.useEffect)((function(){(0,r.default)((function*(){yield Ne()}))()}),[H]);var Re,Ae,Ne=(Re=(0,r.default)((function*(){try{var e,t,n,i,r,a,l,o=yield Promise.all([Oe.getTicketById($,Me),Ee.getStatusParty($,Me)]);if(!ie){var u=1===H?b.dataListStatusTicket.find((function(e){var t;return e.status===(null==(t=o[0])?void 0:t.ticketStatus)})):D.dataListStatusTicketFollowNoti.find((function(e){var t;return e.status===(null==(t=o[0])?void 0:t.ticketStatus)}));re(u)}var s,c,d=null==(e=o[0])||null==(t=e.orgIn)?void 0:t.split("/")[(null==(n=o[0])||null==(i=n.orgIn)||null==(r=i.split("/"))?void 0:r.length)-1],f=yield Oe.getMultiLoginAccount([null==o||null==(a=o[0])?void 0:a.createdBy],Me);try{s=yield Fe.getOrigin(d,Me)}catch(e){}try{c=yield Oe.getImplementByModelerId(o[0].modelerId)}catch(e){}we(null==(l=c)?void 0:l.data.filter((function(e){return e.userTaskId==G})).find((function(e){return e.email==_e.email}))),U(v.ticketActions.setDataTicket(o[0])),U(v.ticketActions.setDataUserTicket(f[0])),U(v.ticketActions.setDataOrgin(s)),U(v.ticketActions.setStatusPartyRaw(o[1])),"ticket_tag_comment"===q&&ue("comments")}catch(e){console.log(e)}})),function(){return Re.apply(this,arguments)}),Le=function(){ee(!0)};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsxs)(g.SafeAreaView,{style:{backgroundColor:"#fff",flex:1},children:[(0,E.jsx)(o.StatusBar,{barStyle:"dark-content",backgroundColor:h.Color.Transparent}),(0,E.jsx)(p.default,{onPressIconLeft:function(){N.navigate(h.NavigationName.BottomTabs)},contentStyle:{backgroundColor:"#fff"},title:null!=Ie&&Ie.title?null==Ie?void 0:Ie.title:"---",renderContentRight:function(){return(0,E.jsx)(o.View,{style:{alignItems:"center",flexDirection:"row"},children:(0,E.jsx)(w.TopNavigationAction,{hitSlop:15,onPress:Le,icon:(0,E.jsx)(w.Icon,{fill:"#00204D",name:"more-vertical"})})})}}),(0,E.jsx)(w.Divider,{}),(0,E.jsx)(o.View,{style:{flex:1},children:(null==Ie?void 0:Ie.id)===$&&(0,E.jsx)(m.default,{userTaskId:G,recipientDetailsId:K,selectTabBottom:H,isRealoadWebview:he,notifyActionType:q,typeView:J})}),Ce&&(0,E.jsx)(o.View,{children:(0,E.jsx)(C.Portal,{children:(0,E.jsx)(C.FAB.Group,{open:de,visible:!0,variant:"primary",style:{paddingRight:Ve-100},fabStyle:u.default.fabStyle,icon:de?function(){return(0,E.jsx)(w.Icon,{fill:"#fff",name:"close-outline"})}:function(){return(0,E.jsx)(w.Icon,{fill:"#fff",name:"plus-outline"})},actions:function(e){if(1===H||!e)return j.ListAction.filter((function(e){return"authority"!==e.navigationName})).map((function(e){return{icon:function(){return(0,E.jsx)(w.Icon,{fill:"#985FF4",name:e.iconName})},label:B(`CM.${e.title}`),labelStyle:u.default.iconStyle,onPress:function(){return ue(e.navigationName)}}}));var t=JSON.parse(null==e?void 0:e.authorizationType),n=j.ListAction;return(null==t?void 0:t.length)>0||(n=j.ListAction.filter((function(e){return"authority"!==e.navigationName}))),n.map((function(e){return{icon:function(){return(0,E.jsx)(w.Icon,{fill:"#985FF4",name:e.iconName})},label:B(`CM.${e.title}`),labelStyle:u.default.iconStyle,onPress:function(){return ue(e.navigationName)}}}))}(xe),onStateChange:function(){return fe(!de)},onPress:function(){}})})})]}),(0,E.jsx)(S.default,{isVisible:Z,onClose:function(){return ee(!1)},title:B("CM.info"),renderContent:(Ae=null==Ie?void 0:Ie.rate,(0,E.jsxs)(o.View,{style:{rowGap:10},children:[(0,E.jsxs)(o.View,{style:[u.default.columnCenter],children:[(0,E.jsxs)(o.View,{style:[u.default.columnSubCenter],children:[(0,E.jsx)(w.Icon,{fill:"#00204D",width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16),name:"person"}),(0,E.jsx)(s.default,{style:u.default.textTit,children:B("TK.staff")})]}),(0,E.jsxs)(o.View,{style:[{columnGap:10,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",flex:1}],children:[(0,E.jsx)(o.Image,{width:(0,c.SizeDP)(24),height:(0,c.SizeDP)(24),borderRadius:(0,c.SizeDP)(12),source:{uri:null!=_e&&_e.imageUrl?null==_e?void 0:_e.imageUrl:"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}),(0,E.jsx)(s.default,{style:u.default.textDes,children:""+(null==ke?void 0:ke.personalName)})]})]}),(0,E.jsxs)(o.View,{style:[u.default.columnCenter],children:[(0,E.jsxs)(o.View,{style:[u.default.columnSubCenter],children:[(0,E.jsx)(f.IconMailFill,{width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16)}),(0,E.jsx)(s.default,{style:u.default.textTit,children:B("CM.email")})]}),(0,E.jsx)(s.default,{style:u.default.textDes,children:null==ke?void 0:ke.email})]}),(0,E.jsxs)(o.View,{style:[u.default.columnCenter],children:[(0,E.jsxs)(o.View,{style:[u.default.columnSubCenter],children:[(0,E.jsx)(f.IconPeople,{width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16)}),(0,E.jsx)(s.default,{style:u.default.textTit,children:B("CM.orgIn")})]}),(0,E.jsx)(s.default,{style:u.default.textDes,children:null==Pe?void 0:Pe.name})]}),(0,E.jsxs)(o.View,{style:[u.default.columnCenter],children:[(0,E.jsxs)(o.View,{style:[u.default.columnSubCenter],children:[(0,E.jsx)(w.Icon,{name:"bookmark",width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16)}),(0,E.jsx)(s.default,{style:u.default.textTit,children:B("CM.status")})]}),(0,E.jsxs)(o.View,{style:[{flex:1,flexDirection:"row"}],children:[(0,E.jsx)(o.View,{style:{backgroundColor:null==ie?void 0:ie.bgColor,paddingHorizontal:5,paddingVertical:3,borderRadius:4},children:(0,E.jsx)(s.default,{style:[{color:null==ie?void 0:ie.color,textAlign:"center",fontSize:c.default.FontTinier,fontFamily:h.Font.InterMedium500}],children:B(`TK.${null==Ie?void 0:Ie.ticketStatus}`)})}),(0,E.jsx)(o.View,{style:{flex:1}})]})]}),"completed"==(null==Ie?void 0:Ie.ticketStatus)&&(0,E.jsxs)(o.View,{style:[u.default.columnCenter],children:[(0,E.jsxs)(o.View,{style:[u.default.columnSubCenter],children:[(0,E.jsx)(f.IconCheckmarkCircle,{fill:h.Color.gray,width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16)}),(0,E.jsx)(s.default,{style:u.default.textTit,children:B("TK.rate")})]}),(0,E.jsxs)(o.View,{style:{flex:1,flexDirection:"row"},children:[null==Ae||null==Ae?(0,E.jsx)(o.TouchableOpacity,{style:u.default.btnRate,onPress:function(){return ze()},children:(0,E.jsx)(s.default,{style:u.default.btnRate,children:B("TK.rate_now")})}):(0,E.jsx)(E.Fragment,{children:new Array(5).fill(1).map((function(e,t){return t>=Ae?(0,E.jsx)(f.IconStarOutline,{width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16),fill:"#D3D3D3"},t):(0,E.jsx)(f.IconStar,{width:(0,c.SizeDP)(16),height:(0,c.SizeDP)(16),fill:h.Color.yellow},t)}))}),(0,E.jsx)(o.View,{style:{flex:1}})]})]})]}))}),be&&(0,E.jsx)(F.default,{isVisible:be,toogleRateNow:ze}),(0,E.jsx)(_.default,{isVisible:"comments"===oe,children:(0,E.jsx)(T.default,{onClose:function(){return ue("")}})}),(0,E.jsx)(_.default,{isVisible:"authority"===oe,children:(0,E.jsx)(M.default,{userTaskId:G,recipientDetailsId:K,onClose:function(){ue(""),ye(!he)}})}),(0,E.jsx)(_.default,{isVisible:"note"===oe,children:(0,E.jsx)(O.default,{onClose:function(){return ue("")}})})]})}},64455:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var i={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&{}.hasOwnProperty.call(e,a)){var o=r?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(i,a,o):i[a]=e[a]}return i.default=e,n&&n.set(e,i),i}(n(41995)),a=n(20880);function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}t.default=i.StyleSheet.create({ctnMain:{backgroundColor:a.Color.White},ctnBody:{backgroundColor:a.Color.White},ctnbodyDetail:{margin:(0,r.SizeDP)(16),position:"relative",backgroundColor:a.Color.White,borderRadius:(0,r.SizeDP)(16),padding:(0,r.SizeDP)(16),shadowColor:"#000",shadowOffset:{width:0,height:1},shadowOpacity:.2,shadowRadius:5,elevation:2},textTitle:{textAlign:"center",fontFamily:a.Font.InterSemiBold600,fontSize:r.default.FontBase,color:a.Color.Text},priority:{alignItems:"center",justifyContent:"center",paddingVertical:(0,r.SizeDP)(16)},priorityDetail:{borderRadius:(0,r.SizeDP)(16),paddingHorizontal:(0,r.SizeDP)(8),paddingVertical:(0,r.SizeDP)(4),backgroundColor:"#FCEEED"},priorityText:{fontFamily:a.Font.InterRegular400,fontSize:r.default.FontTiny},rowCenterStart:{flexDirection:"row",justifyContent:"center",alignItems:"flex-start",columnGap:(0,r.SizeDP)(10),marginTop:(0,r.SizeDP)(10),borderTopWidth:(0,r.SizeDP)(.5),borderTopColor:a.Color.borderColor,paddingTop:(0,r.SizeDP)(10)},columnCenter:{justifyContent:"space-around",alignItems:"center",gap:(0,r.SizeDP)(6),flexDirection:"row"},columnSubCenter:{justifyContent:"flex-start",alignItems:"center",gap:(0,r.SizeDP)(10),flexDirection:"row",flex:.5},textDes:{fontSize:r.default.FontTiny,fontFamily:a.Font.InterMedium500,color:a.Color.colorText,flex:1},ctnImage:{width:(0,r.SizeDP)(24),height:(0,r.SizeDP)(24),borderRadius:(0,r.SizeDP)(12),overflow:"hidden",backgroundColor:a.Color.BgPrimary},borderStyle:{height:"100%",width:(0,r.SizeDP)(1),backgroundColor:a.Color.borderColor},textTit:{fontFamily:a.Font.InterRegular400,fontSize:r.default.FontTinier,color:a.Color.Text07},ctnStatus:{borderRadius:(0,r.SizeDP)(4),paddingHorizontal:(0,r.SizeDP)(8),flex:1},fabStyle:{borderRadius:25,width:50,height:50,alignItems:"center",justifyContent:"center",backgroundColor:"#6F2CED"},iconStyle:{left:100,position:"absolute",top:-10,fontFamily:a.Font.InterMedium500},btnRate:{color:a.Color.White,backgroundColor:a.Color.rate,padding:(0,r.SizeDP)(6),borderRadius:6}})}}]);//# sourceMappingURL=src_app_screens_ticket-detail_components_ViewFlowDetail_index_tsx-src_app_screens_ticket-deta-0f0da5.bundle.map?platform=ios/* RCSSB */eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJoYXNoIjoiZDlkMTY5YzQ5Y2I1MDJjMzIwNGQzNjZlN2M5YmJhOTA4NDI3ZGI0MTNhYzJjMTllNzFmMzhiMTY2NTFkN2Y4YyIsImlhdCI6MTc0OTYzNTQ5MX0.C4uQtiCU36WB16uGrJVX7ae0UL8JaE6-Oxca8XmffZsUy0kJlxt0un4J4tvhoc0sS3wpG9HE4g0778LT9QfYo206CoutdPhUlq6OkABo7XgBXuh3BqmVjsdT_rCWteNR240tXr2lqc547svf5cBtzeOh1O2nhOCl2q-lijHJPiv1pz2l9DmoT8q7SWKp9JtVGuVLICVGeoJ_7Cvyu4d1hy9AY9mm9OObObjcFzGGFqA_ulRLRjR0MyOq2HJdOTcdqBcAvZL_zRwS_VLTmf08LoRYOzPmXqDpEiZnENRFtBLtH-p_JqEBWWE-n6dzDdmrVbPfQDP09MXthLLXDzUz4FpgvkWDqF73SkpTdEj2mltTIQwut1Bgvgap6m8340l58Vi3vwkxNHDS9DMeXuDJPavWOnnQ2zHfj4fn0G_Vm-pIeOT79wCiW5byThhaO3D7x7mfUzzPtx9dBq-c2j2tsp3hBSAI6QN99KoOO01Dl5cfurzNf68yPtQ1oSp7G3_5cS3XWsIJcj3u92HybtuT4VxrusndhbYAugdGBUnDZIPkI4lbocZexzDywcrnDrhERLdaeRR-xhYUB4I8e-J8BL1ut01oidJfP14UaKh1yOkGoy8xbeNDP1BmYgeVbn9RXEC0vmOv6IfEF2rY2fq8Px9MPVSZamrRFQUo-xDrlI4                                                                                                                                                                                                                                                                                                                                                                                                                                         