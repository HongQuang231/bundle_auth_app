var self=self||this||new Function("return this")()||{};(self.webpackChunkerequestApp=self.webpackChunkerequestApp||[]).push([["src_app_screens_review-ecollabo-flow_index_tsx-src_app_screens_review-econtract-flow_componen-89db8b"],{43952:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(41132)),l=r(n(29293)),a=r(n(85715)),o=n(87841),u=r(n(65963)),s=r(n(24541)),d=n(87071),c=n(91530),f=n(21527),p=n(32207),y=n(11671),m=r(n(76644)),h=r(n(43184)),v=n(26878),x=r(n(27747)),g=r(n(94516)),j=r(n(50852)),S=n(2884),I=n(46317),w=n(47671);t.default=function(e){var t,n,r,b=e.dataResource,T=e.dataUser,k=e.setListDataUpdate,D=e.toogleReload,C=(0,S.useTranslation)().t,F=(0,f.useState)(new p.IndexPath(d.optionPermisson.findIndex((function(e){return e.value===b.perm})))),R=(0,a.default)(F,2),_=R[0],V=R[1],E=(0,f.useState)(!1),P=(0,a.default)(E,2),M=P[0],O=P[1],B=(0,f.useState)(!1),A=(0,a.default)(B,2),N=A[0],L=A[1],z=(0,f.useState)(""),U=(0,a.default)(z,2),H=U[0],G=U[1],W=function(){return O(!M)},$=function(){return L(!N)},Y=(0,y.useTicketServices)(),q=(t=(0,l.default)((function*(){(yield Y.deleteAclsById(b.id))&&D(),$()})),function(){return t.apply(this,arguments)}),K=(n=(0,l.default)((function*(e){var t=(b.permType!==c.PermType.orgin?d.optionPermisson:d.optionPermisson.filter((function(e){return e.value!==c.OptionPermisson.permission})))[e.row];if(t.value!==c.OptionPermisson.delete){if(t.value===c.OptionPermisson.permission)return G(""),void W();V(e);var n={assignee:b.assignee,assigneeId:b.assigneeId,perm:t.value,permType:b.permType,name:b.name,avatar:b.avatar};k((function(e){var t=e.find((function(e){return e.assigneeId===b.assigneeId}));return t?e.map((function(e){return e.assigneeId===b.assigneeId?n:e})):[].concat((0,i.default)(e),[n])}))}else $()})),function(e){return n.apply(this,arguments)}),J=function(){var e,t;return null!=b&&null!=(e=b.name)&&e.trim()?null==b||null==(t=b.name)?void 0:t.trim():T?(null==T?void 0:T.firstName)+" "+(null==T?void 0:T.lastName):void 0},X=(r=(0,l.default)((function*(){var e=d.optionPermisson[_.row],t={resourceId:b.resourceId},n={aclForm:{assignee:b.assignee,assigneeId:b.assigneeId,perm:e.value,permType:b.permType,name:b.name},description:H};(yield Y.pushlishFile(t,n))&&(W(),V(new p.IndexPath(d.optionPermisson.findIndex((function(e){return e.value===b.perm})))))})),function(){return r.apply(this,arguments)});return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(o.View,{style:j.default.ctnMain,children:[(0,w.jsxs)(o.View,{style:j.default.ctnBody,children:[b.permType!==c.PermType.orgin?(0,w.jsx)(o.Image,{width:32,height:32,borderRadius:16,source:{uri:b.avatar||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}):(0,w.jsx)(o.View,{style:j.default.ctnIcon,children:(0,w.jsx)(p.Icon,{fill:"#fff",width:26,height:26,name:"people"})}),(0,w.jsxs)(o.View,{style:{flex:1},children:[b.permType!==c.PermType.orgin&&(0,w.jsx)(o.View,{children:(0,w.jsx)(s.default,{style:j.default.ctnName,children:J()})}),(0,w.jsx)(o.View,{children:(0,w.jsx)(s.default,{style:j.default.ctnAssignee,children:b.assignee})})]})]}),(0,w.jsx)(o.View,{style:{flex:.7},children:b.perm===c.OptionPermisson.owner?(0,w.jsx)(o.View,{style:j.default.ctnOwner,children:(0,w.jsx)(s.default,{style:j.default.textOwner,children:C("RV.owner")})}):(0,w.jsx)(u.default,{isi18n:!0,size:"medium",onSelect:K,valueSelect:_,listData:b.permType!==c.PermType.orgin?d.optionPermisson:d.optionPermisson.filter((function(e){return e.value!==c.OptionPermisson.permission}))})}),(0,w.jsx)(m.default,{isVisible:M,children:(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(h.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:C("CM.share"),contentStyle:{backgroundColor:"#fff"},onPressIconLeft:function(){V(new p.IndexPath(d.optionPermisson.findIndex((function(e){return e.value===b.perm})))),W()}}),(0,w.jsx)(p.Divider,{}),(0,w.jsxs)(v.KeyboardAwareScrollView,{style:{padding:16,rowGap:10},children:[(0,w.jsxs)(o.View,{style:[{marginBottom:16},j.default.ctnBody],children:[b.permType!==c.PermType.orgin?(0,w.jsx)(o.Image,{width:32,height:32,borderRadius:16,source:{uri:b.avatar||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}):(0,w.jsx)(o.View,{style:j.default.ctnIcon,children:(0,w.jsx)(p.Icon,{fill:"#fff",width:26,height:26,name:"people"})}),(0,w.jsxs)(o.View,{style:{flex:1},children:[b.permType!==c.PermType.orgin&&(0,w.jsx)(o.View,{children:(0,w.jsx)(s.default,{style:j.default.ctnName,children:J()})}),(0,w.jsx)(o.View,{children:(0,w.jsx)(s.default,{style:j.default.ctnAssignee,children:b.assignee})})]})]}),(0,w.jsx)(x.default,{value:H,onChangeText:G,label:C("RV.fillNote"),maxLength:100,multiline:!0})]}),(0,w.jsxs)(o.View,{style:j.default.ctnDes,children:[(0,w.jsx)(p.Icon,{fill:"#6F2CED",name:"alert-circle",width:16,height:16}),(0,w.jsx)(s.default,{style:j.default.textDes,children:C("RV.noteDes")})]}),(0,w.jsx)(o.View,{style:{paddingHorizontal:16},children:(0,w.jsx)(g.default,{label:C("RV.sendInvent"),onPress:X})})]})})]}),(0,w.jsx)(m.default,{isVisible:N,animationType:"fade",backdropStyle:{backgroundColor:"#000810B2"},children:(0,w.jsx)(o.View,{style:j.default.ctnModal,children:(0,w.jsxs)(o.View,{style:j.default.ctnBodyModal,children:[(0,w.jsx)(o.View,{style:{alignItems:"center",justifyContent:"center"},children:(0,w.jsx)(I.IconCancel,{width:56,height:56})}),(0,w.jsx)(s.default,{style:j.default.textTitle,children:C("RV.confirmDeletePer")}),(0,w.jsx)(s.default,{style:j.default.textDesModal,children:C("RV.comfirmDelPerDes")}),(0,w.jsxs)(o.View,{style:j.default.viewBtn,children:[(0,w.jsx)(g.default,{label:C("CM.labelCancel"),onPress:$,style:[j.default.btn,j.default.btnLeft],styleLabel:j.default.labelStyleLeft}),(0,w.jsx)(g.default,{label:C("CM.confirm"),onPress:q,style:[j.default.btn]})]})]})})})]})}},50852:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({ctnMain:{flex:1,flexDirection:"row",alignItems:"center",justifyContent:"space-between",marginVertical:10,backgroundColor:"#fff",columnGap:10},ctnBody:{flexDirection:"row",alignItems:"center",columnGap:8,flex:1},ctnIcon:{width:32,height:32,borderRadius:16,backgroundColor:"#08c",alignItems:"center",justifyContent:"center"},ctnName:{flex:1,fontSize:14,color:"#00204DF2",fontFamily:i.Font.InterRegular400,justifyContent:"center",alignItems:"center"},ctnAssignee:{flex:1,fontSize:12,justifyContent:"center",alignItems:"center",color:"#00204DB2",fontFamily:i.Font.InterRegular400},ctnOwner:{backgroundColor:"#EDF2FD",padding:8,borderRadius:4},textOwner:{color:"#366AE2",fontFamily:i.Font.InterRegular400,fontSize:12,textAlign:"center"},ctnDes:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:8,backgroundColor:"#F2ECFD",padding:4,borderRadius:8,marginHorizontal:16,marginBottom:16},textDes:{color:"#6F2CED",flex:1},btn:{flex:1},btnLeft:{backgroundColor:i.Color.BtnDisable},labelStyleLeft:{color:i.Color.Text},txtTitle:{fontSize:i.FontSize.FontBase,fontFamily:i.Font.InterSemiBold600,color:i.Color.Text,textAlign:"center"},txtContent:{textAlign:"center",fontFamily:i.Font.InterRegular400,color:i.Color.Text07},viewBtn:{marginTop:16,flexDirection:"row",gap:16,alignItems:"center",justifyContent:"center"},ctnModal:{alignItems:"center",justifyContent:"center",flex:1},ctnBodyModal:{backgroundColor:"#fff",width:"90%",borderRadius:8,padding:10},textTitle:{color:"#00204D",fontSize:18,fontFamily:i.Font.InterSemiBold600,paddingVertical:8,textAlign:"center"},textDesModal:{color:"#00204DE5",fontSize:12,fontFamily:i.Font.InterRegular400,textAlign:"center"}})},33904:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(41132)),l=r(n(29293)),a=r(n(85715)),o=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=I(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&{}.hasOwnProperty.call(e,l)){var a=i?Object.getOwnPropertyDescriptor(e,l):null;a&&(a.get||a.set)?Object.defineProperty(r,l,a):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}(n(21527)),u=n(87841),s=n(32207),d=n(45335),c=r(n(43184)),f=r(n(66771)),p=n(40851),y=r(n(47876)),m=n(35708),h=r(n(54813)),v=r(n(24541)),x=n(87071),g=n(91530),j=n(2884),S=n(47671);function I(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(I=function(e){return e?n:t})(e)}t.default=function(e){var t=e.toogleFunc,n=e.toogleReload,r=e.fileId,I=(0,j.useTranslation)().t,w=(0,o.useState)(""),b=(0,a.default)(w,2),T=b[0],k=b[1],D=(0,o.useState)(""),C=(0,a.default)(D,2),F=C[0],R=C[1],_=(0,o.useState)([]),V=(0,a.default)(_,2),E=V[0],P=V[1],M=(0,o.useState)(0),O=(0,a.default)(M,2),B=O[0],A=O[1],N=(0,o.useState)(0),L=(0,a.default)(N,2),z=L[0],U=L[1],H=(0,o.useState)(!1),G=(0,a.default)(H,2),W=G[0],$=G[1],Y=(0,o.useState)([]),q=(0,a.default)(Y,2),K=q[0],J=q[1],X=(0,f.default)(T,500),Q=(0,o.useState)(!1),Z=(0,a.default)(Q,2),ee=Z[0],te=Z[1],ne=(0,o.useState)(x.typeLimit[0]),re=(0,a.default)(ne,2),ie=re[0],le=re[1],ae=(0,p.useReviewServices)();(0,o.useEffect)((function(){X?de(0,X):J([])}),[X]);var oe,ue,se,de=(oe=(0,l.default)((function*(e,t){try{var n={page:e,size:10},r={q:t.trim().toLowerCase(),terms:{status:0}},l=yield ae.getUserInfoModel(n,r);l&&(J(0===e?l.data:[].concat((0,i.default)(K),(0,i.default)(l.data))),U(l.totalRecords))}catch(e){}finally{$(!1)}})),function(e,t){return oe.apply(this,arguments)}),ce=(ue=(0,l.default)((function*(){$(!0),A(0),de(0,X)})),function(){return ue.apply(this,arguments)}),fe=(0,o.useCallback)((function(e){P((function(t){return t.some((function(t){return t.id===e.id}))?t.filter((function(t){return t.id!==e.id})):[].concat((0,i.default)(t),[e])}))}),[]),pe=(0,o.useCallback)((function(e){P((function(t){return t.filter((function(t){return t.id!==e}))}))}),[]),ye=(0,o.useCallback)((function(e){if(m.RegexUtils.FORMAT_EMAIL.test(e)){R("");var t={id:`new-${Date.now()}`,email:e,isAdd:!0};P((function(e){return[].concat((0,i.default)(e),[t])})),k("")}else R("CM.validEmail")}),[]),me=(0,o.useCallback)((function(){T&&!K.some((function(e){return e.email===T}))&&ye(T)}),[T,ye]),he=(se=(0,l.default)((function*(){if(0!==E.length){var e=E.map((function(e){var t,n;return{assignee:e.email,assigneeId:null!=e&&null!=(t=e.id)&&t.includes("new")?null:e.resourceId,perm:ie.value,permType:null!=e&&null!=(n=e.id)&&n.includes("new")?3:2}})),i={resourceId:r};(yield ae.updatePermissionOrg(i,e))&&(n(),t())}else t()})),function(){return se.apply(this,arguments)}),ve=function(){te(!ee)},xe=function(){switch(ie.value){case g.OptionPermisson.editor:return{bg:"#ef5da81a",color:"#ef5da8"};case g.OptionPermisson.reviewer:return{bg:"#f7931e1a",color:"#f7931e"};case g.OptionPermisson.viewer:return{bg:"#1382fd1a",color:"#1382fd"}}};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:I("CM.share"),contentStyle:{backgroundColor:"#fff"},onPressIconLeft:t}),(0,S.jsx)(d.Divider,{}),(0,S.jsxs)(u.View,{style:y.default.container,children:[(0,S.jsxs)(u.View,{style:y.default.ctnListEmailSelect,children:[(0,S.jsx)(u.View,{style:{flex:1}}),(0,S.jsx)(s.OverflowMenu,{anchor:function(){var e,t,n;return(0,S.jsxs)(u.TouchableOpacity,{style:[{backgroundColor:null==(e=xe())?void 0:e.bg},y.default.ctnOverflow],onPress:ve,children:[(0,S.jsx)(v.default,{style:{color:null==(t=xe())?void 0:t.color},children:I(ie.label)}),(0,S.jsx)(s.Icon,{name:ee?"arrow-up":"arrow-down",width:16,height:16,fill:null==(n=xe())?void 0:n.color})]})},visible:ee,onBackdropPress:ve,children:x.typeLimit.map((function(e){return(0,S.jsx)(s.MenuItem,{title:function(t){return(0,S.jsx)(v.default,Object.assign({},t,{children:I(e.label)}))},onPress:function(){return le(e),void ve()}},e.value)}))})]}),(0,S.jsx)(h.default,{placeholder:I("RV.fillEmail"),value:T,onChangeText:k,onSubmitEditing:me,style:y.default.input,captionText:I(F),onBlur:function(e){return ye(T)}}),(0,S.jsx)(u.View,{style:y.default.chipContainer,children:(0,S.jsx)(u.FlatList,{horizontal:!0,data:E,renderItem:function(e){var t=e.item;return(0,S.jsx)(s.ListItem,{style:y.default.ctnItem,title:`${t.email}`,accessoryRight:function(){return(0,S.jsx)(u.Pressable,{onPress:function(){return pe(t.id)},children:(0,S.jsx)(s.Icon,{name:"close",width:16,height:16})})}},t.id)}})}),T.length>0&&(0,S.jsx)(S.Fragment,{children:(0,S.jsx)(u.FlatList,{style:{flex:1},onRefresh:ce,refreshing:W,onEndReached:function(){K.length<z&&(de(B+1,X),A(B+1))},onEndReachedThreshold:.5,data:K,renderItem:function(e){var t=e.item;return(0,S.jsx)(s.Card,{style:y.default.card,children:(0,S.jsxs)(u.View,{style:y.default.cardContent,children:[(0,S.jsx)(u.View,{children:(0,S.jsx)(s.Text,{category:"s1",children:t.email})}),(0,S.jsx)(s.CheckBox,{checked:E.some((function(e){return e.id===t.id})),onChange:function(){return fe(t)}})]})})},keyExtractor:function(e){return e.id},ListEmptyComponent:function(){return(0,S.jsx)(s.Text,{style:y.default.noResults,children:I("CM.emptyData")})}})})]}),(0,S.jsx)(u.View,{style:y.default.ctnFooter,children:(0,S.jsx)(s.Button,{onPress:he,style:y.default.addButton,children:I("CM.confirm")})})]})}},47876:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({container:{flex:1,padding:16},input:{marginBottom:16},card:{marginBottom:8},cardContent:{flexDirection:"row",justifyContent:"space-between",alignItems:"center"},noResults:{textAlign:"center",marginTop:16},chipContainer:{marginVertical:10},chip:{margin:4},addButton:{marginTop:16,flex:1,backgroundColor:i.Color.BgPrimary},ctnFooter:{flexDirection:"row",alignItems:"center",justifyContent:"center",columnGap:8,paddingHorizontal:16},ctnListEmailSelect:{alignItems:"center",justifyContent:"space-between",flexDirection:"row",marginBottom:8},ctnOverflow:{flexDirection:"row",alignItems:"center",justifyContent:"flex-end",paddingHorizontal:5,columnGap:3,paddingVertical:6,borderRadius:6},ctnItem:{borderWidth:1,borderColor:i.Color.borderColor,borderRadius:8,marginRight:8}})},6710:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(41132)),l=r(n(29293)),a=r(n(85715)),o=n(87841),u=r(n(43184)),s=n(40851),d=n(12638),c=n(21527),f=n(32207),p=r(n(81745)),y=r(n(24541)),m=n(87071),h=n(91530),v=r(n(94516)),x=r(n(77389)),g=n(2884),j=n(47671);t.default=function(e){var t=e.toogleFunc,n=e.toogleReload,r=e.fileId,S=(0,g.useTranslation)().t,I=(0,d.useAppSelector)((function(e){return e.account})).dataAccount,w=(0,c.useState)([]),b=(0,a.default)(w,2),T=b[0],k=b[1],D=(0,c.useState)([]),C=(0,a.default)(D,2),F=C[0],R=C[1],_=(0,s.useReviewServices)(),V=(0,c.useState)(!1),E=(0,a.default)(V,2),P=E[0],M=E[1],O=(0,c.useState)(m.typeLimit[0]),B=(0,a.default)(O,2),A=B[0],N=B[1],L=(0,c.useState)(new Set),z=(0,a.default)(L,2),U=z[0],H=z[1],G=(0,c.useState)(new Set),W=(0,a.default)(G,2),$=W[0],Y=W[1],q=function(){M(!P)};(0,c.useEffect)((function(){Q()}),[]);var K,J,X=function(){switch(A.value){case h.OptionPermisson.editor:return{bg:"#ef5da81a",color:"#ef5da8"};case h.OptionPermisson.reviewer:return{bg:"#f7931e1a",color:"#f7931e"};case h.OptionPermisson.viewer:return{bg:"#1382fd1a",color:"#1382fd"}}},Q=(K=(0,l.default)((function*(){var e,t=null==I||null==(e=I.orgIn)?void 0:e.split("/").slice(0,3).join("/"),n={orgIn:null!=t?t:"/1833/5390"},r=yield _.getDataOrgByOrgin(n);R(r);var i=Z(r,null);k(i)})),function(){return K.apply(this,arguments)}),Z=function e(t,n){var r=t.filter((function(e){return e.parentId===n&&!e.blocked})),l=[];return r&&r.length?(r.forEach((function(n){var r={item:n,children:[]};r.children=e(t,n.id),l=[].concat((0,i.default)(l),[r])})),l):[]},ee=function e(t,n,r){for(var i of t){if(i.children&&i.children.some((function(e){return e.item.id===n.item.id}))){i.children.every((function(e){return r.has(e.item.id)}))?r.add(i.item.id):r.delete(i.item.id),e(T,i,r);break}i.children&&e(i.children,n,r)}},te=function e(t){var n=[t.item.id];return t.children&&t.children.forEach((function(t){n=[].concat((0,i.default)(n),(0,i.default)(e(t)))})),n},ne=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=U.has(t.item.id),i=t.children&&t.children.length>0,l=$.has(t.item.id),a=function(e){if(!e.children)return!1;var t=te(e),n=t.filter((function(e){return U.has(e)}));return n.length>0&&n.length<t.length}(t);return(0,j.jsxs)(o.View,{style:{marginLeft:0===n?0:40,marginBottom:10},children:[(0,j.jsxs)(o.View,{style:p.default.nodeContainer,children:[i&&(0,j.jsx)(o.TouchableOpacity,{onPress:function(){return e=t.item.id,(n=new Set($)).has(e)?n.delete(e):n.add(e),void Y(n);var e,n},children:(0,j.jsx)(f.Icon,{name:l?"chevron-down-outline":"chevron-right-outline",fill:"#8F9BB3",style:p.default.icon})}),(0,j.jsx)(f.CheckBox,{checked:r,indeterminate:a,onChange:function(e){return function(e,t){var n=new Set(U),r=te(e);t?r.forEach((function(e){return n.add(e)})):r.forEach((function(e){return n.delete(e)})),ee(T,e,n),H(n)}(t,e)},style:p.default.checkbox,children:t.item.name})]}),i&&l&&(0,j.jsx)(o.View,{style:{marginTop:10},children:t.children.map((function(t){return e(t,n+1)}))})]},t.item.id)},re=T.flatMap((function(e){return te(e)})),ie=(J=(0,l.default)((function*(){var e=F.filter((function(e){return Array.from(U).includes(e.id)})).map((function(e){return{assignee:e.name,assigneeId:e.id,perm:A.value,permType:1}})),i={resourceId:r};(yield _.updatePermissionOrg(i,e))&&(x.default.show({type:"success",text1:S("CM.info"),text2:S("CM.permissionUpdatedSuccessfully")}),n(),null==t||t())})),function(){return J.apply(this,arguments)});return(0,j.jsxs)(f.Layout,{style:{flex:1},children:[(0,j.jsx)(u.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:S("CM.share"),contentStyle:{backgroundColor:"#fff"},onPressIconLeft:t}),(0,j.jsx)(f.Divider,{}),(0,j.jsxs)(o.View,{style:{padding:10,flex:1},children:[(0,j.jsxs)(o.View,{style:p.default.ctnCheckBox,children:[(0,j.jsx)(f.CheckBox,{checked:U.size===re.length,indeterminate:U.size>0&&U.size<re.length,onChange:function(e){var t=T.flatMap((function(e){return te(e)}));H(e?new Set(t):new Set)},children:S("CM.all")}),(0,j.jsx)(f.OverflowMenu,{anchor:function(){var e,t,n;return(0,j.jsxs)(o.TouchableOpacity,{style:[{backgroundColor:null==(e=X())?void 0:e.bg},p.default.ctnOverflow],onPress:q,children:[(0,j.jsx)(y.default,{style:{color:null==(t=X())?void 0:t.color},children:S(A.label)}),(0,j.jsx)(f.Icon,{name:P?"arrow-up":"arrow-down",width:16,height:16,fill:null==(n=X())?void 0:n.color})]})},visible:P,onBackdropPress:q,children:m.typeLimit.map((function(e){return(0,j.jsx)(f.MenuItem,{title:function(t){return(0,j.jsx)(y.default,Object.assign({},t,{children:S(e.label)}))},onPress:function(){return N(e),void q()}},e.value)}))})]}),(0,j.jsx)(o.ScrollView,{style:{},children:T.map((function(e){return ne(e)}))})]}),(0,j.jsx)(o.View,{style:{padding:16},children:(0,j.jsx)(v.default,{label:S("CM.confirm"),onPress:ie})})]})}},81745:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841);t.default=r.StyleSheet.create({container:{padding:16},nodeContainer:{flexDirection:"row",alignItems:"center"},icon:{width:24,height:24,marginRight:8},checkbox:{flex:1},ctnOverflow:{flexDirection:"row",alignItems:"center",justifyContent:"center",paddingHorizontal:5,columnGap:3,paddingVertical:6,borderRadius:6},ctnCheckBox:{alignItems:"center",justifyContent:"space-between",flexDirection:"row",marginBottom:16}})},91530:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PermType=t.PERMISSION=t.OptionPermisson=t.LimitPermission=void 0;t.PERMISSION=function(e){return e[e.everyone=1]="everyone",e[e.limit=2]="limit",e}({}),t.LimitPermission=function(e){return e.viewer="p_v",e.editor="p_e",e.reviewer="p_c",e}({}),t.OptionPermisson=function(e){return e.viewer="v",e.editor="e",e.reviewer="c",e.permission="r",e.delete="delete",e.owner="o",e}({}),t.PermType=function(e){return e[e.personOwner=0]="personOwner",e[e.orgin=1]="orgin",e[e.personInOrg=2]="personInOrg",e[e.personOutOrg=3]="personOutOrg",e}({})},87071:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.typeLimitPermisson=t.typeLimit=t.permissionArr=t.optionPermisson=void 0;var r=n(91530);t.permissionArr=[{label:r.PERMISSION.everyone,value:"RV.collaboration.everyone"},{label:r.PERMISSION.limit,value:"RV.collaboration.appointment"}],t.typeLimit=[{value:r.OptionPermisson.viewer,label:"RV.collaboration.viewer"},{value:r.OptionPermisson.editor,label:"RV.collaboration.editor"},{value:r.OptionPermisson.reviewer,label:"RV.collaboration.reviewer"}],t.typeLimitPermisson=[{value:r.LimitPermission.viewer,label:"RV.collaboration.viewer"},{value:r.LimitPermission.editor,label:"RV.collaboration.editor"},{value:r.LimitPermission.reviewer,label:"RV.collaboration.reviewer"}],t.optionPermisson=[{value:r.OptionPermisson.viewer,label:"RV.collaboration.viewer"},{value:r.OptionPermisson.editor,label:"RV.collaboration.editor"},{value:r.OptionPermisson.reviewer,label:"RV.collaboration.reviewer"},{value:r.OptionPermisson.permission,label:"RV.collaboration.permission"},{value:r.OptionPermisson.delete,label:"RV.collaboration.delete"}]},56677:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(43693)),l=r(n(29293)),a=r(n(85715)),o=n(87841),u=r(n(43184)),s=n(32207),d=r(n(65963)),c=r(n(24541)),f=n(46317),p=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=C(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&{}.hasOwnProperty.call(e,l)){var a=i?Object.getOwnPropertyDescriptor(e,l):null;a&&(a.get||a.set)?Object.defineProperty(r,l,a):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}(n(21527)),y=n(87071),m=n(91530),h=r(n(43952)),v=n(40851),x=n(11671),g=r(n(76644)),j=r(n(33904)),S=r(n(6710)),I=r(n(55773)),w=r(n(73732)),b=n(2884),T=n(88e3),k=n(45335),D=n(47671);function C(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(C=function(e){return e?n:t})(e)}t.default=function(e){var t,n=e.toogleFunc,r=e.dataDetailFile,C=(0,b.useTranslation)().t,F=(0,p.useState)(!1),R=(0,a.default)(F,2),_=R[0],V=R[1],E=(0,p.useState)(!1),P=(0,a.default)(E,2),M=P[0],O=P[1],B=(0,p.useState)(!1),A=(0,a.default)(B,2),N=A[0],L=A[1],z=(0,p.useState)(!1),U=(0,a.default)(z,2),H=U[0],G=U[1],W=(0,p.useState)(!1),$=(0,a.default)(W,2),Y=$[0],q=$[1],K=(0,p.useState)({permission:m.PERMISSION.limit,limit:"v",limitPermission:m.LimitPermission.viewer,selectOption:"v",selectOptionOrg:"v"}),J=(0,a.default)(K,2),X=J[0],Q=J[1],Z=(0,p.useState)([]),ee=(0,a.default)(Z,2),te=ee[0],ne=ee[1],re=(0,p.useState)(new s.IndexPath(y.typeLimitPermisson.findIndex((function(e){return e.value===X.limitPermission})))),ie=(0,a.default)(re,2),le=ie[0],ae=ie[1],oe=(0,p.useState)([]),ue=(0,a.default)(oe,2),se=ue[0],de=ue[1],ce=(0,p.useState)([]),fe=(0,a.default)(ce,2),pe=fe[0],ye=fe[1],me=(0,p.useState)(),he=(0,a.default)(me,2),ve=he[0],xe=he[1],ge=(0,v.useReviewServices)(),je=(0,x.useTicketServices)(),Se=function(){V(!_)},Ie=function(){G(!H)},we=function(){q(!Y)},be=function(){return L(!N)};(0,p.useEffect)((function(){_e()}),[M]),(0,p.useEffect)((function(){Re()}),[]);var Te,ke,De,Ce,Fe,Re=(Te=(0,l.default)((function*(){var e={resourceId:r.fileId},t=yield je.getDefaultPublic(e);xe(t),t&&(Q((function(e){return Object.assign({},e,{permission:m.PERMISSION.everyone,limitPermission:t.perm})})),ae(new s.IndexPath(y.typeLimitPermisson.findIndex((function(e){return e.value===t.perm})))))})),function(){return Te.apply(this,arguments)}),_e=(ke=(0,l.default)((function*(){var e={resourceId:r.fileId},t=yield ge.getResourceById(e);if(t){var n=t.filter((function(e){return e.permType!==m.PermType.orgin})).map((function(e){return e.assignee})),i=yield je.getMultiLoginAccount(n);ye(i),de(t)}})),function(){return ke.apply(this,arguments)}),Ve=(De=(0,l.default)((function*(){var e={resourceId:r.fileId};te.length>0&&(yield ge.updatePermissionOrg(e,te)),ve||X.permission!==m.PERMISSION.limit?(ve&&X.limitPermission===ve.perm||(X.permission===m.PERMISSION.limit?yield Ee():yield Pe()),n()):n()})),function(){return De.apply(this,arguments)}),Ee=(Ce=(0,l.default)((function*(){var e={resourceId:r.fileId};yield je.limitLink(e)})),function(){return Ce.apply(this,arguments)}),Pe=(Fe=(0,l.default)((function*(){var e={resourceId:r.fileId,perm:X.limitPermission};yield je.publicLink(e)})),function(){return Fe.apply(this,arguments)}),Me=(0,p.useCallback)((function(){if(X.permission===m.PERMISSION.limit)return C("RV.limit");if(X.permission===m.PERMISSION.everyone)switch(X.limitPermission){case m.LimitPermission.viewer:return C("RV.viewer");case m.LimitPermission.editor:return C("RV.editor");case m.LimitPermission.reviewer:return C("RV.reviewer");default:return""}}),[X]);return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(o.View,{style:I.default.ctnMain,children:[(0,D.jsx)(u.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:C("CM.share"),contentStyle:{backgroundColor:"#fff"},onPressIconLeft:n}),(0,D.jsx)(s.Divider,{}),(0,D.jsxs)(o.View,{style:I.default.ctnBody,children:[(0,D.jsxs)(o.View,{style:I.default.ctnGroup1,children:[(0,D.jsxs)(o.View,{style:I.default.container,children:[(0,D.jsx)(c.default,{style:I.default.title,children:C("CM.orgIn")}),(0,D.jsxs)(o.Pressable,{onPress:we,style:I.default.ctnSelect,children:[(0,D.jsx)(c.default,{children:C("CM.orgIn")}),(0,D.jsx)(s.Icon,{width:16,height:16,name:"arrow-right",fill:"#00358059"})]})]}),(0,D.jsxs)(o.View,{style:I.default.container,children:[(0,D.jsx)(c.default,{style:I.default.title,children:"Email"}),(0,D.jsxs)(o.Pressable,{onPress:Ie,style:I.default.ctnSelect,children:[(0,D.jsx)(c.default,{children:C("CM.emailShare")}),(0,D.jsx)(s.Icon,{width:16,height:16,name:"arrow-right",fill:"#00358059"})]})]})]}),(0,D.jsxs)(o.View,{style:I.default.ctnWrapper,children:[(0,D.jsx)(c.default,{style:I.default.title,children:C("RV.userAccess")}),(0,D.jsx)(o.View,{style:I.default.ctnGroup2,children:(0,D.jsx)(s.List,{style:{backgroundColor:"#fff"},data:se,renderItem:function(e){var t=e.item;return(0,D.jsx)(h.default,{toogleReload:function(){return O(!M)},setListDataUpdate:ne,dataUser:null==pe?void 0:pe.find((function(e){return e.email===t.assignee})),dataResource:t})}})})]}),(0,D.jsxs)(o.View,{style:I.default.ctnWrapper,children:[(0,D.jsx)(c.default,{style:I.default.title,children:C("RV.generalAccess")}),(0,D.jsxs)(o.View,{style:I.default.ctnImage,children:[X.permission===m.PERMISSION.limit?(0,D.jsx)(o.View,{style:I.default.ctnImagePer,children:(0,D.jsx)(f.Iconkey,{width:13,height:16})}):(0,D.jsx)(o.View,{style:I.default.ctnImagePer,children:(0,D.jsx)(s.Icon,{name:"globe",fill:"#39ac6c",width:20,height:20})}),(0,D.jsxs)(o.View,{style:I.default.ctnDes,children:[(0,D.jsxs)(o.View,{style:I.default.ctnDesPer,children:[(0,D.jsx)(c.default,{style:I.default.title,children:C(null==(t=y.permissionArr.find((function(e){return e.label===X.permission})))?void 0:t.value)}),(0,D.jsx)(s.OverflowMenu,{anchor:function(){return(0,D.jsx)(o.TouchableOpacity,{hitSlop:15,onPress:Se,children:(0,D.jsx)(s.Icon,{name:"arrow-down",width:16,height:16,fill:"#00204DB2"})})},visible:_,onBackdropPress:Se,children:y.permissionArr.map((function(e){return(0,D.jsx)(s.MenuItem,{title:C(e.value),onPress:function(){return t="permission",n=e.label,Q((function(e){return Object.assign({},e,(0,i.default)({},t,n))})),void Se();var t,n}},e.value)}))})]}),(0,D.jsx)(c.default,{style:I.default.textLabel,children:Me()}),X.permission===m.PERMISSION.everyone&&(0,D.jsx)(d.default,{isi18n:!0,size:"medium",onSelect:function(e){ae(e),Q((function(t){return Object.assign({},t,{limitPermission:y.typeLimitPermisson[e.row].value})}))},valueSelect:le,listData:y.typeLimitPermisson})]})]})]})]}),(0,D.jsxs)(o.View,{style:{},children:[(0,D.jsx)(s.Divider,{}),(0,D.jsxs)(o.View,{style:I.default.ctnCopy,children:[(0,D.jsxs)(o.Pressable,{onPress:function(){w.default.setString(`${(0,T.getConfig)().BASE_URL_ECOLLABO}/negoti-doc/${r.fileId}`),be()},style:I.default.ctnPress,children:[(0,D.jsx)(s.Icon,{fill:"#366AE2",width:16,height:16,name:"link"}),(0,D.jsx)(c.default,{style:I.default.textCopy,children:C("RV.shareCopy")})]}),(0,D.jsx)(s.Button,{onPress:Ve,size:"small",children:(0,D.jsx)(c.default,{children:C("CM.confirm")})})]})]})]}),(0,D.jsx)(g.default,{isVisible:H,children:(0,D.jsx)(j.default,{fileId:r.fileId,toogleReload:function(){return O(!M)},toogleFunc:Ie})}),(0,D.jsx)(g.default,{isVisible:Y,children:(0,D.jsx)(S.default,{toogleReload:function(){return O(!M)},fileId:r.fileId,toogleFunc:we})}),(0,D.jsx)(k.Snackbar,{visible:N,onDismiss:be,duration:1e3,children:C("RV.copyLink")})]})}},55773:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({ctnMain:{flex:1,backgroundColor:"#fff"},ctnBody:{flex:1},ctnGroup1:{padding:10,rowGap:8},container:{rowGap:10},title:{fontSize:14,color:"#00204DF2",fontFamily:i.Font.InterMedium500},ctnSelect:{borderWidth:.5,borderColor:"#00358059",borderRadius:8,paddingHorizontal:16,paddingVertical:10,flexDirection:"row",alignItems:"center",justifyContent:"space-between"},ctnGroup2:{borderWidth:1,borderColor:"#00358026",borderRadius:8,maxHeight:300,padding:10},ctnWrapper:{rowGap:10,padding:10},ctnImage:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:16},ctnDes:{flex:1,rowGap:10},ctnImagePer:{width:32,height:32,backgroundColor:"#F2F5F8",borderRadius:16,alignItems:"center",justifyContent:"center"},ctnDesPer:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:4},textLabel:{fontSize:12,color:"#00204DB2",fontFamily:i.Font.InterRegular400},ctnCopy:{flexDirection:"row",alignItems:"center",justifyContent:"space-between",paddingHorizontal:16,marginTop:10},ctnPress:{flexDirection:"row",alignItems:"center",justifyContent:"center",columnGap:4},textCopy:{fontSize:14,color:"#366AE2",fontFamily:i.Font.InterRegular400}})},21758:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(41132)),l=r(n(29293)),a=r(n(85715)),o=n(14740),u=n(32207),s=n(21527),d=n(2884),c=n(46317),f=n(12638),p=r(n(43184)),y=r(n(76644)),m=r(n(46542)),h=n(7005),v=n(26878),x=n(87841),g=r(n(24541)),j=r(n(94196)),S=n(35708),I=n(60596),w=r(n(94516)),b=n(40851),T=r(n(77389)),k=n(97427),D=n(31004),C=r(n(78662)),F=r(n(64898)),R=r(n(8491)),_=r(n(27163)),V=n(11671),E=n(47671);t.default=function(){var e,t=(0,d.useTranslation)().t,n=(0,f.useAppDispatch)(),r=(0,o.useRoute)(),P=(0,s.useRef)(null),M=null==r||null==(e=r.params)?void 0:e.dataUserTask,O=(0,o.useNavigation)(),B=(0,s.useState)(!1),A=(0,a.default)(B,2),N=A[0],L=A[1],z=(0,s.useState)(!1),U=(0,a.default)(z,2),H=U[0],G=U[1],W=(0,s.useState)(!0),$=(0,a.default)(W,2),Y=$[0],q=$[1],K=(0,s.useState)(""),J=(0,a.default)(K,2),X=J[0],Q=(J[1],(0,s.useState)("")),Z=(0,a.default)(Q,2),ee=(Z[0],Z[1]),te=(0,s.useState)(!0),ne=(0,a.default)(te,2),re=(ne[0],ne[1]),ie=(0,s.useState)(!1),le=(0,a.default)(ie,2),ae=le[0],oe=le[1],ue=(0,f.useAppSelector)((function(e){return e.ticket})),se=ue.dataTicketRedux,de=ue.recipientDetaiImpl,ce=ue.formData,fe=ue.modeler,pe=(0,s.useState)([]),ye=(0,a.default)(pe,2),me=ye[0],he=ye[1],ve=(0,s.useState)([]),xe=(0,a.default)(ve,2),ge=xe[0],je=xe[1],Se=(0,s.useState)(null==de?void 0:de.find((function(e){return e.userTaskId===(null==M?void 0:M._userTaskId)}))),Ie=(0,a.default)(Se,1)[0],we=(0,s.useState)(null),be=(0,a.default)(we,2),Te=be[0],ke=be[1],De=((0,f.useAppSelector)((function(e){return e.account})).dataAccount,(0,f.useAppSelector)((function(e){return e.common})).accessToken),Ce=(0,b.useReviewServices)(),Fe=(0,D.useReviewEcontractServices)(),Re=(0,V.useTicketServices)();(0,s.useEffect)((function(){Ne(),Ae()}),[]);var _e,Ve,Ee,Pe,Me,Oe,Be=(0,s.useMemo)((function(){return[{key:"RV.createBy",type:"avatar",value:{name:(null==Te?void 0:Te.personalName)||"---",email:se.createdBy||"---",avatarUrl:null==Te?void 0:Te.imageUrl}},{key:"RV.ticketName",type:"normal",value:{name:(null==se?void 0:se.title)||"---"}},{key:"RV.process",type:"normal",value:{name:(null==se?void 0:se.jsonXml)&&JSON.parse(null==se?void 0:se.jsonXml).properties.name||"---"}},{key:"RV.createDate",type:"normal",value:{name:S.DateUtils.convertDateToDDMMYYYY_H_M(null==se?void 0:se.createdDate)}},{key:"RV.infoForm",type:"form",value:{name:null==ce?void 0:ce.formName,funcViewFrom:function(){return oe(!0)}}},{key:"RV.status",type:"status",value:{status:se.ticketStatus===I.Status.voided?I.Status.voided:(null==Ie?void 0:Ie.recipientStatus)||I.Status.processing}}]}),[se,ce,fe]),Ae=(_e=(0,l.default)((function*(){try{var e=yield Re.getMultiLoginAccount([se.createdBy]);e&&e.length>0&&ke(e[0]),console.log("user",e)}catch(e){}})),function(){return _e.apply(this,arguments)}),Ne=(Ve=(0,l.default)((function*(){try{var e=yield Ce.getListFileReview(se.id,M._userTaskId,De);if(e){je(e);var t=yield Promise.all(e.map((function(e){return Fe.getDetailCollabora(e.eCollaboDocumentId||e.ecollaboDocumentId)})));he(t.map((function(t){var n;return Object.assign({},t,{sourceSystem:null!=(n=e.find((function(e){return e.eCollaboDocumentId===t.fileId||e.ecollaboDocumentId===t.fileId})))&&n.attrs?"Từ eRequest":t.sourceSystem})})))}}catch(e){}})),function(){return Ve.apply(this,arguments)}),Le=(Ee=(0,l.default)((function*(){var e;if(!X)return re(!0),ee(t("CM.empty")),void(null==P||null==(e=P.current)||e.focus());ee("");var r=Object.assign({},null==Ie?void 0:Ie.recipient,{reason:X});(yield Ce.actionTicket(null==Ie?void 0:Ie.id,null==Ie?void 0:Ie.ticketId,null==Ie?void 0:Ie.userTaskId,r,De,"reject"))?(T.default.show({type:"success",text1:t("CM.noti"),text2:t("CM.rejectSucesss")}),n(k.ticketActions.setDataTicket(Object.assign({},se,{ticketStatus:I.Status.rejected}))),O.goBack()):T.default.show({type:"error",text1:t("CM.noti"),text2:t("CM.rejectFailed")})})),Pe=(0,l.default)((function*(){})),Me=(0,l.default)((function*(){try{var e=yield R.default.pick({type:[R.default.types.doc,R.default.types.docx,R.default.types.xls,R.default.types.xlsx]});if(e){var t="ios"===x.Platform.OS?null==e?void 0:e[0].uri.replace("file://",""):null==e?void 0:e[0].uri,n={name:e[0].name,uri:t,type:e[0].type},r=new FormData;r.append("file",n);var l=yield Fe.uploadFiles(se.id,M._userTaskId,r);if(l){je((function(e){return[l].concat((0,i.default)(e))}));var a=yield Fe.getDetailCollabora(l.eCollaboDocumentId||l.ecollaboDocumentId),o=Object.assign({},a,{sourceSystem:null!=l&&l.attrs?"Từ eRequest":a.sourceSystem});he([o].concat((0,i.default)(me)))}}}catch(e){}})),function(){return Me.apply(this,arguments)}),ze=(Oe=(0,l.default)((function*(e){var n=ge.find((function(t){return t.eCollaboDocumentId===e||t.ecollaboDocumentId===e}));(yield Fe.deleteFile(n.id))?(T.default.show({type:"success",text1:t("CM.info"),text2:t("CM.fileDeletedSuccessfully")}),he(me.filter((function(t){return t.fileId!==e}))),je(ge.filter((function(t){return t.eCollaboDocumentId!==e||t.ecollaboDocumentId!==e})))):T.default.show({type:"error",text1:t("CM.info"),text2:t("CM.fileDeleteFailed")})})),function(e){return Oe.apply(this,arguments)});return(0,E.jsxs)(h.SafeAreaView,{edges:["bottom"],style:{flex:1,backgroundColor:"#fff"},children:[(0,E.jsx)(p.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:t("CL.titleHeader"),contentStyle:{backgroundColor:"#fff"},renderContentRight:function(){return(0,E.jsx)(u.TopNavigationAction,{onPress:function(){return L(!0)},icon:(0,E.jsx)(c.IconWorkflow,{width:20,height:20})})}}),(0,E.jsxs)(v.KeyboardAwareScrollView,{style:{flex:1},children:[(0,E.jsx)(x.View,{style:C.default.ctnBody,children:(0,E.jsxs)(x.View,{style:C.default.ctnSubBody,children:[(0,E.jsxs)(x.Pressable,{style:C.default.ctnHeader,onPress:function(){return G(!H)},children:[(0,E.jsx)(u.Icon,{fill:"#6F2CED",width:16,height:16,name:H?"arrow-circle-down":"arrow-circle-right"}),(0,E.jsx)(g.default,{style:C.default.textTitle,children:t("CM.infoCommon")})]}),H&&(0,E.jsx)(x.View,{style:{paddingHorizontal:10,paddingBottom:10},children:(0,E.jsx)(j.default,{dataInfo:Be})})]})}),(0,E.jsx)(x.View,{style:[C.default.ctnBody,{paddingBottom:16}],children:(0,E.jsxs)(x.View,{style:C.default.ctnSubBody,children:[(0,E.jsxs)(x.Pressable,{style:C.default.ctnHeader,onPress:function(){return q(!Y)},children:[(0,E.jsx)(u.Icon,{fill:"#6F2CED",width:16,height:16,name:Y?"arrow-circle-down":"arrow-circle-right"}),(0,E.jsx)(g.default,{style:C.default.textTitle,children:t("CL.listFile")})]}),Y&&"task-success"!==M._status&&!(se.ticketStatus===I.Status.voided||se.ticketStatus===I.Status.rejected)&&(0,E.jsxs)(x.View,{style:{flexDirection:"row",alignItems:"center",justifyContent:"flex-end",marginRight:10},children:[(0,E.jsx)(x.View,{style:{flex:1}}),(0,E.jsxs)(x.Pressable,{style:C.default.ctnUpload,onPress:Le,children:[(0,E.jsx)(u.Icon,{fill:"#6F2CED",width:16,height:16,name:"cloud-upload"}),(0,E.jsx)(g.default,{style:C.default.textUpload,children:t("CL.addFile")})]})]}),Y&&(0,E.jsx)(x.View,{style:{paddingRight:10,paddingBottom:10},children:me&&(0,E.jsx)(u.List,{scrollEnabled:!1,data:me,keyExtractor:function(e){return e.fileId},renderItem:function(e){var t=e.item;return(0,E.jsx)(F.default,{typeReview:"eCollabo",deleteFile:ze,dataFlow:M,data:t})}})})]})})]}),(0,E.jsxs)(x.View,{style:C.default.ctnDes,children:[(0,E.jsx)(u.Icon,{fill:"#6F2CED",name:"alert-circle",width:16,height:16}),(0,E.jsx)(g.default,{style:C.default.styleTextDes,children:t("CL.des")})]}),(0,E.jsx)(y.default,{isVisible:N,children:(0,E.jsx)(m.default,{onClose:function(){return L(!1)}})}),(0,E.jsx)(y.default,{isVisible:ae,children:(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(x.View,{style:{flex:1},children:(0,E.jsx)(_.default,{})}),(0,E.jsx)(w.default,{style:{backgroundColor:"#f2ecfd",marginHorizontal:16},styleLabel:{color:"#6d1fad"},label:t("CM.back"),onPress:function(){return oe(!1)}})]})})]})}},78662:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880),l=n(41995);t.default=r.StyleSheet.create({ctnMain:{padding:(0,l.SizeDP)(16),backgroundColor:"#F8FAFE",flex:1},ctnWrapperItem:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",columnGap:(0,l.SizeDP)(16),marginBottom:(0,l.SizeDP)(24)},txtTitle:{fontFamily:i.Font.InterSemiBold600,fontSize:i.FontSize.FontTiny,color:i.Color.colorText,flex:.5},txtValue:{fontFamily:i.Font.InterRegular400,fontSize:i.FontSize.FontTiny,color:"#00204DE5",flex:1},ctnBody:{backgroundColor:"#F8FAFE",paddingHorizontal:16,paddingTop:16},ctnSubBody:{backgroundColor:"#fff",borderRadius:10},ctnHeader:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:10,padding:10},textTitle:{color:"#00204D",fontSize:14,fontFamily:i.Font.InterMedium500},redDot:{color:"#E14337"},ctnFooter:{flexDirection:"row",paddingHorizontal:16,columnGap:16,marginTop:8},ctnUpload:{borderRadius:8,paddingVertical:6,flexDirection:"row",alignItems:"center",justifyContent:"flex-end"},textUpload:{color:"#6F2CED",fontSize:12,textDecorationLine:"underline",textDecorationColor:"#6F2CED"},ctnTextNote:{paddingHorizontal:10,paddingBottom:10,rowGap:4},ctnDes:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:8,backgroundColor:"#F2ECFD",marginHorizontal:16,padding:4,borderRadius:8},styleTextDes:{color:"#6F2CED",flex:1}})},78935:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(7005),l=r(n(43184)),a=n(14740),o=r(n(93238)),u=n(20880),s=n(2884),d=n(47671);t.default=function(){var e,t,n=(0,s.useTranslation)().t,r=(0,a.useRoute)(),c=null!=(e=null==r||null==(t=r.params)?void 0:t.iframeUrl)?e:"";return(0,d.jsxs)(i.SafeAreaView,{edges:["bottom"],style:{flex:1,backgroundColor:"#fff"},children:[(0,d.jsx)(l.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:n("RV.contract"),contentStyle:{backgroundColor:"#fff"}}),c&&(0,d.jsx)(o.default,{startInLoadingState:!0,injectedJavaScript:u.String.SCRIPT_SCALE_WEBVIEW,allowsInlineMediaPlayback:!0,mediaPlaybackRequiresUserAction:!1,domStorageEnabled:!0,javaScriptEnabled:!0,thirdPartyCookiesEnabled:!0,source:{uri:c}})]})}},77664:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(41132)),l=r(n(43693)),a=r(n(29293)),o=r(n(85715)),u=n(14740),s=n(32207),d=n(21527),c=n(2884),f=n(46317),p=n(12638),y=r(n(43184)),m=r(n(76644)),h=r(n(46542)),v=n(7005),x=n(26878),g=r(n(73264)),j=n(87841),S=r(n(8404)),I=r(n(24541)),w=r(n(94196)),b=n(35708),T=n(60596),k=r(n(94516)),D=n(2543),C=r(n(52275)),F=r(n(27747)),R=n(40851),_=r(n(77389)),V=n(97427),E=n(31004),P=n(99845),M=r(n(27163)),O=r(n(55529)),B=n(11671),A=n(47671);t.default=function(){var e,t,n=(0,c.useTranslation)().t,r=(0,p.useAppDispatch)(),N=(0,u.useRoute)(),L=null==N||null==(e=N.params)?void 0:e.dataUserTask,z=(null==N||null==(t=N.params)?void 0:t.isFinish)||!1,U=(0,u.useNavigation)(),H=(0,d.useState)(!1),G=(0,o.default)(H,2),W=G[0],$=G[1],Y=(0,d.useState)(!1),q=(0,o.default)(Y,2),K=q[0],J=q[1],X=(0,d.useState)(!1),Q=(0,o.default)(X,2),Z=Q[0],ee=Q[1],te=(0,d.useState)({}),ne=(0,o.default)(te,2),re=ne[0],ie=ne[1],le=(0,d.useState)(!1),ae=(0,o.default)(le,2),oe=ae[0],ue=ae[1],se=(0,d.useState)(""),de=(0,o.default)(se,2),ce=de[0],fe=de[1],pe=(0,d.useState)(""),ye=(0,o.default)(pe,2),me=ye[0],he=ye[1],ve=(0,d.useState)(!0),xe=(0,o.default)(ve,2),ge=xe[0],je=xe[1],Se=(0,d.useState)(!0),Ie=(0,o.default)(Se,2),we=Ie[0],be=Ie[1],Te=(0,d.useState)(!1),ke=(0,o.default)(Te,2),De=ke[0],Ce=ke[1],Fe=(0,d.useState)(),Re=(0,o.default)(Fe,2),_e=Re[0],Ve=Re[1],Ee=(0,d.useState)(),Pe=(0,o.default)(Ee,2),Me=Pe[0],Oe=Pe[1],Be=(0,d.useState)([]),Ae=(0,o.default)(Be,2),Ne=(Ae[0],Ae[1]),Le=(0,d.useState)(),ze=(0,o.default)(Le,2),Ue=ze[0],He=ze[1],Ge=(0,d.useState)({isRemindEnv:!1,overdueDate:new Date,remindStartDate:new Date,remindFrequency:"daily",remindContent:null}),We=(0,o.default)(Ge,2),$e=We[0],Ye=We[1],qe=(0,d.useState)(!1),Ke=(0,o.default)(qe,2),Je=(Ke[0],Ke[1]),Xe=(0,d.useState)([]),Qe=(0,o.default)(Xe,2),Ze=Qe[0],et=Qe[1],tt=(0,d.useState)([]),nt=(0,o.default)(tt,2),rt=nt[0],it=nt[1],lt=(0,d.useState)({}),at=(0,o.default)(lt,2),ot=at[0],ut=at[1],st=(0,d.useState)([]),dt=(0,o.default)(st,2),ct=(dt[0],dt[1]),ft=(0,d.useState)(),pt=(0,o.default)(ft,2),yt=pt[0],mt=pt[1],ht=(0,d.useState)(""),vt=(0,o.default)(ht,2),xt=vt[0],gt=vt[1],jt=(0,d.useState)({isError:"ecollabo"!==L.documentResource,errorViewMessage:"ecollabo"===L.documentResource?"":"RV.econtract.title"}),St=(0,o.default)(jt,2),It=St[0],wt=St[1],bt=(0,p.useAppSelector)((function(e){return e.ticket})),Tt=bt.dataTicketRedux,kt=bt.recipientDetaiImpl,Dt=bt.formData,Ct=bt.modeler,Ft=bt.statusPartyRaw,Rt=(0,d.useState)(null),_t=(0,o.default)(Rt,2),Vt=_t[0],Et=_t[1],Pt=(0,d.useState)(null==kt?void 0:kt.find((function(e){return e.userTaskId===(null==L?void 0:L.userTaskId)}))),Mt=(0,o.default)(Pt,1)[0],Ot=((0,p.useAppSelector)((function(e){return e.account})).dataAccount,(0,p.useAppSelector)((function(e){return e.common})).accessToken),Bt=(0,R.useReviewServices)(),At=(0,B.useTicketServices)(),Nt=(0,E.useReviewEcontractServices)(),Lt=(0,d.useMemo)((function(){return[{key:"RV.createBy",type:"avatar",value:{name:(null==Vt?void 0:Vt.personalName)||"---",email:Tt.createdBy||"---",avatarUrl:null==Vt?void 0:Vt.imageUrl}},{key:"RV.ticketName",type:"normal",value:{name:(null==Tt?void 0:Tt.title)||"---"}},{key:"RV.process",type:"normal",value:{name:(null==Tt?void 0:Tt.jsonXml)&&JSON.parse(null==Tt?void 0:Tt.jsonXml).properties.name||"---"}},{key:"RV.createDate",type:"normal",value:{name:b.DateUtils.convertDateToDDMMYYYY_H_M(null==Tt?void 0:Tt.createdDate)}},{key:"RV.infoForm",type:"form",value:{name:null==Dt?void 0:Dt.formName,funcViewFrom:function(){Ce(!0)}}},{key:"RV.status",type:"status",value:{status:Tt.ticketStatus===T.Status.voided?T.Status.voided:(null==Mt?void 0:Mt.recipientStatus)||T.Status.processing}}]}),[Tt,Dt,Ct,Vt]);(0,d.useEffect)((function(){Kt(),Jt(),Xt()}),[]);var zt,Ut,Ht,Gt,Wt,$t,Yt,qt,Kt=(zt=(0,a.default)((function*(){try{var e=yield Nt.getDataFormFill({versionId:Mt.versionFormId});e&&Ve(e)}catch(e){}})),function(){return zt.apply(this,arguments)}),Jt=(Ut=(0,a.default)((function*(){var e=yield Nt.getTicketModelerFlowStatusRaw(Tt.id);e&&mt(e)})),function(){return Ut.apply(this,arguments)}),Xt=(Ht=(0,a.default)((function*(){try{var e=yield At.getMultiLoginAccount([Tt.createdBy]);e&&e.length>0&&Et(e[0])}catch(e){}})),function(){return Ht.apply(this,arguments)}),Qt=(Gt=(0,a.default)((function*(){if(!ce)return je(!0),void he("CM.empty");he("");var e=Object.assign({},null==Mt?void 0:Mt.recipient,{reason:ce});(yield Bt.actionTicket(null==Mt?void 0:Mt.id,null==Mt?void 0:Mt.ticketId,null==Mt?void 0:Mt.userTaskId,e,Ot,"reject"))?(_.default.show({type:"success",text1:n("CM.noti"),text2:n("CM.rejectSucesss")}),r(V.ticketActions.setDataTicket(Object.assign({},Tt,{ticketStatus:T.Status.rejected}))),U.goBack()):_.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.rejectFailed")})})),function(){return Gt.apply(this,arguments)}),Zt=(Wt=(0,a.default)((function*(){return!rt.find((function(e){return!e.value.trim()&&e.required}))||(rt.filter((function(e){return!e.value.trim()&&e.required})).forEach((function(e){ie((function(t){return Object.assign({},t,(0,l.default)({},e.id,"CM.empty"))}))})),!1)})),function(){return Wt.apply(this,arguments)}),en=($t=(0,a.default)((function*(e){try{if(!e){if(rt.find((function(e){return!e.value.trim()&&e.required})))return void rt.filter((function(e){return!e.value.trim()&&e.required})).forEach((function(e){ie((function(t){return Object.assign({},t,(0,l.default)({},e.id,"CM.empty"))}))}));if(null!=_e&&_e.versionId)return void ue(!0)}J(!0);var t={id:"",refId:null,selector:"",lookup:Tt.id,attrs:{},payload:"",body:null},r=yield Nt.getAllFileInNotion(Tt.id,null==L?void 0:L.userTaskId);if("ewriter"===L.documentResource){if(!on(null==Me?void 0:Me.template))return void _.default.show({type:"error",text1:n("CM.noti"),text2:n("RV.econtract.alert.error.otp_with_ekyc")});var i=yield nn(r);t.payload=JSON.stringify(i),t.selector="flow_start_kyta_create_econtract_temp_n_determine"}if("ecollabo"===L.documentResource||"eclm"===L.documentResource||"eform"===L.documentResource){var a=tn(r);t.payload=JSON.stringify(a),t.selector="flow_start_kyta_create_econtract_auto_determine"}var o=yield Nt.createContract(t),u=an(o);u&&(_.default.show({type:u.alertType,text1:n("CM.noti"),text2:n(`RV.${u.message}`)}),"success"===u.alertType&&U.goBack())}catch(e){}finally{J(!1)}})),function(e){return $t.apply(this,arguments)}),tn=function(e){var t={refId:Tt.id,isDossier:!1,files:[],docTypeCode:null,headerFields:[],parties:null,owner:null==yt?void 0:yt.createdBy,recipientDetailsId:null==L?void 0:L.recipientDetailsId,userTaskId:null==L?void 0:L.userTaskId,ticketId:Tt.id,userTaskVersion:null,remind:$e.isRemindEnv?{expiredTime:b.DateUtils.convertDateToDDMMYYYY($e.overdueDate),remindBefore:b.DateUtils.convertDateToDDMMYYYY($e.remindStartDate),remindEvery:"daily"===$e.remindFrequency?"1":"0",remindMessage:$e.remindContent}:null},n=P.headerFieldsColla;return n.forEach((function(e){if("envSubmittedFrom"!==e.id){var t;if(rt.find((function(t){return t.id==e.id})))e.value=null==(t=rt.find((function(t){return t.id==e.id})))?void 0:t.value;"refId"===e.id&&(e.value=Tt.id)}})),t.headerFields=n.map((function(e){return{id:e.id,name:e.name,type:e.type,value:e.value}})),t.files=(0,i.default)(e.map((function(e,t){return{name:e.fileName,id:e.id,order:e.order,resource:e.resource}}))),t},nn=(Yt=(0,a.default)((function*(e){var t,n,r,l,a=yield ln(),o={refId:Tt.id,templateId:Ue.templateEcontractId,customData:[],inputData:{datas:[[]]},owner:"",recipientDetailsId:null==L?void 0:L.recipientDetailsId,userTaskId:null==L?void 0:L.userTaskId,ticketId:Tt.id,userTaskVersion:null,remind:$e.isRemindEnv?{expiredTime:b.DateUtils.convertDateToDDMMYYYY($e.overdueDate),remindBefore:b.DateUtils.convertDateToDDMMYYYY($e.remindStartDate),remindEvery:"daily"===$e.remindFrequency?"1":"0",remindMessage:$e.remindContent}:null,files:(0,i.default)(e),envelopeId:xt},u=null==Me||null==(t=Me.lotData)?void 0:t.datas[0];if(u.forEach((function(e){var t;"envSubmittedFrom"!==e.id&&(rt.find((function(t){return t.id==e.id}))&&(e.value=null==(t=rt.find((function(t){return t.id==e.id})))?void 0:t.value),"refId"===e.id&&(e.value=Tt.id))})),a){var s=rn(a);o.customData=s}return Ze.forEach((function(e){P.listTypeUserAction.forEach((function(t){e.recipient[t].forEach((function(e){u.forEach((function(t){if(t.id===e.id)if("r"===t.type)t.value=e.name;else if("m"===t.type)t.value=e.email;else if("phone"===t.type)t.value=e.phone;else if("fca"===t.type.toLowerCase())if(a&&a.recipientId&&a.back.content&&a.back.contentContentType&&a.front.content&&a.front.contentContentType)a&&(!a.back.content||!a.back.contentContentType||!a.front.content||a.front.contentContentType);else{t.type="fca_pre";var n=JSON.parse(t.value);n.type&&"fca"===n.type.toLowerCase()&&(n.type="fca_pre"),t.value=JSON.stringify(n)}}))}))}))})),(o=Object.assign({},o,{inputData:{datas:[(0,D.cloneDeep)(u)]}})).inputData.datas[0].forEach((function(e){"dueDays"===e.id&&(e.value=null==Me?void 0:Me.template.dueInDays)})),o.owner=null==Me||null==(n=Me.template)||null==(r=n.requester)||null==(l=r.contact)?void 0:l.email,o.customData.length>0?o.customData.forEach((function(e){o.inputData.datas.length>0&&(o.inputData.datas[0]=JSON.parse(JSON.stringify(o.inputData.datas[0].filter((function(t){return t.id!==e.recipientId||t.id===e.recipientId&&"fca_pre"!==t.type})))))})):o.inputData.datas[0]=JSON.parse(JSON.stringify(o.inputData.datas[0].filter((function(e){return"fca_pre"!==e.type&&"fca"!==e.type})))),o})),function(e){return Yt.apply(this,arguments)}),rn=function(e){var t=[];return Object.keys(ot).length>0&&Ze.forEach((function(n){P.listTypeUserAction.forEach((function(r){n.recipient[r].forEach((function(n){var r=ot[n.id];r.email=n.email,r.personalName=n.name,r.telephoneNumber=n.phone,e&&n.id===e.recipientId&&(r.photoBackSideIDCard&&r.photoBackSideIDCardContentType&&r.photoFrontSideIDCard&&r.photoFrontSideIDCardContentType&&(r.type="fca"),r.photoBackSideIDCard=e.back.content,r.photoBackSideIDCardContentType=e.back.contentContentType,r.photoFrontSideIDCard=e.front.content,r.photoFrontSideIDCardContentType=e.front.contentContentType,r.address=e.ekycRepository.attrs.address,r.commune=e.ekycRepository.attrs.commune,r.country=e.ekycRepository.attrs.country,r.location=e.ekycRepository.attrs.location,r.personalID=e.ekycRepository.attrs.personalID,r.provideAddress=e.ekycRepository.attrs.provideAddress,r.stateOrProvince=e.ekycRepository.attrs.stateOrProvince,r.refId=e.ekycRepository.attrs.refId,r.personalName=e.ekycRepository.attrs.personalName,r.ekycContent=e.ekycRepository.ekycContent,r.provideDate=b.DateUtils.convertDateToDDMMYYYY(e.ekycRepository.attrs.provideDate)),t.push(r)}))}))})),t},ln=(qt=(0,a.default)((function*(){var e,t="";if(null!=Ft&&Ft.party&&(null==Ft||null==(e=Ft.party)||e.recipients.forEach((function(e){"eID"===e.role&&(t=e.id)}))),!t)return null;var n={ticketId:Tt.id,userTaskId:t},r=yield Bt.getHistoryEkycDetail(n);if(!r)return null;var i=r.ekycRepositoryId,l=yield Bt.getEkycRepoById(i),a=yield Nt.getEkycRepositoryDetailIdCard(l.id,{ekycRepositoryId:i,id:l.id,recipientId:l.id});return a&&a.back&&a.front?{recipientId:l.personalId,ekycRepository:a.ekycRepository,front:{content:a.front.content,contentContentType:a.front.name},back:{content:a.back.content,contentContentType:a.back.name}}:null})),function(){return qt.apply(this,arguments)}),an=function(e){var t={message:"",alertType:""};return"-1"===e||-1===e||"13"===e||13===e?(t.message="econtract.alert.error.13-error",t.alertType="error"):"2"===e||2===e?(t.message="econtract.alert.error.2-ekyc",t.alertType="error"):"3"===e||3===e?(t.message="econtract.alert.error.3-error",t.alertType="error"):"4"===e||4===e?(t.message="econtract.alert.error.4-ewriter-file",t.alertType="error"):"5"===e||5===e?(t.message="econtract.alert.error.5-error",t.alertType="error"):"6"===e||6===e?(t.message="econtract.alert.error.6-no-sign-control",t.alertType="error"):"7"===e||7===e?(t.message="econtract.alert.error.7-digital-sign-amount-invalid",t.alertType="error"):"8"===e||8===e?(t.message="econtract.alert.error.8-field-role-invalid",t.alertType="error"):"9"===e||9===e?(t.message="econtract.alert.error.9-error",t.alertType="error"):"10"===e||10===e?(t.message="econtract.alert.error.10-error",t.alertType="error"):"12"===e||12===e?(t.message="econtract.alert.error.12-filename-not-found",t.alertType="error"):"14"===e||14===e?(t.message="econtract.alert.error.14-rcp-no-sign-control",t.alertType="error"):(t.message="econtract.alert.success.create",t.alertType="success"),t},on=function(e){if(e){for(var t=0;t<e.parties.length;t++)for(var n=0;n<e.parties[t].recipients.length;n++){var r=e.parties[t].recipients[n].signTypes;if(r&&r.includes("sign_fca.otp")){if(r.includes("sign_ekyc"))continue;return!1}}return!0}return!0};return(0,A.jsxs)(v.SafeAreaView,{edges:["bottom"],style:{flex:1,backgroundColor:"#fff"},children:[(0,A.jsx)(y.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:n("RV.econtract.infoContract"),contentStyle:{backgroundColor:"#fff"},renderContentRight:function(){return(0,A.jsx)(s.TopNavigationAction,{onPress:function(){return $(!0)},icon:(0,A.jsx)(f.IconWorkflow,{width:20,height:20})})}}),(0,A.jsxs)(x.KeyboardAwareScrollView,{style:{flex:1},children:[(0,A.jsx)(j.View,{style:S.default.ctnBody,children:(0,A.jsxs)(j.View,{style:S.default.ctnSubBody,children:[(0,A.jsxs)(j.Pressable,{style:S.default.ctnHeader,onPress:function(){return ee(!Z)},children:[(0,A.jsx)(s.Icon,{fill:"#6F2CED",width:16,height:16,name:Z?"arrow-circle-down":"arrow-circle-right"}),(0,A.jsx)(I.default,{style:S.default.textTitle,children:n("CM.infoCommon")})]}),Z&&(0,A.jsx)(j.View,{style:{paddingHorizontal:10,paddingBottom:10},children:(0,A.jsx)(w.default,{dataInfo:Lt})})]})}),z?(0,A.jsx)(g.default,{envelopeId:L.envelopeId}):(0,A.jsxs)(A.Fragment,{children:[_e&&(0,A.jsx)(j.View,{style:S.default.ctnBody,children:(0,A.jsxs)(j.View,{style:[S.default.ctnSubBody],children:[(0,A.jsxs)(j.Pressable,{style:S.default.ctnHeader,onPress:function(){return be(!we)},children:[(0,A.jsx)(s.Icon,{fill:"#6F2CED",width:16,height:16,name:we?"arrow-circle-down":"arrow-circle-right"}),(0,A.jsx)(I.default,{style:S.default.textTitle,children:n("RV.econtract.formNeedAction")})]}),we&&(0,A.jsxs)(j.View,{style:S.default.ctnFormName,children:[(0,A.jsxs)(I.default,{style:S.default.textTitle,children:[n("RV.econtract.fillForm")," "]}),(0,A.jsx)(j.TouchableOpacity,{onPress:(0,a.default)((function*(){ue(yield Zt())})),children:(0,A.jsx)(I.default,{style:S.default.formName,children:null==_e?void 0:_e.formName})})]})]})}),(0,A.jsx)(j.View,{style:S.default.ctnBody,children:(0,A.jsx)(C.default,{error:re,setError:ie,dataEcontractFlow:L,setTemplateStructure:Oe,setMergeFileList:Ne,setEWriterDocInfoWriter:He,setEnvRemind:Ye,envRemind:$e,setIsDTFlow:Je,setDataPartyForm:et,dataPartyForm:Ze,listFormEnvData:rt,setListFormEnvData:it,setListCaOtpRecipientForm:ut,setIsErrorView:wt,isErrorView:It,setDocumentList:ct,setGenerateEnvelopeId:gt})}),(0,A.jsx)(j.View,{style:S.default.ctnBody,children:(0,A.jsxs)(j.View,{style:[S.default.ctnSubBody,{marginBottom:16}],children:[(0,A.jsxs)(j.Pressable,{style:S.default.ctnHeader,onPress:function(){return je(!ge)},children:[(0,A.jsx)(s.Icon,{fill:"#6F2CED",width:16,height:16,name:ge?"arrow-circle-down":"arrow-circle-right"}),(0,A.jsx)(I.default,{style:S.default.textTitle,children:n("CM.note")})]}),ge&&(0,A.jsx)(j.View,{style:S.default.ctnNote,children:(0,A.jsx)(F.default,{isRequired:!0,label:n("CM.fillNote"),value:ce,onChangeText:function(e){fe(e),he("")},multiline:!0,maxLength:400,errorMessage:n(me)})})]})})]})]}),!z&&((null==Mt?void 0:Mt.recipientStatus)===T.Status.processing||null===(null==Mt?void 0:Mt.recipientStatus))&&!It.isError&&(0,A.jsx)(j.View,{style:S.default.ctnFooter,children:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(j.TouchableOpacity,{onPress:Qt,children:(0,A.jsx)(f.IconRejectReview,{width:36,height:36})}),(0,A.jsx)(k.default,{disabled:!(0,D.isEmpty)(re),style:{flex:1},label:n("CM.confirm"),onPress:function(){return en(!1)},loading:K})]})}),(0,A.jsx)(m.default,{isVisible:W,children:(0,A.jsx)(h.default,{onClose:function(){return $(!1)}})}),(0,A.jsx)(m.default,{isVisible:oe,children:(0,A.jsx)(O.default,{versionId:null==_e?void 0:_e.versionId,readOnly:!1,data:{_userTaskId:null==L?void 0:L.userTaskId,_ticketId:null==Tt?void 0:Tt.id,formId:null==_e?void 0:_e.formId},isShowNoti:!0,handleSubmit:function(){return en(!0)},onClose:function(){return ue(!1)},nameHeader:null==_e?void 0:_e.formName,envelopeEnvNo:xt})}),(0,A.jsx)(m.default,{isVisible:De,children:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(j.View,{style:{flex:1},children:(0,A.jsx)(M.default,{})}),(0,A.jsx)(k.default,{style:{backgroundColor:"#f2ecfd",marginHorizontal:16},styleLabel:{color:"#6d1fad"},label:n("CM.back"),onPress:function(){return Ce(!1)}})]})})]})}},31075:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ROOT_FOLDER_ID=void 0;var i=r(n(29293)),l=r(n(85715)),a=n(87841),o=r(n(43184)),u=n(20880),s=r(n(93238)),d=n(21527),c=n(32207),f=r(n(69290)),p=n(87414),y=n(84093),m=n(45335),h=n(2884),v=n(47671),x=t.ROOT_FOLDER_ID="000010000000000000";t.default=function(e){var t=e.url,n=e.toogleViewFile,r=e.isView,g=e.fileId,j=e.changeDataFile,S=e.fileName,I=(0,h.useTranslation)().t,w=(0,d.useState)(!1),b=(0,l.default)(w,2),T=b[0],k=b[1],D=(0,d.useState)(),C=(0,l.default)(D,2),F=C[0],R=C[1],_=(0,d.useState)(0),V=(0,l.default)(_,2),E=V[0],P=V[1],M=(0,d.useState)(r),O=(0,l.default)(M,2),B=O[0],A=O[1],N=(0,d.useState)(""),L=(0,l.default)(N,2),z=L[0],U=L[1],H=(0,d.useState)(!1),G=(0,l.default)(H,2),W=G[0],$=G[1],Y=function(){return $(!W)},q=(0,y.useReviewCollaboServices)(),K=function(){k(!T)};(0,d.useEffect)((function(){Q()}),[]);var J,X,Q=(J=(0,i.default)((function*(){var e=yield q.getFileById(g);e&&R(e)})),function(){return J.apply(this,arguments)}),Z=(X=(0,i.default)((function*(e){var t=Object.assign({},F,{status:e,versionId:e===p.FILE_ITEM_STATUS.DONE?null:null==F?void 0:F.versionId,fileParentId:(null==F?void 0:F.fileParentId)===x?"":null==F?void 0:F.fileParentId});(yield q.changeStatusFile(t))?(Y(),U("CL.changeStatusDone"),j((function(t){return Object.assign({},t,{status:e})})),A(e),P(E+1)):U("CL.changeStatusStop")})),function(e){return X.apply(this,arguments)}),ee=function(e){e===p.FILE_ITEM_STATUS.DONE?Z(p.FILE_ITEM_STATUS.DONE):e===p.FILE_ITEM_STATUS.STOP&&Z(p.FILE_ITEM_STATUS.STOP),K()};return(0,v.jsxs)(a.View,{style:{flex:1},children:[(0,v.jsx)(o.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:S,contentStyle:{backgroundColor:"#fff"},onPressIconLeft:n,renderContentRight:B===p.FILE_ITEM_STATUS.EDITING?function(){return(0,v.jsx)(c.TopNavigationAction,{icon:(0,v.jsx)(c.Icon,{name:"more-vertical"}),onPress:K})}:void 0}),(0,v.jsx)(c.Divider,{}),(0,v.jsx)(a.View,{style:{backgroundColor:"#fff",flex:1},children:(0,v.jsx)(s.default,{javaScriptEnabled:!0,injectedJavaScript:u.String.SCRIPT_SCALE_WEBVIEW,source:{uri:t}},E)}),(0,v.jsx)(f.default,{title:I("CL.changeStatus"),isVisible:T,onClose:K,renderContent:(0,v.jsxs)(a.View,{children:[(0,v.jsx)(c.MenuItem,{onPress:function(){return ee(p.FILE_ITEM_STATUS.DONE)},title:I("CL.done")}),(0,v.jsx)(c.MenuItem,{onPress:function(){return ee(p.FILE_ITEM_STATUS.STOP)},title:I("CL.stop")})]})}),(0,v.jsx)(m.Snackbar,{visible:W,duration:1e3,onDismiss:Y,children:I(z)})]})}},64898:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(29293)),l=r(n(85715)),a=n(87841),o=n(87414),u=r(n(24541)),s=n(32207),d=n(46317),c=r(n(76644)),f=n(21527),p=n(31004),y=r(n(91642)),m=r(n(31075)),h=n(2884),v=r(n(56677)),x=n(12638),g=n(60596),j=n(47671);t.default=function(e){var t,n,r,S=e.data,I=e.dataFlow,w=e.deleteFile,b=e.typeReview,T=(0,h.useTranslation)().t,k=(0,f.useState)(!1),D=(0,l.default)(k,2),C=D[0],F=D[1],R=(0,f.useState)(!1),_=(0,l.default)(R,2),V=_[0],E=_[1],P=(0,f.useState)(""),M=(0,l.default)(P,2),O=M[0],B=M[1],A=(0,f.useState)(S),N=(0,l.default)(A,2),L=N[0],z=N[1],U=(0,p.useReviewEcontractServices)(),H=(0,x.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,G=function(){F(!C)},W=function(){E(!V)},$=function(e){switch(e){case o.FILE_ITEM_STATUS.DRAFT:return{backgroundColor:"rgb(255, 243, 235)",color:"rgb(252, 107, 3)"};case o.FILE_ITEM_STATUS.EDITING:return{backgroundColor:"#efeffd",color:"#5d5fef"};case o.FILE_ITEM_STATUS.DONE:return{backgroundColor:"#06a87726",color:"#39ac6d"};case o.FILE_ITEM_STATUS.SIGN:return{backgroundColor:"#ef5da81a",color:"#943cdd"};case o.FILE_ITEM_STATUS.REQUEST_EDIT:return{backgroundColor:"#f6eefc",color:"#943cdd"};case o.FILE_ITEM_STATUS.STOP:return{backgroundColor:"#fceeed",color:"#e14337"};default:return{backgroundColor:"rgb(255, 243, 235)",color:"rgb(252, 107, 3)"}}},Y=(t=(0,i.default)((function*(e){var t=yield U.getLinkIframeEcollabo(e);t&&(B(t.iframe),G())})),function(e){return t.apply(this,arguments)});return(0,j.jsxs)(a.View,{style:y.default.ctnMain,children:[(0,j.jsx)(a.View,{style:y.default.ctnLeft,children:(0,j.jsx)(d.IconDocx,{width:32,height:32})}),(0,j.jsxs)(a.View,{style:y.default.ctnRight,children:[(0,j.jsx)(a.TouchableOpacity,{onPress:function(){return Y(L.fileId)},children:(0,j.jsx)(u.default,{style:y.default.fileName,children:null==L?void 0:L.fileName})}),(0,j.jsxs)(a.View,{style:y.default.ctnBody,children:[(0,j.jsx)(u.default,{style:y.default.srcSys,children:(null==L?void 0:L.sourceSystem)||"Từ eRequest"}),(0,j.jsx)(u.default,{children:"•"}),(0,j.jsx)(u.default,{style:y.default.srcSys,children:(r=null==L?void 0:L.fileSize,r&&r>=1024?Math.floor(r/1024)+" KB":r&&r<1024?r+" MB":"---")})]}),(0,j.jsxs)(a.View,{style:y.default.ctnAction,children:[(0,j.jsx)(a.View,{style:[y.default.ctnStatus,{backgroundColor:$(null==L?void 0:L.status).backgroundColor}],children:(0,j.jsx)(u.default,{style:[{textAlign:"center",color:$(null==L?void 0:L.status).color},y.default.srcSys],children:(n=null==L?void 0:L.status,T("RV.status-collabo."+Object.keys(o.FILE_ITEM_STATUS)[n]))})}),(0,j.jsx)(a.View,{style:y.default.action})]}),H.ticketStatus!==g.Status.voided&&H.ticketStatus!==g.Status.rejected&&(0,j.jsxs)(a.View,{style:y.default.action,children:["eCollabo"===b&&"task-success"!=(null==I?void 0:I._status)&&(0,j.jsx)(a.TouchableOpacity,{hitSlop:10,onPress:W,children:(0,j.jsx)(s.Icon,{fill:"#00204DB2",width:16,height:16,name:"share-outline"})}),(0,j.jsx)(a.TouchableOpacity,{hitSlop:10,onPress:function(){return Y(L.fileId)},children:(0,j.jsx)(s.Icon,{fill:"#00204DB2",width:16,height:16,name:L.status===o.FILE_ITEM_STATUS.EDITING?"edit-2-outline":"eye-outline"})}),L.sourceSystem.includes("eRequest")&&L.status!=o.FILE_ITEM_STATUS.DONE&&(0,j.jsx)(a.TouchableOpacity,{hitSlop:10,onPress:function(){return null==w?void 0:w(L.fileId)},children:(0,j.jsx)(s.Icon,{fill:"#00204DB2",width:16,height:16,name:"trash"})})]}),(0,j.jsx)(s.Divider,{})]}),C&&(0,j.jsx)(c.default,{isVisible:C,children:(0,j.jsx)(m.default,{changeDataFile:z,isView:L.status,url:O,toogleViewFile:G,fileId:L.fileId,fileName:null==L?void 0:L.fileName})}),(0,j.jsx)(c.default,{isVisible:V,children:(0,j.jsx)(v.default,{dataDetailFile:L,toogleFunc:W})})]})}},91642:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({ctnMain:{flexDirection:"row",alignItems:"center",justifyContent:"center",backgroundColor:"#fff",paddingVertical:8},ctnLeft:{width:80,alignItems:"center",justifyContent:"center"},ctnRight:{flex:1,rowGap:8},fileName:{fontSize:14,color:"#00204DF2",fontFamily:i.Font.InterRegular400},ctnBody:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:4},srcSys:{fontSize:12,color:"#00204DF2",fontFamily:i.Font.InterRegular400},ctnAction:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},ctnStatus:{borderRadius:4,backgroundColor:"#E8F7EF",paddingHorizontal:8,paddingVertical:4},action:{flexDirection:"row",alignItems:"center",justifyContent:"flex-end",columnGap:16}})},67831:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),l=r(n(24541)),a=r(n(91278)),o=r(n(42467)),u=n(99845),s=n(2884),d=n(47671);t.default=function(e){var t=e.party,n=e.index,r=e.error,c=e.setError,f=(0,s.useTranslation)().t;return(0,d.jsxs)(i.View,{children:[(0,d.jsx)(i.View,{style:o.default.ctnMain,children:(0,d.jsxs)(l.default,{style:o.default.text,children:[f("RV.econtract.join")," ",n]})}),(0,d.jsx)(i.View,{style:o.default.ctnRecipient,children:u.listTypeUserAction.map((function(e){return t.recipient[e].map((function(t,n){return(0,d.jsx)(a.default,{error:r,setError:c,recipient:t,type:e},n)}))}))})]})}},42467:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({ctnMain:{backgroundColor:"#F2ECFD",borderRadius:8,paddingHorizontal:12,paddingVertical:10,marginHorizontal:10},text:{color:"#6F2CED",fontSize:16,fontFamily:i.Font.InterSemiBold600},ctnRecipient:{paddingHorizontal:12,marginBottom:16}})},91278:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(43693)),l=r(n(85715)),a=n(87841),o=r(n(54813)),u=r(n(24541)),s=r(n(65963)),d=n(99845),c=n(21527),f=n(32207),p=r(n(54582)),y=n(35708),m=n(2884),h=n(47671);t.default=function(e){var t=e.recipient,n=e.type,r=e.error,v=e.setError,x=(0,m.useTranslation)().t,g=(0,c.useState)(t.notifyType.map((function(e){return new f.IndexPath(d.notifyType.findIndex((function(t){return t.value===e})))}))),j=(0,l.default)(g,2),S=j[0],I=j[1],w=(0,c.useState)((0,i.default)((0,i.default)((0,i.default)({},`name_${t.id}`,!0),`email_${t.id}`,!0),`phone_${t.id}`,!1)),b=(0,l.default)(w,2),T=b[0],k=b[1];(0,c.useEffect)((function(){var e=r;0===S.length?(e[`notifyType_${t.id}`]="CM.empty",t.notifyType=[]):(delete e[`notifyType_${t.id}`],t.notifyType=S.map((function(e){return d.notifyType[e.row].value})),2===S.length?k((0,i.default)((0,i.default)((0,i.default)({},`name_${t.id}`,!0),`email_${t.id}`,!0),`phone_${t.id}`,!0)):0===S[0].row?(k((0,i.default)((0,i.default)((0,i.default)({},`name_${t.id}`,!0),`email_${t.id}`,!1),`phone_${t.id}`,!0)),t.phone?y.RegexUtils.REGEX_PHONE_NUMBER_9.test(t.phone)||v((function(e){return Object.assign({},e,(0,i.default)({},`phone_${t.id}`,"CM.validPhone"))})):v((function(e){return Object.assign({},e,(0,i.default)({},`phone_${t.id}`,"CM.empty"))}))):1===S[0].row&&(k((0,i.default)((0,i.default)((0,i.default)({},`name_${t.id}`,!0),`email_${t.id}`,!0),`phone_${t.id}`,!1)),t.email?y.RegexUtils.FORMAT_EMAIL.test(t.email)||v((function(e){return Object.assign({},e,(0,i.default)({},`email_${t.id}`,"CM.validEmail"))})):v((function(e){return Object.assign({},e,(0,i.default)({},`email_${t.id}`,"CM.empty"))})))),v((function(t){return Object.assign({},t,e)}))}),[S]);var D=function(e,n,r){t[e]=r,r.trim()?"email"!==e||y.RegexUtils.FORMAT_EMAIL.test(r)?"phone"!==e||y.RegexUtils.REGEX_PHONE_NUMBER_9.test(r)?v((function(t){var r=Object.assign({},t);return delete r[`${e}_${n}`],r})):v((function(t){return Object.assign({},t,(0,i.default)({},`${e}_${n}`,"CM.validPhone"))})):v((function(t){return Object.assign({},t,(0,i.default)({},`${e}_${n}`,"CM.validEmail"))})):v((function(t){var r=Object.assign({},t);return T[`${e}_${n}`]?r[`${e}_${n}`]="CM.empty":delete r[`${e}_${n}`],r}))};return(0,h.jsxs)(a.View,{children:[(0,h.jsx)(u.default,{style:p.default.text,children:x(`RV.econtract.${n}`)}),(0,h.jsx)(o.default,{isRequired:T[`name_${t.id}`],label:x("RV.econtract.name"),value:t.name,captionText:x(r[`name_${t.id}`]),status:r[`name_${t.id}`]?"danger":"basic",onChangeText:function(e){return D("name",t.id,e)}}),(0,h.jsx)(o.default,{isRequired:T[`email_${t.id}`],label:"Email",keyBoardType:"email-address",value:t.email,captionText:x(r[`email_${t.id}`]),status:r[`email_${t.id}`]?"danger":"basic",onChangeText:function(e){return D("email",t.id,e)}}),(0,h.jsx)(o.default,{isRequired:T[`phone_${t.id}`],label:x("RV.econtract.phone"),value:t.phone,keyBoardType:"numeric",captionText:x(r[`phone_${t.id}`]),status:r[`phone_${t.id}`]?"danger":"basic",onChangeText:function(e){return D("phone",t.id,e)}}),(0,h.jsx)(s.default,{valueSelect:S,onSelect:I,label:x("RV.econtract.notify-type"),isRequired:!0,multiple:!0,size:"medium",caption:x(r[`notifyType_${t.id}`]),status:r[`notifyType_${t.id}`]?"danger":"basic",listData:d.notifyType})]})}},54582:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({text:{fontSize:15,fontFamily:i.Font.InterMedium500,color:"#00204D",textDecorationLine:"underline",paddingVertical:6}})},99845:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.notifyType=t.listTypeUserAction=t.listRemind=t.headerFieldsColla=void 0;t.listRemind=[{label:"Nhắc hằng ngày",value:"daily"},{label:"Nhắc một lần",value:"onetime"}],t.notifyType=[{label:"Thông báo qua sms",value:"sms"},{label:"Thông báo qua email",value:"email"}],t.listTypeUserAction=["reviewer","signer","stamper"],t.headerFieldsColla=[{id:"envName",name:"Tên tài liệu",type:"header_fields",value:"",owner:"envelope_hdr",dataType:"String",required:!0},{id:"envNo",name:"Số tài liệu",type:"header_fields",value:"",owner:"envelope_hdr",dataType:"String",required:!1},{id:"envDate",name:"Ngày ký",type:"header_fields",value:"",owner:"envelope_hdr",dataType:"Date",required:!1},{id:"envSubmittedFrom",name:" Được gửi từ :  ",type:"header_fields",value:"",owner:"envelope_hdr",dataType:"String",required:!1}]},52275:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(43693)),l=r(n(41132)),a=r(n(29293)),o=r(n(85715)),u=n(21527),s=n(12638),d=n(31004),c=n(87841),f=r(n(54813)),p=n(32207),y=r(n(24541)),m=r(n(23599)),h=r(n(33254)),v=r(n(65963)),x=n(99845),g=r(n(27747)),j=r(n(67831)),S=n(2884),I=r(n(64898)),w=n(40851),b=n(47671),T=["000010eViX8cWwWn5reR","000010Nmi1KfN5azzXD4","000010ayipEI5eN61LrV","0000101JigKI6w6GvQ5G"];t.default=function(e){var t=e.dataEcontractFlow,n=e.error,r=e.setError,k=e.setTemplateStructure,D=(e.setMergeFileList,e.setEWriterDocInfoWriter),C=e.setEnvRemind,F=e.envRemind,R=e.setIsDTFlow,_=e.dataPartyForm,V=e.setDataPartyForm,E=e.listFormEnvData,P=e.setListFormEnvData,M=e.setListCaOtpRecipientForm,O=e.setIsErrorView,B=e.isErrorView,A=e.setDocumentList,N=e.setGenerateEnvelopeId,L=(0,S.useTranslation)().t,z=(0,u.useState)(!0),U=(0,o.default)(z,2),H=U[0],G=U[1],W=(0,u.useState)(!0),$=(0,o.default)(W,2),Y=$[0],q=$[1],K=(0,u.useState)(!0),J=(0,o.default)(K,2),X=J[0],Q=J[1],Z=(0,u.useState)(),ee=(0,o.default)(Z,2),te=(ee[0],ee[1]),ne=(0,u.useState)([]),re=(0,o.default)(ne,2),ie=re[0],le=re[1],ae=(0,u.useState)(),oe=(0,o.default)(ae,2),ue=oe[0],se=oe[1],de=(0,u.useState)(!1),ce=(0,o.default)(de,2),fe=ce[0],pe=ce[1],ye=(0,s.useAppSelector)((function(e){return e.ticket})).dataTicketRedux,me=(0,u.useState)(new p.IndexPath(0)),he=(0,o.default)(me,2),ve=he[0],xe=he[1],ge=(0,u.useState)(),je=(0,o.default)(ge,2),Se=je[0],Ie=je[1],we=(0,u.useState)(),be=(0,o.default)(we,2),Te=be[0],ke=be[1],De=[],Ce=(0,s.useAppSelector)((function(e){return e.common})).accessToken,Fe=(0,s.useAppSelector)((function(e){return e.account})).dataAccount,Re=(0,d.useReviewEcontractServices)(),_e=(0,w.useReviewServices)();(0,u.useEffect)((function(){Ke()}),[]),(0,u.useEffect)((function(){C((function(e){return Object.assign({},e,{remindFrequency:x.listRemind[ve.row].value})}))}),[ve]);Ve=(0,a.default)((function*(){var e=yield _e.getFormByUserTaskIdAndTicketId(ye.id,t.userTaskId);e&&(Ie(e.versionFormId),ke(e))}));var Ve,Ee,Pe,Me,Oe,Be,Ae,Ne,Le,ze,Ue,He,Ge,We,$e,Ye,qe,Ke=(Ee=(0,a.default)((function*(){try{q(!0),null!=t&&t.userTaskId&&(ye.id,yield Qe(),"ewriter"===t.documentResource?yield Ze():"ecollabo"===t.documentResource?yield st():("eclm"===t.documentResource||"eform"===t.documentResource)&&dt())}catch(e){}finally{q(!1)}})),function(){return Ee.apply(this,arguments)}),Je=(Pe=(0,a.default)((function*(){try{return yield Re.getExecutorByTicketIdAndUsertaskId(ye.id,"sid-CF5A88D7-5159-4644-9606-2FFB36DDC0E5")}catch(e){return null}})),function(){return Pe.apply(this,arguments)}),Xe=(Me=(0,a.default)((function*(){try{var e={userTaskId:null,ticketId:ye.id,version:null};return yield _e.getFormVersionByTicketAndUserTaskId(e,Ce)}catch(e){return null}})),function(){return Me.apply(this,arguments)}),Qe=(Oe=(0,a.default)((function*(){var e=yield Re.getAllFileInNotion(ye.id,null==t?void 0:t.userTaskId);e&&(De=e)})),function(){return Oe.apply(this,arguments)}),Ze=(Be=(0,a.default)((function*(){var e=yield ut();if(e){var t=ye.modelerId;if(t&&T.includes(t)){var n=(yield Re.getTicketForms(ye.id)).find((function(e){return!e.userTaskId}));if(n&&n.formData){var r=n.formData,i=r.find((function(e){return"contract"===e.label})),l=r.find((function(e){return"category"===e.label}));i&&l&&(yield et(e,i.value,l.value))}}else yield nt()}})),function(){return Be.apply(this,arguments)}),et=(Ae=(0,a.default)((function*(e,t,n){if(R(!0),e.length>1)try{var r=tt(t,n),i=De.find((function(e){return(e.fileName&&e.fileName.split(".")[0])===r}));if(i&&i.id){var l={Id:i.id},a=yield Re.getEcontractDocInfo(l);a&&a.templateEcontractId&&(yield rt(a))}}catch(e){}})),function(e,t,n){return Ae.apply(this,arguments)}),tt=function(e,t){var n=e.split(" ").join("");return"Troubleshoot"===t?`KPSC_${n}`:`BDĐK_${n}`},nt=(Ne=(0,a.default)((function*(){var e,t=(e=De).reduce((function(e,t){return+t.order<+e.order?t:e}),e[0]);if(t&&t.id){var n={Id:t.id},r=yield Re.getEcontractDocInfo(n);r&&r.templateEcontractId&&(yield rt(r))}})),function(){return Ne.apply(this,arguments)}),rt=(Le=(0,a.default)((function*(e){D(e);var t={templateid:e.templateEcontractId},n=yield Re.getStructureOfData(t,Ce);if(n){var r,i;k(n),n.template&&se(null==n||null==(i=n.template)?void 0:i.docTypeCode);var l=null==n||null==(r=n.lotData)?void 0:r.datas[0];P(l.filter((function(e){return"envSubmittedFrom"!==e.id&&"header_fields"===e.type}))),O({isError:!1,errorViewMessage:""}),l&&l.filter((function(e){return"header_fields"!==e.type})).length>0&&(yield it(n))}})),function(e){return Le.apply(this,arguments)}),it=(ze=(0,a.default)((function*(e){var t,n=[],r=null==e||null==(t=e.lotData)?void 0:t.datas[0],i=r.filter((function(e){return"p"===e.type}));n.push.apply(n,(0,l.default)(i.map((function(e){return{id:e.id,recipient:{reviewer:[],signer:[],stamper:[]}}})))),n.map((function(t){r.filter((function(e){return"r"===e.type&&e.id.includes(t.id)})).forEach((function(i){var l,a;lt(e.template,i.id);var o=ot(e.template,i.id);null==n||null==(l=n.find((function(e){return e.id===t.id})))||null==(a=l.recipient)||a[o].push(at(i.id,r))}))}));var a=yield Je(),o=yield Xe();if(a&&n.forEach((function(e){var t,n;"p_001"===e.id&&(null==e||null==(t=e.recipient)||null==(n=t.signer)||n.forEach((function(e){var t,n,r,i,l,o;"p_001_r_001"===e.id&&(e.name=null==a||null==(t=a.recipient)||null==(n=t.contact)?void 0:n.name,e.phone=null==a||null==(r=a.recipient)||null==(i=r.contact)?void 0:i.phone,e.email=null==a||null==(l=a.recipient)||null==(o=l.contact)?void 0:o.email)})))})),o){var u=o.formData,s=u.find((function(e){return"partyOutletName"===e.code})),d=u.find((function(e){return"partyOutletPhone"===e.code}));n.forEach((function(e){var t,n;"p_002"===e.id&&(null==e||null==(t=e.recipient)||null==(n=t.signer)||n.forEach((function(e){"p_002_r_001"===e.id&&(s&&(e.name=s.value),d&&(e.phone=d.value))})))}))}V(n)})),function(e){return ze.apply(this,arguments)}),lt=function(e,t){e.parties.forEach((function(e){e.recipients.forEach((function(e){e.id===t&&e.signTypes&&e.signTypes.find((function(e){return"sign_fca.otp"===e}))&&M((function(n){return Object.assign({},n,(0,i.default)({},t,{recipientId:t,email:e.contact.email,telephoneNumber:e.contact.phone,contactId:e.contact.id,personalName:e.contact.name,location:null,stateOrProvince:null,country:null,personalID:null,passportID:null,type:"fca_pre",photoIDCard:null,photoIDCardContentType:null,photoFrontSideIDCard:null,photoFrontSideIDCardContentType:null,photoBackSideIDCard:"",photoBackSideIDCardContentType:null,statusCode:null,resourceType:null,provideAddress:null,provideDate:null,commune:null,address:null,refId:null}))}))}))}))},at=function(e,t){var n=t.filter((function(t){return t.id===e})),r=n.find((function(e){return"r"===e.type})),i=n.find((function(e){return"m"===e.type})),l=n.find((function(e){return"phone"===e.type})),a=n.find((function(e){return"contact_recipient"===e.type}));return{id:e,name:r?r.value:null,phone:l?l.value:null,email:i?i.value:null,contactRecipient:a?a.value:null,notifyType:["email"]}},ot=function(e,t){var n="";return e&&e.parties.forEach((function(e){e.recipients.forEach((function(e){e.id===t&&(n=e.role)}))})),n},ut=(Ue=(0,a.default)((function*(){try{return yield Re.getEWriterDocByUserTaskIdAndTicketId(null==t?void 0:t.userTaskId,ye.id)}catch(e){}})),function(){return Ue.apply(this,arguments)}),st=(He=(0,a.default)((function*(){yield ct(),P(x.headerFieldsColla.filter((function(e){return"envSubmittedFrom"!==e.id})))})),function(){return He.apply(this,arguments)}),dt=function(){P(x.headerFieldsColla.filter((function(e){return"envSubmittedFrom"!==e.id})))},ct=(Ge=(0,a.default)((function*(){var e=yield Re.getListCollaboDocs(ye.id,null==t?void 0:t.userTaskId);if(e){A(e);var n=yield Promise.all(e.map((function(e){return Re.getDetailCollabora(e.fileId)})));le(n)}})),function(){return Ge.apply(this,arguments)}),ft=(We=(0,a.default)((function*(){try{var e=yield Re.getRecipientDetail(null==t?void 0:t.userTaskId,ye.id);e&&te(e)}catch(e){}})),function(e,t,n){P(E.map((function(t){return t.id!==e?t:Object.assign({},t,{value:n})}))),t&&(n.trim()?r((function(t){var n=Object.assign({},t);return delete n[e],n})):r((function(t){return Object.assign({},t,(0,i.default)({},e,"CM.empty"))})))}),pt=function(e,t){C((function(n){return Object.assign({},n,(0,i.default)({},e,t))})),"isRemindEnv"!==e||!1!==t?"remindContent"!==e&&r(t?function(t){var n=Object.assign({},t);return delete n[e],n}:function(t){return Object.assign({},t,(0,i.default)({},e,"CM.empty"))}):r((function(e){var t=Object.assign({},e);return delete t.overdueDate,delete t.remindStartDate,delete t.remindFrequency,delete t.remindContent,t}))},yt=($e=(0,a.default)((function*(){if(ue&&!fe){var e,n={id:"",refId:ye.id,selector:"after_flow_start_kyta_create_env_no",lookup:ye.id,attrs:{},payload:JSON.stringify({refId:ye.id,docTypeCode:ue,owner:Fe.email?Fe.email:null==t?void 0:t.owner,recipientDetailsId:null==t?void 0:t.recipientDetailsId,userTaskId:null==t?void 0:t.userTaskId,ticketId:ye.id,userTaskVersion:null}),body:null},r=yield Re.generateEnvNo(n);r&&"0"===r.code&&(N(null==r||null==(e=r.response)?void 0:e.envelopeId),pe(!0),P(E.map((function(e){var t,n;return"envNo"===e.id?Object.assign({},e,{value:null==r||null==(t=r.response)||null==(n=t.envNo)?void 0:n.value}):e}))),yield mt())}})),function(){return $e.apply(this,arguments)}),mt=(Ye=(0,a.default)((function*(){var e={userTaskId:null==t?void 0:t.userTaskId,ticketId:ye.id,version:null},n=yield _e.getFormVersionByTicketAndUserTaskId(e,Ce);if(n){var r=JSON.parse(n);yield ht(r)}})),function(){return Ye.apply(this,arguments)}),ht=(qe=(0,a.default)((function*(e){if(e){e.forEach((function(e){var t;"eContractEnvelopEnvNo"===e.code&&(e.value=null==(t=E.find((function(e){return"envNo"===e.id})))?void 0:t.value)}));var n={formData:e,ticketId:ye.id,userTaskId:null==t?void 0:t.userTaskId,version:Se,eformId:null==Te?void 0:Te.formId};yield _e.updateFormData(n,Ce)}})),function(e){return qe.apply(this,arguments)});return Y?(0,b.jsx)(c.View,{style:{flex:1,justifyContent:"center",alignItems:"center"},children:(0,b.jsx)(p.Spinner,{size:"large"})}):(0,b.jsx)(c.View,{style:{backgroundColor:"#fff"},children:B.isError?(0,b.jsx)(y.default,{style:m.default.textError,children:L(B.errorViewMessage)}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.View,{children:(0,b.jsxs)(c.Pressable,{style:[m.default.ctnHeader],onPress:function(){return G(!H)},children:[(0,b.jsx)(p.Icon,{fill:"#6F2CED",width:16,height:16,name:H?"arrow-circle-down":"arrow-circle-right"}),(0,b.jsxs)(y.default,{style:m.default.textTitle,children:[L("RV.econtract.infoContract")," ",(0,b.jsx)(y.default,{style:m.default.redDot,children:"*"})]})]})}),(0,b.jsxs)(c.View,{style:{paddingHorizontal:10},children:[E&&H&&E.map((function(e,t){return(0,b.jsxs)(b.Fragment,{children:["Date"!==e.dataType&&(0,b.jsx)(u.Fragment,{children:(0,b.jsx)(f.default,{disabled:"envNo"===e.id&&fe,label:e.name,value:e.value,onChangeText:function(t){return ft(e.id,e.required,t)},isRequired:e.required,captionText:L(n[e.id]),status:n[e.id]?"danger":"basic",placeholder:"Nhập "+e.name.toLowerCase(),accessoryRightIcon:"envNo"===e.id?(0,b.jsx)(c.Pressable,{onPress:yt,children:(0,b.jsx)(y.default,{style:m.default.capSo,children:L("CM.generateEnvNo")})}):void 0})},t),"Date"===e.dataType&&(0,b.jsx)(u.Fragment,{children:(0,b.jsx)(h.default,{isRequired:e.required,label:e.name,value:e.value,captionText:L(n[e.id]),status:n[e.id]?"danger":"basic",onChangeDate:function(t){return ft(e.id,e.required,t)}})},t)]})})),H&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(p.CheckBox,{style:{paddingVertical:8},checked:F.isRemindEnv,onChange:function(e){return pt("isRemindEnv",e)},children:function(e){return(0,b.jsx)(y.default,Object.assign({},e,{children:L("RV.econtract.remind")}))}}),F.isRemindEnv&&(0,b.jsxs)(c.View,{style:{rowGap:4},children:[(0,b.jsx)(h.default,{isRequired:!0,label:L("RV.econtract.overdueDate"),value:F.overdueDate,captionText:L(n.overdueDate),status:n.overdueDate?"danger":"basic",onChangeDate:function(e){return pt("overdueDate",e)}}),(0,b.jsx)(h.default,{isRequired:!0,label:L("RV.econtract.remindStartDate"),value:F.remindStartDate,captionText:L(n.remindStartDate),status:n.remindStartDate?"danger":"basic",onChangeDate:function(e){return pt("remindStartDate",e)}}),(0,b.jsx)(v.default,{onSelect:xe,valueSelect:ve,placeholder:L("RV.econtract.remindFrequency"),label:L("RV.econtract.notiType"),isRequired:!0,size:"medium",listData:x.listRemind,caption:L(n.remindFrequency),status:n.remindFrequency?"danger":"primary"}),(0,b.jsxs)(c.View,{style:{paddingVertical:6,rowGap:4},children:[(0,b.jsx)(y.default,{style:m.default.textRemind,children:L("CM.remind")}),(0,b.jsx)(g.default,{isRequired:!0,label:L("CM.fillRemind"),value:F.remindContent,onChangeText:function(e){return pt("remindContent",e)},multiline:!0,maxLength:400})]})]})]})]}),(0,b.jsx)(c.View,{children:(0,b.jsxs)(c.Pressable,{style:[m.default.ctnHeader],onPress:function(){return Q(!X)},children:[(0,b.jsx)(p.Icon,{fill:"#6F2CED",width:16,height:16,name:X?"arrow-circle-down":"arrow-circle-right"}),"ewriter"===t.documentResource?(0,b.jsxs)(y.default,{style:m.default.textTitle,children:[L("RV.econtract.listEwriter")," ",(0,b.jsx)(y.default,{style:m.default.redDot,children:"*"})]}):(0,b.jsx)(y.default,{style:m.default.textTitle,children:L("RV.econtract.listEcollabo")})]})}),X&&(0,b.jsx)(b.Fragment,{children:"ewriter"===t.documentResource?(0,b.jsx)(b.Fragment,{children:_&&_.map((function(e,t){return(0,b.jsx)(j.default,{error:n,setError:r,party:e,index:t+1})}))}):(0,b.jsxs)(c.View,{style:{padding:10},children:[(0,b.jsx)(y.default,{children:L("RV.econtract.listEcontract")}),ie&&(0,b.jsx)(p.List,{scrollEnabled:!1,data:ie,renderItem:function(e){var t=e.item;return(0,b.jsx)(I.default,{typeReview:"eContract",data:t})}})]})})]})})}},87414:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FILE_ITEM_STATUS=void 0;t.FILE_ITEM_STATUS={DRAFT:0,EDITING:1,DONE:2,SIGN:3,REQUEST_EDIT:4,STOP:5}},23599:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880),l=n(41995);t.default=r.StyleSheet.create({ctnBody:{backgroundColor:"#fff",padding:(0,l.SizeDP)(10),borderRadius:8},ctnWrapperItem:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",columnGap:(0,l.SizeDP)(16),marginBottom:(0,l.SizeDP)(24)},txtTitle:{fontFamily:i.Font.InterSemiBold600,fontSize:i.FontSize.FontTiny,color:i.Color.colorText,flex:.5},txtValue:{fontFamily:i.Font.InterRegular400,fontSize:i.FontSize.FontTiny,color:"#00204DE5",flex:1},ctnHeader:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:10,padding:10,backgroundColor:"#FFFFFF",borderRadius:8},textTitle:{color:"#00204D",fontSize:14,fontFamily:i.Font.InterMedium500},redDot:{color:"#E14337"},textError:{fontSize:16,color:"#000",textAlign:"center",padding:16,fontFamily:i.Font.InterSemiBold600},textRemind:{fontSize:12,fontFamily:i.Font.InterMedium500,color:"#00204DF2"},capSo:{color:"#00f",fontSize:14,fontFamily:i.Font.InterMedium500}})},8404:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880),l=n(41995);t.default=r.StyleSheet.create({ctnMain:{padding:(0,l.SizeDP)(16),backgroundColor:"#F8FAFE",flex:1},ctnWrapperItem:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",columnGap:(0,l.SizeDP)(16),marginBottom:(0,l.SizeDP)(24)},txtTitle:{fontFamily:i.Font.InterSemiBold600,fontSize:i.FontSize.FontTiny,color:i.Color.colorText,flex:.5},txtValue:{fontFamily:i.Font.InterRegular400,fontSize:i.FontSize.FontTiny,color:"#00204DE5",flex:1},ctnBody:{backgroundColor:"#F8FAFE",paddingHorizontal:16,paddingTop:16},ctnSubBody:{backgroundColor:"#fff",borderRadius:10},ctnHeader:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:10,padding:10},textTitle:{color:"#00204D",fontSize:14,fontFamily:i.Font.InterMedium500},redDot:{color:"#E14337"},ctnFooter:{flexDirection:"row",paddingHorizontal:16,columnGap:16,marginTop:8},ctnNote:{paddingHorizontal:10,paddingBottom:10,rowGap:4},formName:{fontSize:14,color:"#366ae2",textDecorationLine:"underline",fontFamily:i.Font.InterRegular400},ctnFormName:{paddingHorizontal:10,paddingBottom:10,rowGap:4}})},73264:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(29293)),l=r(n(85715)),a=n(14740),o=n(12638),u=n(21527),s=n(87841),d=r(n(24541)),c=n(35708),f=n(20880),p=r(n(32055)),y=n(31004),m=r(n(63204)),h=n(2884),v=n(32207),x=n(47671);t.default=function(e){var t=e.envelopeId,n=(0,h.useTranslation)().t,r=(0,a.useNavigation)(),g=(0,o.useAppSelector)((function(e){return e.common})).accessToken,j=(0,u.useState)(),S=(0,l.default)(j,2),I=S[0],w=S[1],b=(0,u.useState)([]),T=(0,l.default)(b,2),k=T[0],D=T[1],C=(0,u.useState)(""),F=(0,l.default)(C,2),R=F[0],_=F[1],V=(0,u.useState)(!0),E=(0,l.default)(V,2),P=E[0],M=E[1],O=(0,y.useReviewEcontractServices)();(0,u.useEffect)((function(){A()}),[]);var B,A=(B=(0,i.default)((function*(){try{var e={id:"",refId:null,selector:"flow_processing_kyta_erequest_view_contract",lookup:t,attrs:{},payload:JSON.stringify({envelopeId:t}),body:null},n=yield O.getEnvelopeById(e,g);if(n&&"0"===n.code){var r,i,l=null==(r=JSON.parse(null==n?void 0:n.result))?void 0:r.envelope,a=null==(i=JSON.parse(null==n?void 0:n.result))?void 0:i.webviewInfo;if(a&&_(a.iframeUrl),l){var o,u;w(l);var s=null==l||null==(o=l.header)||null==(u=o.fields)?void 0:u.filter((function(e){return"envSubmittedFrom"!==e.id}));D(s)}}}catch(e){}})),function(){return B.apply(this,arguments)}),N=function(e){var t,i,l;return"envName"===e.id?(0,x.jsx)(s.TouchableOpacity,{style:{flex:1},onPress:function(){return r.navigate(f.NavigationName.ViewFileScreenEcontract,{iframeUrl:R})},children:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)(d.default,{style:[m.default.txtValue,{color:"#4583FF",fontWeight:"bold",textDecorationLine:"underline",fontSize:f.FontSize.FontSmall}],children:null!=(i=null==e?void 0:e.value)?i:"---"}),(0,x.jsx)(d.default,{style:{fontSize:f.FontSize.FontTinier,fontStyle:"italic"},children:n("RV.econtract.clickDetail")})]})}):"Date"===e.type||"envDate"===e.id?(0,x.jsx)(d.default,{style:m.default.txtValue,children:null!=(l=c.DateUtils.convertDateToDDMMYYYY_H_M(e.value))?l:"---"}):"Boolean"===e.type?(0,x.jsx)(p.default,{onChange:function(){},checked:"true"===e.value}):(0,x.jsx)(d.default,{style:m.default.txtValue,children:null!=(t=e.value)?t:"---"})};return(0,x.jsxs)(s.View,{style:m.default.ctnMain,children:[(0,x.jsx)(s.View,{children:(0,x.jsxs)(s.Pressable,{style:[m.default.ctnHeader],onPress:function(){return M(!P)},children:[(0,x.jsx)(v.Icon,{fill:"#6F2CED",width:16,height:16,name:P?"arrow-circle-down":"arrow-circle-right"}),(0,x.jsxs)(d.default,{style:m.default.textTitle,children:[n("RV.econtract.infoContract")," ",(0,x.jsx)(d.default,{style:m.default.redDot,children:"*"})]})]})}),P&&(0,x.jsxs)(s.View,{style:m.default.ctnBody,children:[k&&k.map((function(e){return(0,x.jsxs)(s.View,{style:m.default.ctnWrapperItem,children:[(0,x.jsxs)(d.default,{style:m.default.txtTitle,children:[e.name,":"]}),(0,x.jsx)(d.default,{style:m.default.txtValue,children:N(e)})]},e.id)})),(0,x.jsxs)(s.View,{style:m.default.ctnWrapperItem,children:[(0,x.jsxs)(d.default,{style:m.default.txtTitle,children:[n("TK.status"),":"]}),(0,x.jsx)(d.default,{style:m.default.txtValue,children:n(`TK.${null==I?void 0:I.status}`)})]}),"draft"===(null==I?void 0:I.status)&&(0,x.jsx)(s.TouchableOpacity,{onPress:function(){return s.Alert.alert(n("NT.notification.inprocess_noti"))},children:(0,x.jsxs)(d.default,{style:{textAlign:"center"},children:[n("RV.econtract.click")," ",(0,x.jsx)(d.default,{style:m.default.texthere,children:n("RV.econtract.here")})," ",n("RV.econtract.footer")]})})]})]})}},63204:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&{}.hasOwnProperty.call(e,l)){var o=i?Object.getOwnPropertyDescriptor(e,l):null;o&&(o.get||o.set)?Object.defineProperty(r,l,o):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}(n(41995)),l=n(20880);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}t.default=r.StyleSheet.create({ctnMain:{padding:(0,i.SizeDP)(16),backgroundColor:"#F8FAFE"},ctnBody:{backgroundColor:"#fff",padding:(0,i.SizeDP)(10),borderRadius:8},ctnWrapperItem:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",columnGap:(0,i.SizeDP)(16),marginBottom:(0,i.SizeDP)(24)},txtTitle:{fontFamily:l.Font.InterSemiBold600,fontSize:i.default.FontTiny,color:l.Color.colorText,flex:.5},txtValue:{fontFamily:l.Font.InterRegular400,fontSize:i.default.FontTiny,color:"#00204DE5",flex:1},ctnHeader:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:10,padding:10,backgroundColor:"#FFFFFF",borderRadius:8},textTitle:{color:"#00204D",fontSize:14,fontFamily:l.Font.InterMedium500},redDot:{color:"#E14337"},texthere:{color:"#00f",textDecorationLine:"underline"}})},33542:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(29293)),l=r(n(93238)),a=n(20880),o=n(21527),u=n(40851),s=n(12638),d=n(88e3),c=n(47671);t.default=function(e){var t,n,r,f=e.versionForm,p=e.userTaskId,y=e.ticketId,m=(0,o.useRef)(null),h=(0,s.useAppSelector)((function(e){return e.common})).accessToken,v=(0,u.useReviewServices)(),x=(t=(0,i.default)((function*(){var e={userTaskId:p,ticketId:y};return yield v.getFormVersionByTicketAndUserTaskId(e,h)})),function(){return t.apply(this,arguments)}),g=(n=(0,i.default)((function*(e){"e-from"===JSON.parse(e.nativeEvent.data).result&&j()})),function(e){return n.apply(this,arguments)}),j=(r=(0,i.default)((function*(){var e=yield x();if(e){var t=null==e?void 0:e.formData,n=`window.postMessage('${JSON.stringify({type:"postFormEdit",isReadonly:!0,data:t}).replace(/\\/g,"\\\\").replace(/'/g,"\\'")}', '*');`;setTimeout((function(){var e;null==m||null==(e=m.current)||e.injectJavaScript(n)}),800)}})),function(){return r.apply(this,arguments)});return(0,c.jsx)(l.default,{style:{height:500},startInLoadingState:!0,scrollEnabled:!0,nestedScrollEnabled:!0,showsHorizontalScrollIndicator:!1,showsVerticalScrollIndicator:!1,injectedJavaScript:a.String.SCRIPT_SCALE_WEBVIEW,allowsInlineMediaPlayback:!0,mediaPlaybackRequiresUserAction:!1,ref:m,onMessage:g,source:{uri:(0,d.getConfig)().BASE_URL_FORM+f}})}},23392:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(29293)),l=r(n(85715)),a=n(87841),o=n(40851),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=x(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&{}.hasOwnProperty.call(e,l)){var a=i?Object.getOwnPropertyDescriptor(e,l):null;a&&(a.get||a.set)?Object.defineProperty(r,l,a):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}(n(21527)),s=r(n(84148)),d=n(32207),c=r(n(24541)),f=n(20880),p=n(35708),y=r(n(83032)),m=r(n(86933)),h=n(2884),v=n(47671);function x(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(x=function(e){return e?n:t})(e)}t.default=function(e){var t=e.userTaskId,n=e.ticketId,r=(0,h.useTranslation)().t,p=(0,u.useState)(!1),y=(0,l.default)(p,2),m=y[0],x=y[1],S=(0,u.useState)(!1),I=(0,l.default)(S,2),w=I[0],b=I[1],T=(0,u.useState)(!0),k=(0,l.default)(T,2),D=k[0],C=k[1],F=(0,u.useState)(!0),R=(0,l.default)(F,2),_=R[0],V=R[1],E=(0,u.useState)([]),P=(0,l.default)(E,2),M=P[0],O=P[1],B=(0,u.useState)([]),A=(0,l.default)(B,2),N=A[0],L=A[1],z=(0,u.useState)([]),U=(0,l.default)(z,2),H=U[0],G=U[1],W=(0,u.useState)([]),$=(0,l.default)(W,2),Y=$[0],q=$[1],K=(0,u.useState)([]),J=(0,l.default)(K,2),X=J[0],Q=J[1],Z=(0,u.useState)(),ee=(0,l.default)(Z,2),te=ee[0],ne=ee[1],re=(0,u.useState)(""),ie=(0,l.default)(re,2),le=ie[0],ae=ie[1],oe=(0,u.useState)(""),ue=(0,l.default)(oe,2),se=ue[0],de=ue[1],ce=(0,u.useState)(""),fe=(0,l.default)(ce,2),pe=fe[0],ye=fe[1],me=(0,u.useState)(!1),he=(0,l.default)(me,2),ve=he[0],xe=he[1],ge=(0,u.useState)(!1),je=(0,l.default)(ge,2),Se=je[0],Ie=je[1],we=(0,o.useReviewServices)();(0,u.useEffect)((function(){_e()}),[]),(0,u.useEffect)((function(){le&&te&&X.length>0&&De(le)}),[le,te,X]),(0,u.useEffect)((function(){se&&te&&X.length>0&&Ce(se)}),[se,te,X]);var be,Te,ke,De=(be=(0,i.default)((function*(e){try{x(!0);var t=yield Promise.all(X.filter((function(t){return t.includes(e)})).filter((function(e){return e.includes("backSide")||e.includes("frontSide")||e.includes("passport")})).map((function(e){return we.getDataEkycByType(Object.assign({},te,{order:e.split("_")[2],type:e.split("_")[0]+"_"+e.split("_")[1]}))})));t&&L(t)}catch(e){console.log("Error get data id card by trans id",e)}finally{x(!1)}})),function(e){return be.apply(this,arguments)}),Ce=(Te=(0,i.default)((function*(e){try{b(!0);var t=yield Promise.all(X.filter((function(t){return null==t?void 0:t.includes(e)})).filter((function(e){return!e.includes("backSide")&&!e.includes("frontSide")&&!e.includes("passport")})).map((function(e){return we.getDataEkycByType(Object.assign({},te,{order:e.split("_")[2],type:e.split("_")[0]+"_"+e.split("_")[1]}))})));t&&O(t)}catch(e){console.log("Error get data ekyc by trans id",e)}finally{b(!1)}})),function(e){return Te.apply(this,arguments)}),Fe=function(){xe(!ve)},Re=function(){Ie(!Se)},_e=(ke=(0,i.default)((function*(){try{var e={userTaskId:t,tickerId:n},i=yield we.getHistoryEkycDetail(e);if(i){ye(i.ekycRepositoryId);var l=yield we.getEkycRepoById(i.ekycRepositoryId);if(l){var o={ekycRepositoryId:i.ekycRepositoryId,id:l.resourceId,recipientId:l.personalId};ne(o);var u=yield we.getAllTypesOfEkyc(o);if(u){Q(u);var s=u.filter((function(e){return e.includes("backSide")||e.includes("frontSide")||e.includes("passport")})).map((function(e){return e.split("_")[1]})).sort((function(e,t){return e-t})),d=Array.from(new Set(s)).sort((function(e,t){return t.localeCompare(e)}));G(d),ae(d[0]);var c=u.filter((function(e){return!e.includes("backSide")&&!e.includes("frontSide")&&!e.includes("passport")})).map((function(e){return e.split("_")[1]})).sort((function(e,t){return e-t})),f=Array.from(new Set(c)).sort((function(e,t){return t.localeCompare(e)}));q(f),de(f[0])}}else a.Alert.alert(r("CM.noti"),r("RV.eid.no-ekyc"))}}catch(e){}})),function(){return ke.apply(this,arguments)}),Ve=function(e){return N.find((function(t){return null==t?void 0:t[0].type.includes(e)}))};return(0,v.jsxs)(a.View,{children:[(0,v.jsx)(a.View,{style:s.default.ctnBody,children:(0,v.jsxs)(a.View,{style:s.default.ctnSubBody,children:[(0,v.jsxs)(a.View,{style:s.default.ctnOpen,children:[(0,v.jsxs)(a.Pressable,{style:s.default.ctnHeader,onPress:function(){return C(!D)},children:[(0,v.jsx)(d.Icon,{fill:"#6F2CED",width:16,height:16,name:D?"arrow-circle-down":"arrow-circle-right"}),(0,v.jsx)(c.default,{style:s.default.textTitle,children:r("RV.eid.imageId")})]}),(0,v.jsx)(a.View,{style:{},children:(0,v.jsx)(d.OverflowMenu,{anchor:function(){return(0,v.jsx)(a.TouchableOpacity,{onPress:Fe,children:(0,v.jsx)(d.Icon,{width:20,height:20,name:"more-vertical"})})},visible:ve,onBackdropPress:Fe,children:H.map((function(e,t){return(0,v.jsx)(d.MenuItem,{title:r("CM.step")+" "+(H.length-t),accessoryRight:e===le?(0,v.jsx)(d.Icon,{fill:f.Color.BgPrimary,name:"checkmark-outline"}):void 0,onPress:function(){ae(e),Fe()}},e)}))})})]}),D&&(0,v.jsx)(v.Fragment,{children:m?(0,v.jsx)(a.View,{style:s.default.ctnLoading,children:(0,v.jsx)(d.Spinner,{})}):(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(a.View,{style:{paddingHorizontal:10,paddingBottom:10},children:[Ve("frontSide")&&(0,v.jsx)(g,{data:Ve("frontSide"),title:r("RV.eid.frontSide")}),Ve("backSide")&&(0,v.jsx)(g,{data:Ve("backSide"),title:r("RV.eid.backSide")}),Ve("passport")&&(0,v.jsx)(g,{data:Ve("passport"),title:r("RV.eid.passport")})]})})})]})}),(0,v.jsx)(a.View,{style:s.default.ctnBody,children:(0,v.jsxs)(a.View,{style:s.default.ctnSubBody,children:[(0,v.jsxs)(a.View,{style:s.default.ctnOpen,children:[(0,v.jsxs)(a.Pressable,{style:s.default.ctnHeader,onPress:function(){return V(!_)},children:[(0,v.jsx)(d.Icon,{fill:"#6F2CED",width:16,height:16,name:_?"arrow-circle-down":"arrow-circle-right"}),(0,v.jsx)(c.default,{style:s.default.textTitle,children:r("RV.eid.ekycInfo")})]}),(0,v.jsx)(d.OverflowMenu,{anchor:function(){return(0,v.jsx)(a.TouchableOpacity,{onPress:Re,children:(0,v.jsx)(d.Icon,{width:20,height:20,name:"more-vertical"})})},visible:Se,onBackdropPress:Re,children:Y.map((function(e,t){return(0,v.jsx)(d.MenuItem,{title:r("CM.step")+" "+(Y.length-t),accessoryRight:e===se?(0,v.jsx)(d.Icon,{fill:f.Color.BgPrimary,name:"checkmark-outline"}):void 0,onPress:function(){de(e),Re()}},e)}))})]}),_&&(0,v.jsx)(v.Fragment,{children:w?(0,v.jsx)(a.View,{style:s.default.ctnLoading,children:(0,v.jsx)(d.Spinner,{})}):(0,v.jsx)(a.View,{style:{paddingHorizontal:10,paddingBottom:10},children:pe&&se&&(0,v.jsx)(j,{uriVideo:M.filter((function(e){return null==e?void 0:e[0].type.includes("videoEkyc")})).sort((function(e,t){return e[0].order-t[0].order})).map((function(e){return e[0].content})),listData:M.filter((function(e){return!(null!=e&&e[0].type.includes("videoEkyc"))})),ekycRepoId:pe,selectEkycTime:se})})})]})})]})};var g=function(e){var t=e.title,n=e.data,r=(0,h.useTranslation)().t;return(0,v.jsxs)(a.View,{style:s.default.ctnIdCard,children:[(0,v.jsx)(c.default,{style:s.default.textTitleImage,children:t}),(0,v.jsxs)(c.default,{children:[r("RV.eid.uploadTime")," ",p.DateUtils.convertDateToDDMMYYYY_H_M(null==n?void 0:n[0].createdDate)]}),(0,v.jsxs)(a.View,{style:s.default.ctnViewImage,children:[(0,v.jsx)(a.View,{style:{borderRadius:6,overflow:"hidden"},children:(0,v.jsx)(a.Image,{style:{minHeight:100},resizeMode:"contain",source:{uri:f.String.PREFIX_IMG_BASE64+(null==n?void 0:n[0].content)}})}),(0,v.jsx)(c.default,{style:s.default.textImage,children:null==n?void 0:n[0].name})]})]})},j=function(e){var t=e.listData,n=e.uriVideo,r=(e.ekycRepoId,e.selectEkycTime,(0,h.useTranslation)().t),o=(0,u.useState)(null),p=(0,l.default)(o,2),x=p[0],g=p[1],j=(0,u.useState)(!1),S=(0,l.default)(j,2),I=S[0],w=S[1];return(0,u.useEffect)((function(){function e(){return(e=(0,i.default)((function*(){if(n.length>0)try{var e=`temp_video_${Date.now()}.mp4`,t=`${m.default.DocumentDirectoryPath}/${e}`;for(var r of n)yield m.default.appendFile(t,r,"base64");g(`file://${t}`)}catch(e){console.error("Error creating video file:",e)}}))).apply(this,arguments)}return function(){e.apply(this,arguments)}(),function(){try{if(x){var e=x.replace("file://","");m.default.unlink(e).then((function(){return console.log("Temporary file deleted")})).catch((function(e){return console.error("Error deleting temporary file:",e)}))}}catch(e){}}}),[n]),(0,v.jsxs)(a.View,{children:[(0,v.jsx)(c.default,{style:[s.default.textTitleImage,{marginBottom:4}],children:r("RV.eid.videoEkyc")}),(0,v.jsx)(a.View,{style:s.default.ctnVideo,children:x&&(0,v.jsx)(v.Fragment,{children:I?(0,v.jsx)(d.Icon,{width:50,height:50,name:"alert-triangle-outline"}):(0,v.jsx)(y.default,{style:s.default.video,controls:!0,resizeMode:"contain",onError:function(e){console.log(e),w(!0)},source:{uri:x}})})}),(0,v.jsx)(c.default,{style:[s.default.textTitleImage,{marginBottom:4}],children:r("RV.eid.imageEkyc")}),(0,v.jsx)(a.FlatList,{horizontal:!0,contentContainerStyle:{gap:10},data:t,renderItem:function(e){var t=e.item;return(0,v.jsx)(a.Image,{width:85,height:85,source:{uri:f.String.PREFIX_IMG_BASE64+(null==t?void 0:t[0].content)}})}})]})}},84148:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({ctnBody:{backgroundColor:"#F8FAFE",paddingHorizontal:16,paddingTop:16},ctnSubBody:{backgroundColor:"#fff",borderRadius:10},ctnHeader:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:10,padding:10},textTitle:{color:"#00204D",fontSize:14,fontFamily:i.Font.InterMedium500},redDot:{color:"#E14337"},ctnViewImage:{borderWidth:.54,borderColor:"#00358059",borderStyle:"dashed",padding:10,borderRadius:6,rowGap:8},textImage:{fontSize:8,color:"#00204D",fontFamily:i.Font.InterSemiBold600,textAlign:"center"},textKb:{fontSize:7,color:"#00204DB2",fontFamily:i.Font.InterRegular400,textAlign:"center"},textTitleImage:{fontSize:14,color:"#00204D",fontFamily:i.Font.InterSemiBold600},ctnOpen:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},ctnLoading:{alignItems:"center",justifyContent:"center",paddingBottom:10},ctnIdCard:{rowGap:6,marginBottom:6},ctnVideo:{marginBottom:10,width:"100%",height:200},video:{height:200,flex:1}})},94196:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n(87841),l=r(n(24541)),a=r(n(60680)),o=n(2884),u=n(20880),s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=c(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&{}.hasOwnProperty.call(e,l)){var a=i?Object.getOwnPropertyDescriptor(e,l):null;a&&(a.get||a.set)?Object.defineProperty(r,l,a):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}(n(21527)),d=n(47671);function c(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(c=function(e){return e?n:t})(e)}t.default=function(e){var t=e.dataInfo,n=(0,o.useTranslation)().t,r=function(e){var t;return(0,d.jsxs)(i.View,{style:{flex:1,flexDirection:"row"},children:[(0,d.jsx)(i.View,{style:a.default.ctnStatus,children:(0,d.jsx)(l.default,{style:[a.default.txtValue,{color:"#EF5DA8"}],children:n(`TK.${null==e||null==(t=e.value)?void 0:t.status}`)})}),(0,d.jsx)(i.View,{style:{flex:1}})]})};return(0,d.jsx)(i.View,{style:{flex:1},children:t&&t.map((function(e){var t,o,c,f,p,y;return(0,d.jsx)(s.Fragment,{children:(0,d.jsxs)(i.View,{style:[a.default.ctnWrapperItem,"status"===(null==e?void 0:e.type)&&{justifyContent:"flex-start",columnGap:0}],children:[(0,d.jsxs)(l.default,{style:a.default.txtTitle,children:[n(`${e.key}`),":"]}),"normal"===e.type&&(0,d.jsx)(i.View,{style:a.default.ctnNormal,children:e.value.onlyIcon?e.value.onlyIcon:(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.default,{style:a.default.txtValue,children:(null==e||null==(t=e.value)?void 0:t.name)||"---"}),e.value.withIcon&&e.value.withIcon]})}),"avatar"===e.type&&(0,d.jsxs)(i.View,{style:a.default.ctnView,children:[(0,d.jsx)(i.Image,{width:24,height:24,borderRadius:12,source:{uri:null!=e&&null!=(o=e.value)&&o.avatarUrl?null==e||null==(c=e.value)?void 0:c.avatarUrl:"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}),(0,d.jsxs)(i.View,{style:{flex:1},children:[(0,d.jsx)(l.default,{style:a.default.txtValue,children:(null==e||null==(f=e.value)?void 0:f.name)||"---"}),(0,d.jsx)(l.default,{style:a.default.txtValue,children:(null==e||null==(p=e.value)?void 0:p.email)||"---"})]})]}),"status"===e.type&&(0,d.jsx)(d.Fragment,{children:r(e)}),"form"===e.type&&(0,d.jsx)(i.TouchableOpacity,{style:{flex:1},onPress:e.value.funcViewFrom,children:e.value?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.default,{style:[a.default.txtValue,a.default.formName],children:(null==(y=e.value)?void 0:y.name)||"---"}),(0,d.jsx)(l.default,{style:{fontSize:u.FontSize.FontTinier,fontStyle:"italic"},children:n("RV.fromViewDetail")})]}):(0,d.jsx)(l.default,{style:a.default.txtValue,children:"---"})})]})},e.key)}))})}},60680:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({ctnWrapperItem:{flexDirection:"row",alignItems:"flex-start",justifyContent:"space-between",columnGap:16,marginTop:16},txtTitle:{fontFamily:i.Font.InterSemiBold600,fontSize:i.FontSize.FontTiny,color:i.Color.colorText,flex:.7,lineHeight:20},txtValue:{fontFamily:i.Font.InterRegular400,fontSize:i.FontSize.FontTiny,color:"#00204DE5",flex:1,lineHeight:16},ctnView:{flexDirection:"row",columnGap:6,alignItems:"center",justifyContent:"flex-start",flex:1},ctnStatus:{paddingHorizontal:8,paddingVertical:4,borderRadius:4,backgroundColor:"#EF5DA81A"},formName:{color:"#4583FF",fontWeight:"bold",textDecorationLine:"underline",fontSize:i.FontSize.FontSmall},ctnNormal:{flexDirection:"row",alignItems:"center",flex:1}})},46542:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(41132)),l=r(n(29293)),a=r(n(85715)),o=n(87841),u=r(n(24541)),s=n(2884),d=r(n(71606)),c=r(n(43184)),f=n(32207),p=n(46317),y=n(12638),m=n(60596),h=n(11671),v=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=I(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&{}.hasOwnProperty.call(e,l)){var a=i?Object.getOwnPropertyDescriptor(e,l):null;a&&(a.get||a.set)?Object.defineProperty(r,l,a):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}(n(21527)),x=n(20880),g=n(35708),j=r(n(94196)),S=n(47671);function I(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(I=function(e){return e?n:t})(e)}t.default=function(e){var t=e.onClose,n=(0,s.useTranslation)().t,r=(0,v.useState)([]),I=(0,a.default)(r,2),w=(I[0],I[1]),b=(0,v.useState)(!1),T=(0,a.default)(b,2),k=T[0],D=T[1],C=(0,v.useState)({}),F=(0,a.default)(C,2),R=F[0],_=F[1],V=(0,v.useState)([]),E=(0,a.default)(V,2),P=(E[0],E[1]),M=(0,v.useState)([]),O=(0,a.default)(M,2),B=O[0],A=O[1],N=(0,v.useState)(!1),L=(0,a.default)(N,2),z=L[0],U=L[1],H=(0,v.useState)({}),G=(0,a.default)(H,2),W=G[0],$=G[1],Y=(0,y.useAppSelector)((function(e){return e.ticket})),q=Y.dataListRecipientsSLA,K=Y.dataTicketRedux,J=Y.recipientDetaiImpl,X=(0,y.useAppSelector)((function(e){return e.common})).accessToken,Q=(0,y.useAppSelector)((function(e){return e.account})).dataAccount,Z=(0,h.useTicketServices)(),ee=function(){return U(!z)};(0,v.useEffect)((function(){ie()}),[]);var te,ne,re,ie=(te=(0,l.default)((function*(){var e=null==q?void 0:q.filter((function(e,t,n){return t===n.findIndex((function(t){return t.recipientId===e.recipientId}))})),t=null==e?void 0:e.map((function(e){return{notionName:e.notionName?e.notionName:"User task",recipientId:e.recipientId,status:e.status,startDate:e.startDate,finishDate:e.finishDate,role:e.role,delayTime:e.delayTime,estimateDate:e.estimateDate,totalTime:e.totalTime,statusSla:se(e),totalTimeExpect:e.totalTimeExpect}})),n=yield oe();if(n){var r=J.map((function(e){var t=n.find((function(t){return t.email===e.recipient.contact.email}));return t?Object.assign({},e,{avatar:t.imageUrl,firstName:t.firstName,lastName:t.lastName,personalName:t.personalName}):e}));t=t.map((function(e){var t=r.filter((function(t){return t.userTaskId===e.recipientId&&t.recipientStatus}))[0],n=r.filter((function(t){return t.userTaskId===e.recipientId&&"active"===t.status}));return Object.assign({},e,{executor:t,executorList:n})})),A(t)}var i=yield ue();i&&t.forEach((function(e){$((function(t){var n=Object.assign({},t);return n[null==e?void 0:e.recipientId]=le(null==e?void 0:e.executorList,e.recipientId,i),n}))}))})),function(){return te.apply(this,arguments)}),le=function(e,t,n){var r=J.some((function(e){return e.recipient.contact.email===Q.email&&e.userTaskId===t})),i=e.some((function(e){return e.recipient.contact.email===Q.email}));return!(n.some((function(e){return e.personal.email===Q.email&&(e.userTaskId===t||!e.userTaskId)}))||r||i)},ae=function(e){return"eID"===e?n("RV.notionName.eID"):"eContract"===e?n("RV.notionName.eContract"):e||n("RV.notionName.userTask")},oe=(ne=(0,l.default)((function*(){try{var e=J.map((function(e){return e.recipient.contact.email}));if(e){var t=yield Z.getMultiLoginAccount(Array.from(new Set(e)),X);if(t)return w(t),t}}catch(e){}})),function(){return ne.apply(this,arguments)}),ue=(re=(0,l.default)((function*(){var e=J.map((function(e){return e.userTaskId})),t={resourceId:K.id,email:Q.email||"",userTaskIds:(0,i.default)(new Set(e)),orgIn:Q.orgIn||""},n=yield Z.getAclTicketByListUserTask(t);if(n)return P(n),n})),function(){return re.apply(this,arguments)}),se=function(e){var t,n;return K.ticketStatus===m.Status.voided&&e.status==m.Status.processing?"stopped":K.ticketStatus===m.Status.rejected?"rejected":(e.finishDate&&e.estimateDate&&(t=new Date(e.finishDate),n=new Date(e.estimateDate)),"accepted"==e.status&&e.delayTime?"done_late":"accepted"==e.status&&e.estimateDate?"done_onTime":"accepted"==e.status&&e.finishDate&&e.estimateDate&&t<n?"done_before":e.status)},de=function(){var e,t,n,r,i,l;if(null!=R&&R.executor)return{key:"RV.userAction",type:"avatar",value:{name:(null==(e=R.executor)?void 0:e.personalName)||"---",email:(null==(t=R.executor)||null==(n=t.recipient)||null==(r=n.contact)?void 0:r.email)||"---",avatarUrl:null==(i=R.executor)?void 0:i.avatar}};if(R.executorList){var a;if((null==R||null==(a=R.executorList)?void 0:a.length)>1)return{key:"RV.userAction",type:"normal",value:{onlyIcon:(l=null==R?void 0:R.executorList,(0,S.jsx)(o.Pressable,{style:d.default.ctnListUser,children:null==l?void 0:l.map((function(e,t){return(0,S.jsx)(S.Fragment,{children:t<=1?(0,S.jsx)(o.Image,{style:{position:"absolute",left:20*t},width:28,height:28,borderRadius:14,source:{uri:(null==e?void 0:e.avatar)||x.String.DEFAULT_IMAGE}},t):(0,S.jsx)(o.View,{style:d.default.ctnAdd,children:(0,S.jsx)(u.default,{children:"+"+((null==l?void 0:l.length)-2)})},t)})}))}))}};var s,c,f=null==R?void 0:R.executorList[0];return{key:"RV.userAction",type:"avatar",value:{name:(null==f?void 0:f.personalName)||"---",email:(null==f||null==(s=f.recipient)||null==(c=s.contact)?void 0:c.email)||"---",avatarUrl:null==f?void 0:f.avatar}}}},ce=(0,v.useMemo)((function(){return[de(),{key:"HM.statusTicket",type:"status",value:{status:null==R?void 0:R.statusSla}},{key:"RV.startDate",type:"normal",value:{name:g.DateUtils.convertDateToDDMMYYYY_H_M(null==R?void 0:R.startDate)}},{key:"RV.totalTimeExpect",type:"normal",value:{name:null==R?void 0:R.totalTimeExpect}},{key:"RV.estimateDate",type:"normal",value:{name:g.DateUtils.convertDateToDDMMYYYY_H_M(null==R?void 0:R.estimateDate)}},{key:"RV.finishDate",type:"normal",value:{name:g.DateUtils.convertDateToDDMMYYYY_H_M(null==R?void 0:R.finishDate)}}]}),[R]),fe=function(e){return e===m.Status.rejected?{fill:"#e14437",icon:"close-circle",bgColor:"#fdeded",borderColor:"#e14437"}:e===m.Status.processing?{fill:"#FC6B03",icon:"alert-triangle",bgColor:"#FFF3EB",borderColor:"#e14437"}:{fill:"#39AC6D",icon:"checkmark-circle-2",bgColor:"#E8F7EF",borderColor:"#fff"}};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(c.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:n("RV.listStep"),contentStyle:{backgroundColor:"#fff"},onPressIconLeft:t}),(0,S.jsx)(o.FlatList,{style:{backgroundColor:"#F8FAFE"},data:B,renderItem:function(e){var t,r,i=e.item,l=e.index;return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)(o.View,{style:d.default.ctnItem,children:[(0,S.jsxs)(o.View,{style:d.default.ctnIcon,children:[(0,S.jsx)(f.Icon,{fill:fe(i.status).fill,name:fe(i.status).icon,width:24,height:24}),(0,S.jsx)(o.View,{style:[d.default.tabHoz,q.length-1===l&&{backgroundColor:"#F8FAFE"}]})]}),(0,S.jsxs)(o.View,{style:{flex:1},children:[(0,S.jsxs)(o.View,{style:[d.default.ctnBody,{borderColor:fe(i.status).borderColor,opacity:W[i.recipientId]?.5:1}],children:[(0,S.jsx)(u.default,{style:d.default.textNotion,children:ae(i.notionName)}),W[i.recipientId]&&(0,S.jsx)(u.default,{style:d.default.textNote,children:n("RV.author")}),(0,S.jsxs)(o.View,{style:{flexDirection:"row",alignItems:"center",justifyContent:"space-between"},children:[(0,S.jsxs)(o.View,{style:d.default.ctnEmail,children:[i.executor&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(f.Avatar,{size:"small",source:{uri:(null==(t=i.executor)?void 0:t.avatar)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}}),(0,S.jsx)(u.default,{style:d.default.textEmail,children:null==(r=i.executor)?void 0:r.recipient.contact.email})]}),!i.executor&&i.executorList&&(0,S.jsxs)(o.Pressable,{onPress:function(){ee(),_(i)},style:{position:"relative",flexDirection:"row",alignItems:"center"},children:[i.executorList.map((function(e,t){return(0,S.jsx)(S.Fragment,{children:t<=1&&(0,S.jsx)(f.Avatar,{style:{position:"absolute",left:20*t},size:"small",source:{uri:(null==e?void 0:e.avatar)||"https://static.vecteezy.com/system/resources/previews/009/292/244/original/default-avatar-icon-of-social-media-user-vector.jpg"}},t)})})),i.executorList.length>2&&(0,S.jsx)(o.View,{style:d.default.ctnMoreAvatar,children:(0,S.jsx)(u.default,{children:"+"+(i.executorList.length-2)})})]})]}),(0,S.jsx)(o.TouchableOpacity,{onPress:function(){W[i.recipientId]||(_(i),D(!0))},style:[d.default.ctnIconClick,{backgroundColor:fe(i.status).bgColor}],children:i.status!==m.Status.processing?(0,S.jsx)(p.IconPersonTime,{width:15,height:15}):(0,S.jsx)(p.IconPersonTimeWait,{width:15,height:15})})]})]}),i.status===m.Status.processing&&(0,S.jsx)(u.default,{style:d.default.textNote,children:n("RV.descriptionProcessing")})]})]})})}}),(0,S.jsx)(f.Modal,{animationType:"fade",backdropStyle:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onBackdropPress:function(){return D(!1)},visible:k,style:{width:"90%"},children:(0,S.jsx)(f.Card,{style:{},header:(0,S.jsx)(u.default,{style:d.default.txtTitle,children:ae(null==R?void 0:R.notionName)}),disabled:!0,children:(0,S.jsx)(j.default,{dataInfo:ce})})}),(0,S.jsx)(f.Modal,{animationType:"fade",backdropStyle:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onBackdropPress:ee,visible:z,style:{width:"90%"},children:(0,S.jsx)(f.Card,{style:{},header:(0,S.jsx)(u.default,{style:d.default.txtTitle,children:"List user"}),disabled:!0,children:(0,S.jsx)(o.FlatList,{data:R.executorList,renderItem:function(e){var t,n,r=e.item;return(0,S.jsxs)(o.View,{style:d.default.ctnView,children:[(0,S.jsx)(o.Image,{width:24,height:24,borderRadius:12,source:{uri:r.avatar||x.String.DEFAULT_IMAGE}}),(0,S.jsx)(o.View,{style:{flex:1},children:(0,S.jsx)(u.default,{style:d.default.txtValue,children:(null==r||null==(t=r.recipient)||null==(n=t.contact)?void 0:n.email)||"---"})})]})}})})})]})}},71606:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({tabHoz:{width:2,height:40,backgroundColor:"rgba(0, 53, 128, 0.15)"},ctnItem:{paddingHorizontal:16,paddingVertical:8,flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:16},ctnAction:{width:24,height:24,backgroundColor:"blue",borderRadius:12,justifyContent:"center",alignItems:"center"},ctnIcon:{alignItems:"center",justifyContent:"center",rowGap:8},ctnBody:{backgroundColor:"#fff",paddingHorizontal:12,paddingVertical:10,flex:1,borderRadius:8,rowGap:10,borderWidth:1},textNotion:{fontSize:13,fontFamily:i.Font.InterSemiBold600,color:"#00204D"},textNote:{fontSize:11,fontFamily:i.Font.InterRegular400,color:"#E14337",marginTop:3,fontStyle:"italic"},ctnIconClick:{width:24,height:24,borderRadius:12,alignItems:"center",justifyContent:"center"},textEmail:{fontSize:12,fontFamily:i.Font.InterRegular400,color:"#00204DF2"},ctnEmail:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:4},ctnListUser:{flexDirection:"row",position:"relative"},ctnAdd:{position:"absolute",left:40,width:28,height:28,borderRadius:14,backgroundColor:"#F4F4F4",justifyContent:"center",alignItems:"center"},txtValue:{fontFamily:i.Font.InterRegular400,fontSize:i.FontSize.FontTiny,color:"#00204DE5",flex:1,lineHeight:16},ctnView:{flexDirection:"row",columnGap:6,alignItems:"center",justifyContent:"flex-start",flex:1,marginBottom:16},ctnMoreAvatar:{position:"absolute",left:40,width:35,height:35,borderRadius:25,alignItems:"center",justifyContent:"center",backgroundColor:"#f3f5f8"},txtTitle:{fontSize:16,color:"#00204D",fontFamily:i.Font.InterSemiBold600}})},72060:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.listNoti=void 0;t.listNoti=[{label:"QR Code",value:"qr"},{label:"Email",value:"email"},{label:"SMS",value:"sms"}]},166:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(43693)),l=r(n(29293)),a=r(n(85715)),o=n(7005),u=r(n(43184)),s=n(32207),d=n(46317),c=n(87841),f=r(n(24541)),p=r(n(12398)),y=r(n(94516)),m=n(2884),h=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=L(t);if(n&&n.has(e))return n.get(e);var r={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var l in e)if("default"!==l&&{}.hasOwnProperty.call(e,l)){var a=i?Object.getOwnPropertyDescriptor(e,l):null;a&&(a.get||a.set)?Object.defineProperty(r,l,a):r[l]=e[l]}return r.default=e,n&&n.set(e,r),r}(n(21527)),v=r(n(54813)),x=n(26878),g=r(n(65963)),j=n(72060),S=r(n(94196)),I=r(n(27747)),w=n(2543),b=r(n(76644)),T=r(n(46542)),k=n(12638),D=n(35708),C=n(40851),F=n(14740),R=r(n(77389)),_=r(n(194)),V=n(60596),E=n(97427),P=r(n(33542)),M=r(n(23392)),O=r(n(27163)),B=n(88e3),A=n(11671),N=n(47671);function L(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(L=function(e){return e?n:t})(e)}var z=function(e){return e.name="name",e.phone="phone",e.email="email",e.notiType="notiType",e}(z||{});t.default=function(){var e,t,n=(0,m.useTranslation)().t,r=(0,F.useRoute)(),L=(0,k.useAppDispatch)(),U=null!=(e=null==r||null==(t=r.params)?void 0:t.dataUserTask)?e:{},H=(0,F.useNavigation)(),G=(0,h.useState)(!1),W=(0,a.default)(G,2),$=W[0],Y=W[1],q=(0,h.useState)(!0),K=(0,a.default)(q,2),J=K[0],X=K[1],Q=(0,h.useState)([new s.IndexPath(0)]),Z=(0,a.default)(Q,2),ee=Z[0],te=Z[1],ne=(0,h.useState)({}),re=(0,a.default)(ne,2),ie=re[0],le=re[1],ae=(0,h.useState)({}),oe=(0,a.default)(ae,2),ue=oe[0],se=oe[1],de=(0,h.useState)(!1),ce=(0,a.default)(de,2),fe=ce[0],pe=ce[1],ye=(0,h.useState)(!1),me=(0,a.default)(ye,2),he=me[0],ve=me[1],xe=(0,h.useState)(""),ge=(0,a.default)(xe,2),je=ge[0],Se=ge[1],Ie=(0,h.useState)(""),we=(0,a.default)(Ie,2),be=we[0],Te=we[1],ke=(0,h.useState)(!1),De=(0,a.default)(ke,2),Ce=De[0],Fe=De[1],Re=(0,h.useState)(!0),_e=(0,a.default)(Re,2),Ve=_e[0],Ee=_e[1],Pe=(0,h.useState)(""),Me=(0,a.default)(Pe,2),Oe=Me[0],Be=Me[1],Ae=(0,h.useState)(null),Ne=(0,a.default)(Ae,2),Le=Ne[0],ze=Ne[1],Ue=(0,k.useAppSelector)((function(e){return e.ticket})),He=Ue.dataTicketRedux,Ge=Ue.recipientDetaiImpl,We=Ue.formData,$e=Ue.modeler,Ye=(0,h.useState)(null==Ge?void 0:Ge.find((function(e){return e.userTaskId===(null==U?void 0:U._userTaskId)}))),qe=(0,a.default)(Ye,1)[0],Ke=((0,k.useAppSelector)((function(e){return e.account})).dataAccount,(0,k.useAppSelector)((function(e){return e.common})).accessToken),Je=(0,C.useReviewServices)(),Xe=(0,A.useTicketServices)(),Qe=(0,h.useMemo)((function(){return[{key:"RV.createBy",type:"avatar",value:{name:(null==Le?void 0:Le.personalName)||"---",email:He.createdBy||"---",avatarUrl:null==Le?void 0:Le.imageUrl}},{key:"RV.ticketName",type:"normal",value:{name:(null==He?void 0:He.title)||"---"}},{key:"RV.process",type:"normal",value:{name:(null==He?void 0:He.jsonXml)&&JSON.parse(null==He?void 0:He.jsonXml).properties.name||"---"}},{key:"RV.createDate",type:"normal",value:{name:D.DateUtils.convertDateToDDMMYYYY_H_M(null==He?void 0:He.createdDate)}},{key:"RV.infoForm",type:"form",value:{name:null==We?void 0:We.formName,funcViewFrom:function(){return ve(!0)}}},{key:"RV.status",type:"status",value:{status:He.ticketStatus===V.Status.voided?V.Status.voided:(null==qe?void 0:qe.recipientStatus)||V.Status.processing}}]}),[He,We,$e,Le]);(0,h.useEffect)((function(){tt()}),[]),(0,h.useEffect)((function(){var e=ie;0===ee.length?e[`${z.notiType}`]="CM.empty":delete e[`${z.notiType}`],le((function(t){return Object.assign({},t,e)}))}),[ee]);var Ze,et,tt=(Ze=(0,l.default)((function*(){try{var e=yield Xe.getMultiLoginAccount([He.createdBy]);e&&e.length>0&&ze(e[0]),console.log("user",e)}catch(e){}})),function(){return Ze.apply(this,arguments)}),nt=function(e,t){null!=t&&t.trim()?e!==z.email||D.RegexUtils.FORMAT_EMAIL.test(t)?e!==z.phone||D.RegexUtils.REGEX_PHONE_NUMBER_9.test(t)?le((function(t){var n=Object.assign({},t);return delete n[e],n})):le((function(t){return Object.assign({},t,(0,i.default)({},e,"CM.validPhone"))})):le((function(t){return Object.assign({},t,(0,i.default)({},e,"CM.validEmail"))})):le((function(t){return Object.assign({},t,(0,i.default)({},e,"CM.empty"))})),se((function(n){var r,l,a,o=Object.assign({},n,(0,i.default)({},e,t));return(0,w.isEmpty)(ie)&&null!=(r=o[z.email])&&r.trim()&&null!=(l=o[z.phone])&&l.trim()&&null!=(a=o[z.name])&&a.trim()?pe(!0):pe(!1),o}))},rt=(et=(0,l.default)((function*(e){try{if("reject"===e){if(!je)return Ee(!0),void Te("CM.empty");Te("");var t=Object.assign({},null==qe?void 0:qe.recipient,{reason:je});(yield Je.actionTicket(null==qe?void 0:qe.id,null==qe?void 0:qe.ticketId,null==qe?void 0:qe.userTaskId,t,Ke,"reject"))?(R.default.show({type:"success",text1:n("CM.noti"),text2:n("CM.rejectSucesss")}),L(E.ticketActions.setDataTicket(Object.assign({},He,{ticketStatus:V.Status.rejected}))),H.goBack()):R.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.rejectFailed")})}else{var r={name:null==$e?void 0:$e.mailTemplate},i=ee.map((function(e){return j.listNoti[e.row].value})).join(","),l={ticketId:He.id,userTaskId:null==U?void 0:U._userTaskId,recipientDetailsId:null==U?void 0:U._recipientDetailsId,fullName:ue[z.name],phoneNumber:ue[z.phone],email:ue[z.email],notifyType:i},a=yield Je.createPersonalEkyc({personalName:ue[z.name],telephoneNumber:ue[z.phone],email:ue[z.email],messageType:i,resourceType:"internal",recipientDetailId:null==U?void 0:U._recipientDetailsId,identifierType:"2",ticketId:He.id,userTaskId:null==U?void 0:U._userTaskId,usesContent:{},syncToPartner:"0",versionId:null==$e?void 0:$e.formVersion,formId:null==We?void 0:We.formId},r);a&&((yield Je.createInformationOCR(l))?(R.default.show({type:"success",text1:n("CM.noti"),text2:n("RV.eid.submitSuccess")}),Be(a.urlSuffix)):R.default.show({type:"error",text1:n("CM.noti"),text2:n("RV.eid.submitError")}))}}catch(t){"reject"===e?R.default.show({type:"error",text1:n("CM.noti"),text2:n("CM.rejectFailed")}):R.default.show({type:"error",text1:n("CM.noti"),text2:n("RV.eid.submitError")})}})),function(e){return et.apply(this,arguments)}),it=function(){return null!==(null==qe?void 0:qe.recipientStatus)&&(null==qe?void 0:qe.recipientStatus)!==V.Status.processing},lt=function(){return(null==qe?void 0:qe.recipientStatus)===V.Status.completed||(null==qe?void 0:qe.recipientStatus)===V.Status.accepted};return(0,N.jsxs)(o.SafeAreaView,{style:{flex:1,backgroundColor:"#fff"},edges:["bottom"],children:[(0,N.jsx)(u.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:n("RV.eid.idPerson"),contentStyle:{backgroundColor:"#fff"},renderContentRight:function(){return(0,N.jsx)(s.TopNavigationAction,{onPress:function(){return Fe(!0)},icon:(0,N.jsx)(d.IconWorkflow,{width:20,height:20})})}}),(0,N.jsxs)(x.KeyboardAwareScrollView,{children:[(0,N.jsx)(c.View,{style:p.default.ctnBody,children:(0,N.jsxs)(c.View,{style:p.default.ctnSubBody,children:[(0,N.jsxs)(c.Pressable,{style:p.default.ctnHeader,onPress:function(){return Y(!$)},children:[(0,N.jsx)(s.Icon,{fill:"#6F2CED",width:16,height:16,name:$?"arrow-circle-down":"arrow-circle-right"}),(0,N.jsx)(f.default,{style:p.default.textTitle,children:n("CM.infoCommon")})]}),$&&(0,N.jsx)(c.View,{style:{paddingHorizontal:10,paddingBottom:10},children:(0,N.jsx)(S.default,{dataInfo:Qe})})]})}),(0,N.jsx)(c.View,{style:p.default.ctnBody,children:(0,N.jsxs)(c.View,{style:[p.default.ctnSubBody,it()&&{marginBottom:16}],children:[(0,N.jsxs)(c.Pressable,{style:[p.default.ctnHeader],onPress:function(){return X(!J)},children:[(0,N.jsx)(s.Icon,{fill:"#6F2CED",width:16,height:16,name:J?"arrow-circle-down":"arrow-circle-right"}),(0,N.jsxs)(f.default,{style:p.default.textTitle,children:[n("RV.eid.infoPerson")," ",(0,N.jsx)(f.default,{style:p.default.redDot,children:"*"})]})]}),J&&(0,N.jsxs)(c.View,{style:p.default.ctnInput,children:[!it()&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(v.default,{isRequired:!0,label:n("RV.eid.name"),placeholder:n("RV.eid.fillName"),value:ue[`${z.name}`],onChangeText:function(e){return nt(z.name,e)},captionText:n(ie[`${z.name}`]),status:ie[`${z.name}`]?"danger":"basic",type:z.name}),(0,N.jsx)(v.default,{isRequired:!0,label:n("RV.eid.phone"),placeholder:n("RV.eid.fillPhone"),value:ue[`${z.phone}`],onChangeText:function(e){return nt(z.phone,e)},captionText:n(ie[z.phone]),status:ie[`${z.phone}`]?"danger":"basic",type:z.phone,keyBoardType:"numeric"}),(0,N.jsx)(v.default,{isRequired:!0,label:"Email",placeholder:n("RV.eid.fillEmail"),value:ue[`${z.email}`],onChangeText:function(e){return nt(z.email,e)},captionText:n(ie[`${z.email}`]),status:ie[`${z.email}`]?"danger":"basic",type:z.email}),(0,N.jsx)(g.default,{onSelect:te,valueSelect:ee,placeholder:n("RV.eid.fill-notify-type"),label:n("RV.eid.notify-type"),isRequired:!0,size:"medium",listData:j.listNoti,multiple:!0,caption:n(ie[`${z.notiType}`]),status:ie[`${z.notiType}`]?"danger":"primary"}),Oe&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(f.default,{style:p.default.title,children:n("RV.eid.qr")}),(0,N.jsx)(c.View,{style:p.default.ctnQr,children:(0,N.jsx)(_.default,{onError:function(e){return console.log(e)},value:(0,B.getConfig)().BASE_URL_EKYC+Oe})})]})]}),lt()&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(s.Divider,{style:{height:3}}),(0,N.jsx)(P.default,{ticketId:He.id,userTaskId:null==qe?void 0:qe.userTaskId,versionForm:null==qe?void 0:qe.versionFormId})]})]})]})}),lt()&&(0,N.jsx)(M.default,{ticketId:He.id,userTaskId:null==qe?void 0:qe.userTaskId}),!it()&&(0,N.jsx)(c.View,{style:p.default.ctnBody,children:(0,N.jsxs)(c.View,{style:[p.default.ctnSubBody,{marginBottom:16}],children:[(0,N.jsxs)(c.Pressable,{style:p.default.ctnHeader,onPress:function(){return Ee(!Ve)},children:[(0,N.jsx)(s.Icon,{fill:"#6F2CED",width:16,height:16,name:Ve?"arrow-circle-down":"arrow-circle-right"}),(0,N.jsx)(f.default,{style:p.default.textTitle,children:n("CM.note")})]}),Ve&&(0,N.jsx)(c.View,{style:{paddingHorizontal:10,paddingBottom:10,rowGap:4},children:(0,N.jsx)(I.default,{isRequired:!0,label:n("CM.fillNote"),value:je,onChangeText:function(e){Se(e),Te("")},multiline:!0,maxLength:400,errorMessage:n(be)})})]})})]}),(0,N.jsx)(c.View,{style:p.default.ctnFooter,children:!it()&&He.ticketStatus!==V.Status.voided&&He.ticketStatus!==V.Status.rejected&&(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(c.TouchableOpacity,{onPress:function(){return rt("reject")},children:(0,N.jsx)(d.IconRejectReview,{width:36,height:36})}),(0,N.jsx)(y.default,{disabled:!(0,w.isEmpty)(ie)||!fe,style:{flex:1},label:n("CM.confirm"),onPress:function(){return rt("finish")}})]})}),(0,N.jsx)(b.default,{isVisible:Ce,children:(0,N.jsx)(T.default,{onClose:function(){return Fe(!1)}})}),(0,N.jsx)(b.default,{isVisible:he,children:(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(c.View,{style:{flex:1},children:(0,N.jsx)(O.default,{})}),(0,N.jsx)(y.default,{style:{backgroundColor:"#f2ecfd",marginHorizontal:16},styleLabel:{color:"#6d1fad"},label:n("CM.back"),onPress:function(){return ve(!1)}})]})})]})}},12398:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(20880);t.default=r.StyleSheet.create({ctnBody:{backgroundColor:"#F8FAFE",paddingHorizontal:16,paddingTop:16},ctnSubBody:{backgroundColor:"#fff",borderRadius:10},ctnHeader:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:10,padding:10},textTitle:{color:"#00204D",fontSize:14,fontFamily:i.Font.InterMedium500},redDot:{color:"#E14337"},ctnFooter:{flexDirection:"row",paddingHorizontal:16,columnGap:16,marginTop:8},ctnInput:{gap:10,padding:10},title:{fontSize:12,fontFamily:i.Font.InterMedium500,color:"#00204DF2"},ctnQr:{alignItems:"center",justifyContent:"center"}})},92552:function(e,t,n){var r=n(24994);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(41132)),l=r(n(29293)),a=r(n(85715)),o=n(7005),u=r(n(43184)),s=n(87841),d=r(n(94516)),c=n(46317),f=r(n(89052)),p=n(21527),y=n(41995),m=n(14740),h=n(12638),v=n(19867),x=n(2884),g=n(40851),j=n(32207),S=r(n(76644)),I=r(n(46542)),w=n(35708),b=n(60596),T=n(26878),k=r(n(24541)),D=r(n(94196)),C=r(n(27163)),F=r(n(27747)),R=n(31004),_=r(n(77389)),V=n(97427),E=r(n(93183)),P=r(n(85077)),M=n(11671),O=r(n(55529)),B=r(n(39284)),A=n(47671);t.default=function(){var e,t,n=(0,m.useRoute)(),r=(0,x.useTranslation)().t,N=(0,h.useAppDispatch)(),L=(0,m.useNavigation)(),z=null!=(e=null==n||null==(t=n.params)?void 0:t.dataUserTask)?e:{},U=(0,p.useState)(),H=(0,a.default)(U,2),G=H[0],W=H[1],$=(0,p.useState)(!1),Y=(0,a.default)($,2),q=Y[0],K=Y[1],J=(0,p.useState)(!1),X=(0,a.default)(J,2),Q=X[0],Z=X[1],ee=(0,p.useState)(!0),te=(0,a.default)(ee,2),ne=te[0],re=te[1],ie=(0,p.useState)(!1),le=(0,a.default)(ie,2),ae=le[0],oe=le[1],ue=(0,p.useState)(!0),se=(0,a.default)(ue,2),de=se[0],ce=se[1],fe=(0,p.useState)(!0),pe=(0,a.default)(fe,2),ye=pe[0],me=pe[1],he=(0,p.useState)(!1),ve=(0,a.default)(he,2),xe=ve[0],ge=ve[1],je=(0,p.useState)(!0),Se=(0,a.default)(je,2),Ie=Se[0],we=Se[1],be=(0,p.useState)(""),Te=(0,a.default)(be,2),ke=Te[0],De=Te[1],Ce=(0,p.useState)(""),Fe=(0,a.default)(Ce,2),Re=Fe[0],_e=Fe[1],Ve=(0,p.useState)([]),Ee=(0,a.default)(Ve,2),Pe=Ee[0],Me=Ee[1],Oe=(0,p.useState)([]),Be=(0,a.default)(Oe,2),Ae=Be[0],Ne=Be[1],Le=(0,p.useState)(!1),ze=(0,a.default)(Le,2),Ue=ze[0],He=ze[1],Ge=(0,p.useState)(!1),We=(0,a.default)(Ge,2),$e=We[0],Ye=We[1],qe=(0,p.useState)(null),Ke=(0,a.default)(qe,2),Je=Ke[0],Xe=Ke[1],Qe=(0,h.useAppSelector)((function(e){return e.common})).accessToken,Ze=(0,h.useAppSelector)((function(e){return e.ticket})),et=Ze.dataTicketRedux,tt=Ze.formData,nt=Ze.modeler,rt=Ze.recipientDetaiImpl,it=((0,h.useAppSelector)((function(e){return e.account})).dataAccount,(0,g.useReviewServices)()),lt=(0,R.useReviewEcontractServices)(),at=(0,M.useTicketServices)(),ot=(0,p.useState)(null==rt?void 0:rt.find((function(e){return e.userTaskId===(null==z?void 0:z._userTaskId)}))),ut=(0,a.default)(ot,1)[0],st=(0,p.useMemo)((function(){return[{key:"RV.createBy",type:"avatar",value:{name:(null==Je?void 0:Je.personalName)||"---",email:et.createdBy||"---",avatarUrl:null==Je?void 0:Je.imageUrl}},{key:"RV.ticketName",type:"normal",value:{name:(null==et?void 0:et.title)||"---"}},{key:"RV.process",type:"normal",value:{name:(null==et?void 0:et.jsonXml)&&JSON.parse(null==et?void 0:et.jsonXml).properties.name||"---"}},{key:"RV.createDate",type:"normal",value:{name:w.DateUtils.convertDateToDDMMYYYY_H_M(null==et?void 0:et.createdDate)}},{key:"RV.infoForm",type:"form",value:{name:null==tt?void 0:tt.formName,funcViewFrom:function(){return Z(!0)}}},{key:"RV.status",type:"status",value:{status:et.ticketStatus===b.Status.voided?b.Status.voided:(null==ut?void 0:ut.recipientStatus)||b.Status.processing}}]}),[et,tt,nt,Je]);(0,p.useEffect)((function(){vt(),It(),xt()}),[]);var dt,ct,ft,pt,yt,mt,ht,vt=(dt=(0,l.default)((function*(){try{var e=yield lt.getDataFormFill({versionId:ut.versionFormId});e&&W(e)}catch(e){}})),function(){return dt.apply(this,arguments)}),xt=(ct=(0,l.default)((function*(){try{var e=yield at.getMultiLoginAccount([et.createdBy]);e&&e.length>0&&Xe(e[0]),console.log("user",e)}catch(e){}})),function(){return ct.apply(this,arguments)}),gt=(ft=(0,l.default)((function*(e){if(e||null==G||!G.versionId){if(Pe.length>0&&!(yield jt(Pe)))return;try{He(!0);var t=Object.assign({},ut.recipient,{reason:ke});(yield it.actionTicket(ut.id,ut.ticketId,ut.userTaskId,t,Qe,"finish"))?(_.default.show({type:"success",text1:r("CM.noti"),text2:r("CM.actionUserStaskSuccess")}),L.goBack()):_.default.show({type:"error",text1:r("CM.noti"),text2:r("CM.actionUserStaskFailure")})}catch(e){}finally{He(!1)}}else oe(!0)})),function(e){return ft.apply(this,arguments)}),jt=(pt=(0,l.default)((function*(e){if(e){var t=e.map((function(e){return e.taskId}));return!(yield it.getListTaskByListId(t)).find((function(e){return"completed"!==e.statusType}))||(s.Alert.alert(r("CM.needDoneTask")),!1)}return!0})),function(e){return pt.apply(this,arguments)}),St=(yt=(0,l.default)((function*(){if(!ke)return we(!0),void _e("CM.empty");_e("");try{Ye(!0);var e=Object.assign({},null==ut?void 0:ut.recipient,{reason:ke});(yield it.actionTicket(null==ut?void 0:ut.id,null==ut?void 0:ut.ticketId,null==ut?void 0:ut.userTaskId,e,Qe,"reject"))?(_.default.show({type:"success",text1:r("CM.noti"),text2:r("CM.rejectSucesss")}),N(V.ticketActions.setDataTicket(Object.assign({},et,{ticketStatus:b.Status.rejected}))),L.goBack()):_.default.show({type:"error",text1:r("CM.noti"),text2:r("CM.rejectFailed")})}catch(e){}finally{Ye(!1)}})),function(){return yt.apply(this,arguments)}),It=(mt=(0,l.default)((function*(){var e=yield it.getListTaskByTicketIdAndUsertaskId(et.id,z._userTaskId);if(e){var t=e.map((function(e){return e.owner})),n=e.map((function(e){return e.taskId})),r=yield at.getMultiLoginAccount((0,i.default)(new Set(t))),l=e.map((function(e){var t,n,i;return Object.assign({},e,{avatar:null==r||null==(t=r.find((function(t){return t.email===e.owner})))?void 0:t.imageUrl,name:(null==r||null==(n=r.find((function(t){return t.email===e.owner})))?void 0:n.firstName)+" "+(null==r||null==(i=r.find((function(t){return t.email===e.owner})))?void 0:i.lastName)})}));Me(l);var a=yield it.getListTaskByListId(n);if(a){var o=a.map((function(e){var t,n,r;return Object.assign({},e,{owner:null==(t=l.find((function(t){return t.listTaskId==e.listTaskId})))?void 0:t.owner,fullName:null==(n=l.find((function(t){return t.listTaskId==e.listTaskId})))?void 0:n.name,avatar:null==(r=l.find((function(t){return t.listTaskId==e.listTaskId})))?void 0:r.avatar,attrJson:JSON.parse(e.attr)})}));yield wt(o)}}})),function(){return mt.apply(this,arguments)}),wt=(ht=(0,l.default)((function*(e){var t=e.flatMap((function(e){return e.assignTaskList.map((function(e){return e.userId}))})),n=yield it.findUserByOrgIn(0,1e4,"",null,t);if(n){var r=e.map((function(e){return e.assignTaskList.length&&(e.assignTaskList=e.assignTaskList.map((function(e){var t,r,i,l,a,o;return Object.assign({},e,{avatar:null==(t=n.data)||null==(r=t.find((function(t){return t.resourceId==e.userId})))?void 0:r.imageUrl,email:null==(i=n.data)||null==(l=i.find((function(t){return t.resourceId==e.userId})))?void 0:l.email,name:null==(a=n.data)||null==(o=a.find((function(t){return t.resourceId==e.userId})))?void 0:o.personalName})}))),e}));Ne(r)}})),function(e){return ht.apply(this,arguments)});return(0,A.jsxs)(o.SafeAreaView,{edges:["bottom"],style:{flex:1,backgroundColor:"#fff"},children:[(0,A.jsx)(u.default,{style:{backgroundColor:"#fff"},titleStyle:{color:"#00204D"},fillIconBackLeft:"#00204DB2",title:r("RV.infoDoc"),contentStyle:{backgroundColor:"#fff"},renderContentRight:function(){return(0,A.jsx)(j.TopNavigationAction,{onPress:function(){return K(!0)},icon:(0,A.jsx)(c.IconWorkflow,{width:20,height:20})})}}),(0,A.jsxs)(T.KeyboardAwareScrollView,{children:[(0,A.jsx)(s.View,{style:f.default.ctnBody,children:(0,A.jsxs)(s.View,{style:f.default.ctnSubBody,children:[(0,A.jsxs)(s.Pressable,{style:f.default.ctnHeader,onPress:function(){return ge(!xe)},children:[(0,A.jsx)(j.Icon,{fill:"#6F2CED",width:16,height:16,name:xe?"arrow-circle-down":"arrow-circle-right"}),(0,A.jsx)(k.default,{style:f.default.textTitle,children:r("CM.infoCommon")})]}),xe&&(0,A.jsx)(s.View,{style:{paddingHorizontal:10,paddingBottom:10},children:(0,A.jsx)(D.default,{dataInfo:st})})]})}),Pe.length>0&&(0,A.jsx)(s.View,{style:f.default.ctnBody,children:(0,A.jsxs)(s.View,{style:[f.default.ctnSubBody],children:[(0,A.jsxs)(s.Pressable,{style:f.default.ctnHeader,onPress:function(){return me(!ye)},children:[(0,A.jsx)(j.Icon,{fill:"#6F2CED",width:16,height:16,name:ye?"arrow-circle-down":"arrow-circle-right"}),(0,A.jsx)(k.default,{style:f.default.textTitle,children:r("RV.taskNeedDone")})]}),ye&&(0,A.jsx)(j.List,{contentContainerStyle:{rowGap:10,backgroundColor:"#fff",paddingBottom:10},scrollEnabled:!1,data:Ae,renderItem:function(e){var t=e.item,n=e.index;return(0,A.jsx)(P.default,{dataTask:t},n)}})]})}),G&&(0,A.jsx)(s.View,{style:f.default.ctnBody,children:(0,A.jsxs)(s.View,{style:[f.default.ctnSubBody],children:[(0,A.jsxs)(s.Pressable,{style:f.default.ctnHeader,onPress:function(){return re(!ne)},children:[(0,A.jsx)(j.Icon,{fill:"#6F2CED",width:16,height:16,name:ne?"arrow-circle-down":"arrow-circle-right"}),(0,A.jsx)(k.default,{style:f.default.textTitle,children:r("RV.econtract.formNeedAction")})]}),ne&&(0,A.jsxs)(s.View,{style:f.default.ctnFormName,children:[(0,A.jsxs)(k.default,{style:f.default.textTitle,children:[r("RV.econtract.fillForm")," "]}),(0,A.jsx)(s.TouchableOpacity,{onPress:function(){oe(!0)},children:(0,A.jsx)(k.default,{style:f.default.formName,children:null==G?void 0:G.formName})})]})]})}),(0,A.jsx)(s.View,{style:f.default.ctnBody,children:(0,A.jsxs)(s.View,{style:[f.default.ctnSubBody],children:[(0,A.jsxs)(s.Pressable,{style:f.default.ctnHeader,onPress:function(){return ce(!de)},children:[(0,A.jsx)(j.Icon,{fill:"#6F2CED",width:16,height:16,name:de?"arrow-circle-down":"arrow-circle-right"}),(0,A.jsx)(k.default,{style:f.default.textTitle,children:r("RV.fileRelative")})]}),de&&(0,A.jsx)(E.default,{dataUserTask:z})]})}),z._status===v.STATUS_TASK.TASK_SEARCH&&(0,A.jsx)(s.View,{style:f.default.ctnBody,children:(0,A.jsxs)(s.View,{style:[f.default.ctnSubBody,{marginBottom:16}],children:[(0,A.jsxs)(s.Pressable,{style:f.default.ctnHeader,onPress:function(){return we(!Ie)},children:[(0,A.jsx)(j.Icon,{fill:"#6F2CED",width:16,height:16,name:Ie?"arrow-circle-down":"arrow-circle-right"}),(0,A.jsx)(k.default,{style:f.default.textTitle,children:r("CM.note")})]}),Ie&&(0,A.jsx)(s.View,{style:{paddingHorizontal:10,paddingBottom:10,rowGap:4},children:(0,A.jsx)(F.default,{isRequired:!0,label:r("CM.fillNote"),value:ke,onChangeText:function(e){De(e),_e("")},multiline:!0,maxLength:400,errorMessage:r(Re)})})]})})]}),(0,A.jsx)(s.View,{style:f.default.ctnFooter,children:z._status===v.STATUS_TASK.TASK_SEARCH&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(s.TouchableOpacity,{disabled:$e,onPress:St,children:(0,A.jsx)(c.IconRejectReview,{width:(0,y.SizeDP)(36),height:(0,y.SizeDP)(36)})}),(0,A.jsx)(d.default,{style:{flex:1},label:r("CM.confirm"),loading:Ue,onPress:function(){return gt(!1)}})]})}),(0,A.jsx)(S.default,{isVisible:q,children:(0,A.jsx)(I.default,{onClose:function(){return K(!1)}})}),(0,A.jsx)(S.default,{isVisible:ae,children:(0,A.jsx)(O.default,{versionId:null==G?void 0:G.versionId,readOnly:z._status!==v.STATUS_TASK.TASK_SEARCH,data:{_userTaskId:null==z?void 0:z._userTaskId,_ticketId:null==et?void 0:et.id,formId:null==G?void 0:G.formId},isOnlyView:z._status!==v.STATUS_TASK.TASK_SEARCH,handleSubmit:function(){return gt(!0)},onClose:function(){return oe(!1)},nameHeader:null==G?void 0:G.formName})}),(0,A.jsx)(S.default,{isVisible:Q,children:(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(s.View,{style:{flex:1},children:(0,A.jsx)(C.default,{})}),(0,A.jsx)(d.default,{style:{backgroundColor:"#f2ecfd",marginHorizontal:16},styleLabel:{color:"#6d1fad"},label:r("CM.back"),onPress:function(){return Z(!1)}})]})}),(0,A.jsx)(B.default,{ticketId:et.id,userTaskId:null==z?void 0:z._userTaskId})]})}},19867:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.STATUS_TASK=t.ACTION_TYPES=void 0;t.ACTION_TYPES=function(e){return e.SHOW_EXECUTOR_USER="SHOW_EXECUTOR_USER",e.SHOW_EID_INFO="SHOW_EID_INFO",e.SHOW_ELMS_INFO="SHOW_ELMS_INFO",e.SHOW_ECONTRACT_INFO="SHOW_ECONTRACT_INFO",e.CREATE_ECONTRACT_ENV="CREATE_ECONTRACT_ENV",e.SHOW_USERTASK_INFO="SHOW_USERTASK_INFO",e.SHOW_COLLABO_INFO="SHOW_COLLABO_INFO",e}({}),t.STATUS_TASK=function(e){return e.TASK_SEARCH="task-search",e.TASK_SUCCESS="task-success",e.TASK_REJECTED="task-reject",e}({})},89052:function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(87841),i=n(41995),l=n(20880);t.default=r.StyleSheet.create({ctnFooter:{flexDirection:"row",paddingHorizontal:(0,i.SizeDP)(16),columnGap:(0,i.SizeDP)(16),marginTop:(0,i.SizeDP)(8)},ctnBody:{backgroundColor:"#F8FAFE",paddingHorizontal:16,paddingTop:16},ctnSubBody:{backgroundColor:"#fff",borderRadius:10},ctnHeader:{flexDirection:"row",alignItems:"center",justifyContent:"flex-start",columnGap:10,padding:10},textTitle:{color:"#00204D",fontSize:14,fontFamily:l.Font.InterMedium500},redDot:{color:"#E14337"},formName:{fontSize:14,color:"#366ae2",textDecorationLine:"underline",fontFamily:l.Font.InterRegular400},ctnFormName:{paddingHorizontal:10,paddingBottom:10,rowGap:4}})}}]);//# sourceMappingURL=src_app_screens_review-ecollabo-flow_index_tsx-src_app_screens_review-econtract-flow_componen-89db8b.bundle.map?platform=android/* RCSSB */eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJoYXNoIjoiZjcxZTYwNzcwMzI1Y2Q4ZjI0YWM3YjJhZWNhMmNmMDljM2M2MWE2N2I4NjVjMmQzZmQ1ODUyY2IwMjliYTk2YSIsImlhdCI6MTc0OTYzNTcxMH0.Dp445FBoUmkBcotUBLkzZYJkU-El2y3jdPG9fX7AClwDNFJ9qBeLf9v9RJhHRTkJe46V17dLJGpNwTK0osaLV6-I7ZP28Tu_o0cFXGuCStAgrLDg2hz6KGQ3K22iCVSp8qN-ZMuB57Z0hJO_5FkawlbLXQByzYfcusSDWziRuQ01Rg8maPLa2S-3bpvRbiRkWSswk0a2HC6FTrzuCudFBCQ6sNHlH4iZk2UW8A68jWAmPxgyrGXMiI2e1A6jzrqNIcy1cfk2f61Dlj9Aj8fFNcA50XpmKGiVtd8CxdlAr9UlO1cdU1VKKTY49oKm4QUWg06eP-YQ8A5DbnBvBvd06YpAqPudawwpqeM_ir5BoE8iSiiFm79uWMDEhafmGEIM9LeHdXgaR-iobBjGZf9vSgGf2LQvdgWEY4lIj4S2a7OY3VuhjpgmVnvSSs2-dCluH7psGWbFqRdYhjtpNZujUO3Vkv0vCvP4N1b9Lx2vM9sb7XO4YAcNw4b7w8a5igCBZYnPReU1M4F_eus-bx4gTy4STp4y5pOqF86u_v9BWkjT_YSksVr3tRnPNYeXu21Zze2ovdRWhWx8ZIMWBPFkw2zC8KTWiuSrdPdwatGuFs25xb7WIgCfP6gLUmIB94jil2SAmfl8Sr8cgu32Yn0Rjn_LmyBzY4NV3IOsYYJ8b0s                                                                                                                                                                                                                                                                                                                                                                                                                                         